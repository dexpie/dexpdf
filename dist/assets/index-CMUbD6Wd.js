const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/vendor_jspdf-G1Ni3NiI.js","assets/vendor-CL2Wiora.js","assets/vendor_tesseract-Cw9vCel6.js","assets/vendor_pptxgenjs-aKi9TcwB.js"])))=>i.map(i=>d[i]);
import{r as d,j as e,P as oe,F as le,a as ce,b as Z,J as re,S as ie,d as ae,e as de,l as ue,f as fe,R as pe}from"./vendor-CL2Wiora.js";import{p as L}from"./vendor_pdfjs-azyFCgQF.js";import{_ as ne,E as ge}from"./vendor_jspdf-G1Ni3NiI.js";import me from"./vendor_html2canvas-CBrSDip1.js";(function(){const w=document.createElement("link").relList;if(w&&w.supports&&w.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))x(l);new MutationObserver(l=>{for(const h of l)if(h.type==="childList")for(const y of h.addedNodes)y.tagName==="LINK"&&y.rel==="modulepreload"&&x(y)}).observe(document,{childList:!0,subtree:!0});function p(l){const h={};return l.integrity&&(h.integrity=l.integrity),l.referrerPolicy&&(h.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?h.credentials="include":l.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function x(l){if(l.ep)return;l.ep=!0;const h=p(l);fetch(l.href,h)}})();window.addEventListener("open-tool",i=>{const w=i.detail;localStorage.setItem("lastTool",w);const p=new URL(window.location);p.searchParams.set("tool",w),window.history.pushState({},"",p),console.log("Opening tool:",w)});try{L.GlobalWorkerOptions.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${L.version}/pdf.worker.min.js`}catch{}function he(){const[i,w]=d.useState(null),[p,x]=d.useState(!1),[l,h]=d.useState(!1),[y,D]=d.useState(!1);async function N(t){const s=t.target.files[0];s&&w(s)}function g(t){t.preventDefault(),h(!0)}function n(t){t.preventDefault(),t.dataTransfer.dropEffect="copy"}function u(t){t.preventDefault(),h(!1)}async function r(t){var o,c;t.preventDefault(),h(!1);const s=(c=(o=t.dataTransfer)==null?void 0:o.files)==null?void 0:c[0];s&&(w(s),D(!0),setTimeout(()=>D(!1),1500))}async function a(){if(i){x(!0);try{const t=await i.arrayBuffer(),s=await L.getDocument({data:t}).promise;let o="";for(let T=1;T<=s.numPages;T++){const E=(await(await s.getPage(T)).getTextContent()).items.map(b=>b.str);o+=`
--- Page ${T} ---
`+E.join(" ")+`
`}const c=new Blob([o],{type:"text/plain"}),m=URL.createObjectURL(c),v=document.createElement("a");v.href=m,v.download=`${i.name.replace(/\.pdf$/i,"")}.txt`,v.click(),URL.revokeObjectURL(m)}catch(t){console.error(t),alert("Failed: "+t.message)}finally{x(!1)}}}return e.jsxs("div",{children:[e.jsx("h2",{children:"PDF → Text"}),e.jsxs("div",{className:`dropzone ${l?"dragover":""}`,onDragEnter:g,onDragOver:n,onDragLeave:u,onDrop:r,children:[e.jsx("input",{type:"file",accept:"application/pdf",onChange:N}),e.jsx("div",{className:"muted",children:"Select a PDF to extract text (plain text)."}),y&&e.jsx("div",{className:"drop-overlay",children:"✓ Uploaded"})]}),e.jsx("div",{style:{marginTop:12},children:e.jsx("button",{className:"btn-primary",onClick:a,disabled:p||!i,children:p?"Working...":"Extract Text"})})]})}try{L.GlobalWorkerOptions.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${L.version}/pdf.worker.min.js`}catch{}function xe(){const[i,w]=d.useState(null),[p,x]=d.useState(!1),[l,h]=d.useState(!1),[y,D]=d.useState(!1);async function N(t){const s=t.target.files[0];s&&w(s)}function g(t){t.preventDefault(),h(!0)}function n(t){t.preventDefault(),t.dataTransfer.dropEffect="copy"}function u(t){t.preventDefault(),h(!1)}async function r(t){var o,c;t.preventDefault(),h(!1);const s=(c=(o=t.dataTransfer)==null?void 0:o.files)==null?void 0:c[0];s&&(w(s),D(!0),setTimeout(()=>D(!1),1500))}async function a(){if(i){x(!0);try{const t=await i.arrayBuffer(),s=await L.getDocument({data:t}).promise,o=[];for(let k=1;k<=s.numPages;k++){const b=(await(await s.getPage(k)).getTextContent()).items.map(P=>P.str);o.push(new oe(b.join(" ")))}const c=new le({sections:[{children:o}]}),m=await ce.toBlob(c),v=URL.createObjectURL(m),T=document.createElement("a");T.href=v,T.download=`${i.name.replace(/\.pdf$/i,"")}.docx`,T.click(),URL.revokeObjectURL(v)}catch(t){console.error(t),alert("Failed: "+t.message)}finally{x(!1)}}}return e.jsxs("div",{children:[e.jsx("h2",{children:"PDF → Word (.docx)"}),e.jsxs("div",{className:`dropzone ${l?"dragover":""}`,onDragEnter:g,onDragOver:n,onDragLeave:u,onDrop:r,children:[e.jsx("input",{type:"file",accept:"application/pdf",onChange:N}),e.jsx("div",{className:"muted",children:"Select a PDF to convert to a simple .docx (text-only)."}),y&&e.jsx("div",{className:"drop-overlay",children:"✓ Uploaded"})]}),e.jsx("div",{style:{marginTop:12},children:e.jsx("button",{className:"btn-primary",onClick:a,disabled:p||!i,children:p?"Working...":"Convert to DOCX"})})]})}try{L.GlobalWorkerOptions.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${L.version}/pdf.worker.min.js`}catch{}function ye(){const[i,w]=d.useState([]),[p,x]=d.useState(!1);async function l(a){const t=Array.from(a.target.files),s=[];for(const o of t){const c=await r(o);s.push({file:o,thumb:c})}w(o=>o.concat(s))}async function h(){if(i.length){x(!0);try{const a=await Z.create();for(const m of i){const T=await m.file.arrayBuffer(),k=await Z.load(T);(await a.copyPages(k,k.getPageIndices())).forEach(E=>a.addPage(E))}const t=await a.save(),s=new Blob([t],{type:"application/pdf"}),o=URL.createObjectURL(s),c=document.createElement("a");c.href=o,c.download="merged.pdf",c.click(),URL.revokeObjectURL(o)}catch(a){console.error(a),alert("Failed to merge: "+(a.message||a))}finally{x(!1)}}}function y(a){w(t=>t.filter((s,o)=>o!==a))}function D(a){w(t=>{if(a<=0)return t;const s=t.slice(),o=s[a-1];return s[a-1]=s[a],s[a]=o,s})}function N(a){w(t=>{if(a>=t.length-1)return t;const s=t.slice(),o=s[a+1];return s[a+1]=s[a],s[a]=o,s})}function g(a,t){a.dataTransfer.setData("text/plain",String(t)),a.dataTransfer.effectAllowed="move"}function n(a){a.preventDefault(),a.dataTransfer.dropEffect="move"}function u(a,t){a.preventDefault();const s=Number(a.dataTransfer.getData("text/plain"));Number.isNaN(s)||w(o=>{const c=o.slice(),[m]=c.splice(s,1);return c.splice(t,0,m),c})}async function r(a){try{const t=await a.arrayBuffer(),o=await(await L.getDocument({data:t}).promise).getPage(1),c=o.getViewport({scale:1.5}),m=document.createElement("canvas");m.width=Math.ceil(c.width),m.height=Math.ceil(c.height);const v=m.getContext("2d");return await o.render({canvasContext:v,viewport:c}).promise,m.toDataURL("image/png")}catch{return null}}return e.jsxs("div",{children:[e.jsx("h2",{children:"Merge PDF"}),e.jsxs("div",{className:"dropzone",children:[e.jsx("input",{type:"file",accept:"application/pdf",multiple:!0,onChange:l}),e.jsx("div",{className:"muted",children:"Select multiple PDF files. They will be merged in the selected order."})]}),e.jsx("div",{className:"file-list",children:i.map((a,t)=>e.jsxs("div",{className:"file-item",draggable:!0,onDragStart:s=>g(s,t),onDragOver:n,onDrop:s=>u(s,t),children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[e.jsx("div",{style:{width:56,height:40,flex:"none",background:"#f4f6fb",display:"flex",alignItems:"center",justifyContent:"center"},children:a.thumb?e.jsx("img",{src:a.thumb,style:{maxWidth:"100%",maxHeight:"100%"},alt:"thumb"}):e.jsx("div",{className:"muted",children:"PDF"})}),e.jsx("div",{style:{minWidth:200,overflow:"hidden",textOverflow:"ellipsis"},children:a.file.name})]}),e.jsxs("div",{style:{display:"flex",gap:8},children:[e.jsx("button",{className:"btn",onClick:()=>D(t),disabled:t===0,children:"↑"}),e.jsx("button",{className:"btn",onClick:()=>N(t),disabled:t===i.length-1,children:"↓"}),e.jsx("button",{className:"btn",onClick:()=>y(t),children:"Remove"})]})]},t))}),e.jsx("div",{style:{marginTop:12},children:e.jsx("button",{className:"btn",onClick:h,disabled:p||i.length===0,children:p?"Working...":"Merge & Download"})})]})}function we(){const[i,w]=d.useState(null),[p,x]=d.useState([]),[l,h]=d.useState([]),[y,D]=d.useState(!1);async function N(r){const a=r.target.files[0];if(!a)return;w(a);const t=await a.arrayBuffer(),s=await Z.load(t);x(new Array(s.getPageCount()).fill(!1)),h(new Array(s.getPageCount()).fill(0))}function g(r){x(a=>a.map((t,s)=>s===r?!t:t))}function n(r){h(a=>a.map((t,s)=>s===r?(t+90)%360:t))}async function u(){if(i){D(!0);try{const r=await i.arrayBuffer(),a=await Z.load(r),t=p.flatMap((k,_)=>k?[_]:[]);if(t.length===0){alert("Pick pages to export");return}const s=await Z.create();(await s.copyPages(a,t)).forEach((k,_)=>{s.addPage(k);const E=t[_],b=l[E]||0;b&&k.setRotation(b)});const c=await s.save(),m=new Blob([c],{type:"application/pdf"}),v=URL.createObjectURL(m),T=document.createElement("a");T.href=v,T.download="extracted.pdf",T.click(),URL.revokeObjectURL(v)}catch(r){console.error(r),alert("Failed: "+r.message)}finally{D(!1)}}}return e.jsxs("div",{children:[e.jsx("h2",{children:"Split / Extract Pages"}),e.jsxs("div",{className:"dropzone",children:[e.jsx("input",{type:"file",accept:"application/pdf",onChange:N}),e.jsx("div",{className:"muted",children:"Load a PDF then select pages to export."})]}),e.jsx("div",{style:{marginTop:12},children:p.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"muted",children:"Click pages to toggle selection. Use rotate to change orientation."}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(120px,1fr))",gap:8,marginTop:8},children:p.map((r,a)=>e.jsx("div",{className:"file-item",style:{cursor:"pointer",background:r?"#eef2ff":""},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%"},children:[e.jsxs("div",{onClick:()=>g(a),style:{flex:1},children:["Page ",a+1," ",l[a]?`• ${l[a]}°`:""]}),e.jsx("div",{style:{display:"flex",gap:6},children:e.jsx("button",{className:"btn",onClick:()=>n(a),children:"Rotate"})})]})},a))}),e.jsx("div",{style:{marginTop:12},children:e.jsx("button",{className:"btn",onClick:u,disabled:y,children:y?"Working...":"Export Selected"})})]})})]})}function ve(){const[i,w]=d.useState([]),[p,x]=d.useState(!1),[l,h]=d.useState("fit");async function y(a){const t=Array.from(a.target.files),s=[];for(const o of t)try{const c=await u(o);s.push({file:o,dataUrl:c.dataUrl,thumb:c.dataUrl,width:c.width,height:c.height})}catch(c){console.warn("failed to load image",o,c)}s.length&&w(o=>o.concat(s))}function D(a){w(t=>t.filter((s,o)=>o!==a))}function N(a,t){a.dataTransfer.setData("text/plain",String(t)),a.dataTransfer.effectAllowed="move"}function g(a){a.preventDefault(),a.dataTransfer.dropEffect="move"}function n(a,t){a.preventDefault();const s=Number(a.dataTransfer.getData("text/plain"));Number.isNaN(s)||w(o=>{const c=o.slice(),[m]=c.splice(s,1);return c.splice(t,0,m),c})}function u(a){return new Promise((t,s)=>{const o=new FileReader;o.onload=()=>{const c=new Image;c.onload=()=>t({dataUrl:o.result,width:c.naturalWidth,height:c.naturalHeight}),c.onerror=s,c.src=o.result},o.onerror=s,o.readAsDataURL(a)})}async function r(){if(i.length!==0){x(!0);try{const a=i,t="mm",s=25.4/96,o=210,c=297,{jsPDF:m}=await ne(async()=>{const{jsPDF:T}=await import("./vendor_jspdf-G1Ni3NiI.js").then(k=>k.j);return{jsPDF:T}},__vite__mapDeps([0,1])),v=new m({unit:t,format:[o,c]});for(let T=0;T<a.length;T++){const k=a[T],_=k.dataUrl||k.thumb,E=k.width,b=k.height;if(!_){console.warn("skip image with no dataUrl/thumb",k);continue}const P=o,f=c;T>0&&v.addPage();const j=10,C=P-j*2,F=f-j*2,R=E*s,U=b*s;let O,B;if(l==="actual")O=Math.min(R,C),B=Math.min(U,F);else if(l==="fill"){const A=Math.max(C/R,F/U);O=R*A,B=U*A}else{const A=Math.min(C/R,F/U,1);O=R*A,B=U*A}const J=(P-O)/2,G=(f-B)/2,H=typeof _=="string"&&_.indexOf("image/png")>=0?"PNG":"JPEG";try{v.addImage(_,H,J,G,O,B)}catch(A){console.error("addImage failed for entry",T,A)}}v.save("images.pdf")}catch(a){console.error(a),alert("Failed: "+(a.message||a))}finally{x(!1)}}}return e.jsxs("div",{children:[e.jsx("h2",{children:"Images → PDF"}),e.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[e.jsx("label",{style:{display:"flex",alignItems:"center",gap:6},children:"Mode:"}),e.jsxs("select",{value:l,onChange:a=>h(a.target.value),children:[e.jsx("option",{value:"fit",children:"Fit (contain)"}),e.jsx("option",{value:"fill",children:"Fill (cover)"}),e.jsx("option",{value:"actual",children:"Actual size (max page)"})]})]}),e.jsxs("div",{className:"dropzone",children:[e.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:y}),e.jsx("div",{className:"muted",children:"Select images in the order you want them to appear."})]}),e.jsx("div",{className:"file-list",children:i.map((a,t)=>e.jsxs("div",{className:"file-item",draggable:!0,onDragStart:s=>N(s,t),onDragOver:g,onDrop:s=>n(s,t),children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[e.jsx("div",{style:{width:56,height:40,flex:"none",background:"#f4f6fb",display:"flex",alignItems:"center",justifyContent:"center"},children:a.thumb?e.jsx("img",{src:a.thumb,style:{maxWidth:"100%",maxHeight:"100%"},alt:"thumb"}):e.jsx("div",{className:"muted",children:"IMG"})}),e.jsx("div",{style:{minWidth:200,overflow:"hidden",textOverflow:"ellipsis"},children:a.file.name})]}),e.jsx("div",{children:e.jsx("button",{className:"btn",onClick:()=>D(t),children:"Remove"})})]},t))}),e.jsx("div",{style:{marginTop:12},children:e.jsx("button",{className:"btn",onClick:r,disabled:p||i.length===0,children:p?"Working...":"Create PDF"})})]})}try{L.GlobalWorkerOptions.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${L.version}/pdf.worker.min.js`}catch(i){console.warn("pdfjs worker not set",i)}function je(){const[i,w]=d.useState(null),[p,x]=d.useState([]),[l,h]=d.useState(!1);async function y(g){const n=g.target.files[0];if(!n)return;w(n);const u=await n.arrayBuffer(),r=await L.getDocument({data:u}).promise;x(new Array(r.numPages).fill(!1))}function D(g){x(n=>n.map((u,r)=>r===g?!u:u))}async function N(){if(i){h(!0);try{const g=await i.arrayBuffer(),n=await L.getDocument({data:g}).promise,u=p.flatMap((a,t)=>a?[t+1]:[]);if(u.length===0){alert("Select pages to export"),h(!1);return}const r=[];for(const a of u){const t=await n.getPage(a),s=t.getViewport({scale:2}),o=document.createElement("canvas");o.width=Math.ceil(s.width),o.height=Math.ceil(s.height);const c=o.getContext("2d");await t.render({canvasContext:c,viewport:s}).promise;const m=await new Promise(v=>o.toBlob(v,"image/png"));r.push({pnum:a,blob:m})}if(u.length===1){const a=r[0].blob,t=URL.createObjectURL(a),s=document.createElement("a");s.href=t,s.download=`${i.name.replace(/\.pdf$/i,"")}_page_${r[0].pnum}.png`,s.click(),URL.revokeObjectURL(t)}else{const a=new re;for(const c of r){const m=await c.blob.arrayBuffer();a.file(`${i.name.replace(/\.pdf$/i,"")}_page_${c.pnum}.png`,m)}const t=await a.generateAsync({type:"blob"}),s=URL.createObjectURL(t),o=document.createElement("a");o.href=s,o.download=`${i.name.replace(/\.pdf$/i,"")}_pages.zip`,o.click(),URL.revokeObjectURL(s)}}catch(g){console.error(g),alert("Failed: "+g.message)}finally{h(!1)}}}return e.jsxs("div",{children:[e.jsx("h2",{children:"PDF → Images"}),e.jsxs("div",{className:"dropzone",children:[e.jsx("input",{type:"file",accept:"application/pdf",onChange:y}),e.jsx("div",{className:"muted",children:"Select a PDF, then choose pages to export as PNG."})]}),p.length>0&&e.jsxs("div",{style:{marginTop:12},children:[e.jsx("div",{className:"muted",children:"Click pages to select"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(90px,1fr))",gap:8,marginTop:8},children:p.map((g,n)=>e.jsxs("div",{className:"file-item",onClick:()=>D(n),style:{cursor:"pointer",background:g?"#eef2ff":""},children:["Page ",n+1]},n))}),e.jsx("div",{style:{marginTop:12},children:e.jsx("button",{className:"btn",onClick:N,disabled:l,children:l?"Rendering...":"Export Selected as PNG"})})]})]})}try{L.GlobalWorkerOptions.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${L.version}/pdf.worker.min.js`}catch{}function be(){const[i,w]=d.useState(null),[p,x]=d.useState(null),l=d.useRef(),[h,y]=d.useState(!1);async function D(r){const a=r.target.files[0];if(!a)return;w(a);const t=await a.arrayBuffer(),o=await(await L.getDocument({data:t}).promise).getPage(1),c=o.getViewport({scale:1.5}),m=document.createElement("canvas");m.width=Math.ceil(c.width),m.height=Math.ceil(c.height);const v=m.getContext("2d");await o.render({canvasContext:v,viewport:c}).promise,x(m.toDataURL("image/png"))}d.useEffect(()=>{const r=l.current;if(!r||!p)return;const a=r.getContext("2d"),t=new Image;t.onload=()=>{r.width=t.width,r.height=t.height,a.drawImage(t,0,0)},t.src=p},[p]);function N(r){y(!0),n(r)}function g(){y(!1)}function n(r){if(!h)return;const a=l.current,t=a.getBoundingClientRect(),s=r.clientX-t.left,o=r.clientY-t.top,c=a.getContext("2d");c.fillStyle="rgba(255,0,0,0.6)",c.beginPath(),c.arc(s,o,6,0,Math.PI*2),c.fill()}async function u(){if(!i||!l.current)return;const r=await new Promise(k=>l.current.toBlob(k,"image/png")),a=await Z.create(),t=await r.arrayBuffer(),s=await a.embedPng(t);a.addPage([s.width,s.height]).drawImage(s,{x:0,y:0,width:s.width,height:s.height});const c=await a.save(),m=new Blob([c],{type:"application/pdf"}),v=URL.createObjectURL(m),T=document.createElement("a");T.href=v,T.download=i.name.replace(/\.pdf$/i,"")+"_annotated.pdf",T.click(),URL.revokeObjectURL(v)}return e.jsxs("div",{children:[e.jsx("h2",{children:"Annotate PDF (single-page preview)"}),e.jsxs("div",{className:"dropzone",children:[e.jsx("input",{type:"file",accept:"application/pdf",onChange:D}),e.jsx("div",{className:"muted",children:"Load a PDF (first page shown). Draw on canvas to annotate."})]}),p&&e.jsxs("div",{style:{marginTop:12},children:[e.jsx("div",{style:{border:"1px solid #eee"},children:e.jsx("canvas",{ref:l,onMouseDown:N,onMouseUp:g,onMouseMove:n,style:{display:"block",width:"100%"}})}),e.jsx("div",{style:{marginTop:8},children:e.jsx("button",{className:"btn",onClick:u,children:"Export Annotated PDF"})})]})]})}try{L.GlobalWorkerOptions.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${L.version}/pdf.worker.min.js`}catch(i){console.warn("pdfjs worker not set",i)}function Pe(){const[i,w]=d.useState(null),[p,x]=d.useState(0),[l,h]=d.useState(!1),[y,D]=d.useState(!1),[N,g]=d.useState(!1),[n,u]=d.useState(.7),[r,a]=d.useState(.9),[t,s]=d.useState(null),[o,c]=d.useState(null),[m,v]=d.useState(null),[T,k]=d.useState(!1),[_,E]=d.useState(""),b=d.useRef(null),P=d.useRef(null),f=d.useRef(0),j=d.useRef(null);async function C(S){var I;const z=(I=S.target.files)==null?void 0:I[0];if(z){w(z),c(z.size);try{const M=await z.arrayBuffer();b.current=M;const $=await L.getDocument({data:M}).promise;P.current=$,x($.numPages),v(null),E("")}catch(M){console.error(M),alert("Unable to read PDF: "+(M.message||M))}}}function F(S){S.preventDefault(),D(!0)}function R(S){S.preventDefault(),S.dataTransfer.dropEffect="copy"}function U(S){S.preventDefault(),D(!1)}async function O(S){var I,M;S.preventDefault(),D(!1);const z=(M=(I=S.dataTransfer)==null?void 0:I.files)==null?void 0:M[0];if(z){w(z),c(z.size);const $=await z.arrayBuffer(),W=await L.getDocument({data:$}).promise;x(W.numPages),v(null),E(""),g(!0),setTimeout(()=>g(!1),1500)}}function B(S){return S*25.4/96}async function J({download:S=!0,preview:z=!1}={download:!0,preview:!1}){if(!i)return alert("Select a PDF to compress");if(!(p>80&&!confirm("This PDF has "+p+" pages. Compressing will rasterize pages in the browser and may be slow or use lots of memory. Continue?"))){h(!0),s(null);try{const I=await i.arrayBuffer(),M=await L.getDocument({data:I}).promise,$=M.numPages;let W=null;for(let V=1;V<=$;V++){const q=await M.getPage(V),Q=q.getViewport({scale:r}),Y=document.createElement("canvas");Y.width=Math.ceil(Q.width),Y.height=Math.ceil(Q.height);const te=Y.getContext("2d");await q.render({canvasContext:te,viewport:Q}).promise;const K=Y.toDataURL("image/jpeg",Number(n)),ee=B(Y.width),se=B(Y.height);V===1?(W=new ge({unit:"mm",format:[ee,se]}),W.addImage(K,"JPEG",0,0,ee,se)):(W.addPage([ee,se]),W.addImage(K,"JPEG",0,0,ee,se)),Y.width=0,Y.height=0}if(!W)throw new Error("Failed to create compressed PDF");if(z){const V=W.output("datauristring");s(V)}S&&W.save(i.name.replace(/\.pdf$/i,"")+"_compressed.pdf")}catch(I){console.error(I),alert("Compression failed: "+(I.message||I))}finally{h(!1)}}}async function G(){if(!i)return alert("Select a PDF first");k(!0),v(null),E("Preparing...");try{const S=await i.arrayBuffer(),z=await L.getDocument({data:S}).promise,I=z.numPages;x(I),E("Rendering sample page...");const M=await z.getPage(1),$=M.getViewport({scale:r}),W=document.createElement("canvas");W.width=Math.ceil($.width),W.height=Math.ceil($.height);const V=W.getContext("2d");await M.render({canvasContext:V,viewport:$}).promise;const q=await new Promise(K=>W.toBlob(K,"image/jpeg",Number(n))),Q=q?q.size:0,te=Math.max(0,Math.round(Q*I+2e3));v(te),E("Estimated using sample page at current settings"),W.width=0,W.height=0}catch(S){console.error(S),alert("Estimate failed: "+(S.message||S))}finally{k(!1)}}async function H(S,z){const I=b.current||await i.arrayBuffer(),M=P.current||await L.getDocument({data:I}).promise,$=M.numPages,W=await M.getPage(1),V=W.getViewport({scale:z}),q=document.createElement("canvas");q.width=Math.ceil(V.width),q.height=Math.ceil(V.height);const Q=q.getContext("2d");await W.render({canvasContext:Q,viewport:V}).promise;const Y=await new Promise(ee=>q.toBlob(ee,"image/jpeg",Number(S))),te=Y?Y.size:0,K=2e3;return q.width=0,q.height=0,Math.max(0,Math.round(te*$+K))}async function A(){if(!i)return alert("Select a PDF first");k(!0),E("Estimating range...");try{const S=b.current||await i.arrayBuffer(),z=P.current||await L.getDocument({data:S}).promise;b.current=S,P.current=z;const I=z.numPages;x(I);const M=.1,$=.5,W=1,V=1,q=Number(n),Q=Number(r);E("Rendering low-quality sample...");const Y=++f.current,te=await H(M,$);if(Y!==f.current)throw new Error("Cancelled");E("Rendering current settings sample...");const K=await H(q,Q);if(Y!==f.current)throw new Error("Cancelled");E("Rendering high-quality sample...");const ee=await H(W,V);if(Y!==f.current)throw new Error("Cancelled");v({low:te,cur:K,high:ee}),E("Range estimated using first-page extrapolation")}catch(S){console.error(S),alert("Range estimate failed: "+(S.message||S))}finally{k(!1)}}d.useEffect(()=>{if(i)return j.current&&clearTimeout(j.current),j.current=setTimeout(()=>{(f.current++)(async()=>{try{k(!0),E("Estimating...");const S=await H(Number(n),Number(r));if(f.current===0)return;v({cur:S}),E("Live estimate updated")}catch(S){S.message!=="Cancelled"&&console.error(S)}finally{k(!1)}})()},350),()=>{j.current&&clearTimeout(j.current)}},[i,n,r]);function X(S){return S==null?"-":S<1024?S+" B":S<1024*1024?(S/1024).toFixed(1)+" KB":(S/(1024*1024)).toFixed(2)+" MB"}return e.jsxs("div",{children:[e.jsx("h2",{children:"Compress PDF"}),e.jsxs("div",{className:`dropzone ${y?"dragover":""}`,onDragEnter:F,onDragOver:R,onDragLeave:U,onDrop:O,children:[e.jsx("input",{type:"file",accept:"application/pdf",onChange:C}),e.jsx("div",{className:"muted",children:"Rasterize pages at lower quality/scale to reduce file size (lossy)."}),N&&e.jsx("div",{className:"drop-overlay",children:"✓ Uploaded"})]}),i&&e.jsxs("div",{style:{marginTop:12},children:[e.jsxs("div",{children:[e.jsx("strong",{children:i.name})," — ",p," pages — original: ",X(o)]}),m&&e.jsxs("div",{style:{marginTop:8},children:[typeof m=="number"&&e.jsxs("div",{children:["Estimated compressed size: ",e.jsx("strong",{children:X(m)})," (",o?Math.round(100-m/o*100):0,"% smaller)"]}),typeof m=="object"&&e.jsx("div",{children:m.low&&m.cur&&m.high?e.jsxs(e.Fragment,{children:[e.jsx("div",{children:"Estimated range:"}),e.jsxs("div",{style:{display:"flex",gap:12,marginTop:6},children:[e.jsxs("div",{children:["Min: ",e.jsx("strong",{children:X(m.low)})," (",o?Math.round(100-m.low/o*100):0,"% smaller)"]}),e.jsxs("div",{children:["Current: ",e.jsx("strong",{children:X(m.cur)})," (",o?Math.round(100-m.cur/o*100):0,"% smaller)"]}),e.jsxs("div",{children:["Max: ",e.jsx("strong",{children:X(m.high)})," (",o?Math.round(100-m.high/o*100):0,"% smaller)"]})]})]}):e.jsxs("div",{children:["Estimated compressed size (live): ",e.jsx("strong",{children:X(m.cur)})," ",o?`(${Math.round(100-m.cur/o*100)}% smaller)`:""," ",T&&e.jsx("span",{className:"small-spinner","aria-hidden":"true"})]})})]}),_&&e.jsx("div",{style:{marginTop:8,color:"#6b7280"},children:_}),e.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center",marginTop:8},children:[e.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:["JPEG Quality:",e.jsx("input",{type:"range",min:"0.1",max:"1",step:"0.05",value:n,onChange:S=>u(Number(S.target.value))}),e.jsxs("div",{style:{width:44,textAlign:"right"},children:[Math.round(n*100),"%"]})]}),e.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:["Render Scale:",e.jsxs("select",{value:r,onChange:S=>a(Number(S.target.value)),children:[e.jsx("option",{value:1,children:"100%"}),e.jsx("option",{value:.9,children:"90%"}),e.jsx("option",{value:.8,children:"80%"}),e.jsx("option",{value:.7,children:"70%"}),e.jsx("option",{value:.6,children:"60%"}),e.jsx("option",{value:.5,children:"50%"})]})]})]}),e.jsxs("div",{style:{marginTop:12,display:"flex",gap:8},children:[e.jsx("button",{className:"btn-primary",onClick:()=>J({download:!0,preview:!1}),disabled:l,children:l?"Compressing...":"Compress & Download"}),e.jsx("button",{className:"btn-outline",onClick:()=>J({download:!1,preview:!0}),disabled:l,children:l?"Compressing...":"Preview"}),e.jsx("button",{className:"btn-ghost",onClick:G,disabled:T,children:T?"Estimating...":"Estimate size"}),e.jsx("button",{className:"btn-ghost",onClick:A,disabled:T,children:T?"Estimating...":"Estimate range (min/cur/max)"})]}),t&&e.jsxs("div",{style:{marginTop:12},children:[e.jsx("div",{className:"muted",children:"Preview (close tab/window to dismiss):"}),e.jsx("iframe",{title:"compress-preview",src:t,style:{width:"100%",height:400,border:"1px solid #ddd"}})]})]})]})}function Se(){const[i,w]=d.useState(null),[p,x]=d.useState("text"),[l,h]=d.useState("New text"),[y,D]=d.useState(!1),[N,g]=d.useState(null);async function n(a){var s;const t=(s=a.target.files)==null?void 0:s[0];t&&w(t)}async function u(a){var s;const t=(s=a.target.files)==null?void 0:s[0];t&&g(t)}async function r(){if(!i)return alert("Select a PDF");D(!0);try{const a=await i.arrayBuffer(),t=await Z.load(a),s=t.getPages(),o=await t.embedFont(ie.Helvetica),c=s[0],{width:m,height:v}=c.getSize();if(p==="text")c.drawText(l,{x:40,y:v-80,size:14,font:o,color:ae(0,0,0)});else if(p==="image"&&N){const b=await N.arrayBuffer(),P=(N.type||"").toLowerCase();let f;P.includes("png")?f=await t.embedPng(b):f=await t.embedJpg(b),c.drawImage(f,{x:40,y:v-200,width:150,height:120})}else c.drawRectangle({x:40,y:v-240,width:200,height:100,color:ae(.9,.9,.9)});const T=await t.save(),k=new Blob([T],{type:"application/pdf"}),_=URL.createObjectURL(k),E=document.createElement("a");E.href=_,E.download="edited.pdf",E.click(),URL.revokeObjectURL(_)}catch(a){console.error(a),alert("Failed: "+a.message)}finally{D(!1)}}return e.jsxs("div",{children:[e.jsx("h2",{children:"Edit PDF"}),e.jsx("input",{type:"file",accept:"application/pdf",onChange:n}),e.jsxs("div",{style:{marginTop:8},children:[e.jsx("label",{children:"Mode"}),e.jsxs("select",{value:p,onChange:a=>x(a.target.value),children:[e.jsx("option",{value:"text",children:"Add Text"}),e.jsx("option",{value:"image",children:"Add Image"}),e.jsx("option",{value:"shape",children:"Add Shape"})]})]}),p==="text"&&e.jsx("div",{style:{marginTop:8},children:e.jsx("input",{value:l,onChange:a=>h(a.target.value),style:{width:"60%"}})}),p==="image"&&e.jsx("div",{style:{marginTop:8},children:e.jsx("input",{type:"file",accept:"image/*",onChange:u})}),e.jsx("div",{style:{marginTop:12},children:e.jsx("button",{className:"btn-primary",onClick:r,disabled:y,children:y?"Working...":"Apply Edits"})})]})}try{L.GlobalWorkerOptions.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${L.version}/pdf.worker.min.js`}catch{}function De(){const[i,w]=d.useState(null),[p,x]=d.useState(""),[l,h]=d.useState(!1);async function y(N){const g=N.target.files[0];if(g){w(g),x(""),h(!0);try{if(g.type==="application/pdf"){const n=await g.arrayBuffer(),r=await(await L.getDocument({data:n}).promise).getPage(1),a=r.getViewport({scale:2}),t=document.createElement("canvas");t.width=Math.ceil(a.width),t.height=Math.ceil(a.height);const s=t.getContext("2d");await r.render({canvasContext:s,viewport:a}).promise,await D(t)}else{const n=new Image,u=URL.createObjectURL(g);n.src=u,await new Promise(t=>n.onload=t);const r=document.createElement("canvas");r.width=n.naturalWidth,r.height=n.naturalHeight,r.getContext("2d").drawImage(n,0,0),URL.revokeObjectURL(u),await D(r)}}catch(n){console.error(n),alert("OCR failed: "+n.message)}finally{h(!1)}}}async function D(N){const{createWorker:g}=await ne(async()=>{const{createWorker:r}=await import("./vendor_tesseract-Cw9vCel6.js").then(a=>a.i);return{createWorker:r}},__vite__mapDeps([2,1])),n=await g({logger:r=>{}});await n.load(),await n.loadLanguage("eng"),await n.initialize("eng");const{data:{text:u}}=await n.recognize(N);x(u),await n.terminate()}return e.jsxs("div",{children:[e.jsx("h2",{children:"OCR (Tesseract.js)"}),e.jsxs("div",{className:"dropzone",children:[e.jsx("input",{type:"file",accept:".png,.jpg,.jpeg,application/pdf",onChange:y}),e.jsx("div",{className:"muted",children:"Select an image or scanned PDF. Large files may take time; Tesseract runs locally in your browser."})]}),e.jsx("div",{style:{marginTop:12},children:l?e.jsx("div",{className:"muted",children:"Recognizing... (this may take a while)"}):e.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:p})})]})}function Te(){const[i,w]=d.useState(null),[p,x]=d.useState("bottom-right"),[l,h]=d.useState(1),[y,D]=d.useState(!1);async function N(n){var r;const u=(r=n.target.files)==null?void 0:r[0];u&&w(u)}async function g(){if(!i)return alert("Select a PDF");D(!0);try{const n=await i.arrayBuffer(),u=await Z.load(n),r=u.getPages(),a=await u.embedFont(ie.Helvetica);for(let m=0;m<r.length;m++){const v=r[m],{width:T,height:k}=v.getSize(),_=String(Number(l)+m),E=12;let b=T-40,P=20;p==="bottom-left"&&(b=20),p==="top-right"&&(P=k-20),p==="top-left"&&(b=20,P=k-20),v.drawText(_,{x:b,y:P,size:E,font:a,color:ae(0,0,0)})}const t=await u.save(),s=new Blob([t],{type:"application/pdf"}),o=URL.createObjectURL(s),c=document.createElement("a");c.href=o,c.download="pagenums.pdf",c.click(),URL.revokeObjectURL(o)}catch(n){console.error(n),alert("Failed: "+n.message)}finally{D(!1)}}return e.jsxs("div",{children:[e.jsx("h2",{children:"Page Numbers"}),e.jsx("input",{type:"file",accept:"application/pdf",onChange:N}),e.jsxs("div",{style:{marginTop:8},children:[e.jsx("label",{children:"Position"}),e.jsxs("select",{value:p,onChange:n=>x(n.target.value),children:[e.jsx("option",{value:"bottom-right",children:"Bottom Right"}),e.jsx("option",{value:"bottom-left",children:"Bottom Left"}),e.jsx("option",{value:"top-right",children:"Top Right"}),e.jsx("option",{value:"top-left",children:"Top Left"})]}),e.jsx("label",{style:{marginLeft:8},children:"Start"}),e.jsx("input",{type:"number",value:l,onChange:n=>h(n.target.value),style:{width:80,marginLeft:6}})]}),e.jsx("div",{style:{marginTop:12},children:e.jsx("button",{className:"btn-primary",onClick:g,disabled:y,children:y?"Working...":"Add Page Numbers"})})]})}try{L.GlobalWorkerOptions.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${L.version}/pdf.worker.min.js`}catch(i){console.warn("pdfjs worker not set",i)}function Ce(){const[i,w]=d.useState(null),[p,x]=d.useState(!1),[l,h]=d.useState([]);async function y(g){const n=g.target.files[0];if(n){w(n),h([]);try{const u=await n.arrayBuffer(),r=await L.getDocument({data:u}).promise,a=[];for(let t=1;t<=r.numPages;t++){const s=await r.getPage(t),o=s.getViewport({scale:1.5}),c=document.createElement("canvas");c.width=Math.ceil(o.width),c.height=Math.ceil(o.height);const m=c.getContext("2d");await s.render({canvasContext:m,viewport:o}).promise;const v=c.toDataURL("image/png");a.push({dataUrl:v,selected:!0})}h(a)}catch(u){console.error(u),alert("Failed to render preview: "+u.message)}}}function D(g){h(n=>n.map((u,r)=>r===g?{...u,selected:!u.selected}:u))}async function N(){if(!(!i||l.length===0)){x(!0);try{const g=(await ne(async()=>{const{default:u}=await import("./vendor_pptxgenjs-aKi9TcwB.js");return{default:u}},__vite__mapDeps([3,0,1]))).default,n=new g;for(const u of l){if(!u.selected)continue;n.addSlide().addImage({data:u.dataUrl,x:0,y:0,w:"100%",h:"100%"})}await n.writeFile({fileName:i.name.replace(/\.pdf$/i,"")+".pptx"})}catch(g){console.error(g),alert("Conversion failed: "+g.message)}finally{x(!1)}}}return e.jsxs("div",{children:[e.jsx("h2",{children:"PDF → PPTX"}),e.jsxs("div",{className:"dropzone",children:[e.jsx("input",{type:"file",accept:"application/pdf",onChange:y}),e.jsx("div",{className:"muted",children:"Select a PDF — each page will become a PPTX slide (image). You can preview and deselect pages before export."}),e.jsx("div",{className:"muted",style:{marginTop:6,fontSize:12},children:"Note: slides are exported as images — text isn't editable in PowerPoint."})]}),l.length>0&&e.jsxs("div",{style:{marginTop:12},children:[e.jsx("div",{className:"muted",children:"Preview (click to toggle include)"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(120px,1fr))",gap:8,marginTop:8},children:l.map((g,n)=>e.jsxs("div",{style:{border:g.selected?"2px solid #3b82f6":"1px solid #ddd",padding:6,cursor:"pointer"},onClick:()=>D(n),children:[e.jsx("img",{src:g.dataUrl,style:{width:"100%",height:120,objectFit:"cover"},alt:`page-${n+1}`}),e.jsxs("div",{style:{fontSize:12,marginTop:6,textAlign:"center"},children:["Page ",n+1]})]},n))})]}),e.jsx("div",{style:{marginTop:12},children:e.jsx("button",{className:"btn",onClick:N,disabled:p||l.length===0,children:p?"Converting...":"Convert to PPTX"})})]})}function Ne(){const[i,w]=d.useState(null),[p,x]=d.useState(!1);function l(y){const D=y.target.files[0];D&&w(D)}async function h(){if(i){x(!0);try{const y=await i.arrayBuffer(),D=await re.loadAsync(y),N=Object.keys(D.files).filter(n=>n.startsWith("ppt/media/")),g=[];for(const n of N){const u=await D.file(n).async("blob");g.push(u)}if(g.length===0){alert("No embedded slide images found in PPTX. This tool only supports PPTX files that contain slide images."),x(!1);return}if(g.length>0){const{jsPDF:n}=await ne(async()=>{const{jsPDF:r}=await import("./vendor_jspdf-G1Ni3NiI.js").then(a=>a.j);return{jsPDF:r}},__vite__mapDeps([0,1])),u=new n({unit:"px",format:"a4"});for(let r=0;r<g.length;r++){const a=g[r],t=URL.createObjectURL(a),s=await new Promise(m=>{const v=new Image;v.onload=()=>m(v),v.src=t}),o=u.internal.pageSize.getWidth(),c=u.internal.pageSize.getHeight();u.addImage(s,"PNG",0,0,o,c),r<g.length-1&&u.addPage(),URL.revokeObjectURL(t)}u.save(i.name.replace(/\.pptx$/i,"")+".pdf")}else{const n=new re;for(let r=0;r<g.length;r++){const a=await g[r].arrayBuffer();n.file(`slide_${r+1}.png`,a)}const u=await n.generateAsync({type:"blob"});de.saveAs(u,i.name.replace(/\.pptx$/i,"")+"_slides.zip")}}catch(y){console.error(y),alert("Conversion failed: "+y.message)}finally{x(!1)}}}return e.jsxs("div",{children:[e.jsx("h2",{children:"PPTX → PDF"}),e.jsxs("div",{className:"dropzone",children:[e.jsx("input",{type:"file",accept:".pptx,application/vnd.openxmlformats-officedocument.presentationml.presentation",onChange:l}),e.jsx("div",{className:"muted",children:"Select a PPTX. If the file contains embedded slide images, they'll be converted to PDF pages; otherwise you'll get a ZIP of extracted images."})]}),e.jsx("div",{style:{marginTop:12},children:e.jsx("button",{className:"btn",onClick:h,disabled:!i||p,children:p?"Converting...":"Convert to PDF"})})]})}try{L.GlobalWorkerOptions.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${L.version}/pdf.worker.min.js`}catch{}function ke(i,w,p){const x=i.slice(),l=x.splice(w,1)[0];return x.splice(p,0,l),x}function Re(){const[i,w]=d.useState(null),[p,x]=d.useState([]),[l,h]=d.useState(!1);async function y(n){const u=n.target.files[0];if(!u)return;w(u),x([]);const r=await u.arrayBuffer(),a=await L.getDocument({data:r}).promise,t=[];for(let s=1;s<=a.numPages;s++){const o=await a.getPage(s),c=o.getViewport({scale:1}),m=document.createElement("canvas");m.width=Math.ceil(c.width),m.height=Math.ceil(c.height);const v=m.getContext("2d");await o.render({canvasContext:v,viewport:c}).promise,t.push({thumb:m.toDataURL("image/png"),idx:s-1})}x(t)}function D(n,u){n.dataTransfer.setData("text/plain",u)}function N(n,u){n.preventDefault();const r=parseInt(n.dataTransfer.getData("text/plain"),10);x(a=>ke(a,r,u))}async function g(){if(i){h(!0);try{const n=await i.arrayBuffer(),u=await Z.load(n),r=await Z.create(),a=p.map(v=>v.idx);(await r.copyPages(u,a)).forEach(v=>r.addPage(v));const s=await r.save(),o=new Blob([s],{type:"application/pdf"}),c=URL.createObjectURL(o),m=document.createElement("a");m.href=c,m.download=i.name.replace(/\.pdf$/i,"")+"_reordered.pdf",m.click(),URL.revokeObjectURL(c)}catch(n){console.error(n),alert("Export failed: "+n.message)}finally{h(!1)}}}return e.jsxs("div",{children:[e.jsx("h2",{children:"Reorder Pages"}),e.jsxs("div",{className:"dropzone",children:[e.jsx("input",{type:"file",accept:"application/pdf",onChange:y}),e.jsx("div",{className:"muted",children:"Drag thumbnails to reorder pages, then export."})]}),p.length>0&&e.jsxs("div",{style:{marginTop:12},children:[e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(100px,1fr))",gap:8},children:p.map((n,u)=>e.jsxs("div",{className:"file-item",draggable:!0,onDragStart:r=>D(r,u),onDragOver:r=>r.preventDefault(),onDrop:r=>N(r,u),style:{textAlign:"center"},children:[e.jsx("img",{src:n.thumb,style:{width:"100%",height:100,objectFit:"cover"},alt:`page-${u+1}`}),e.jsxs("div",{style:{fontSize:12,marginTop:6},children:["Pos ",u+1]})]},u))}),e.jsx("div",{style:{marginTop:12},children:e.jsx("button",{className:"btn",onClick:g,disabled:l,children:l?"Exporting...":"Export Reordered PDF"})})]})]})}function Fe(){const[i,w]=d.useState(null),[p,x]=d.useState([]),[l,h]=d.useState(!1);async function y(g){const n=g.target.files[0];if(!n)return;w(n);const u=await n.arrayBuffer(),r=await Z.load(u);x(new Array(r.getPageCount()).fill(!1))}function D(g){x(n=>n.map((u,r)=>r===g?!u:u))}async function N(g){if(i){h(!0);try{const n=await i.arrayBuffer(),u=await Z.load(n),r=await Z.create(),a=u.getPageCount(),t=[...Array(a).keys()];(await r.copyPages(u,t)).forEach((T,k)=>{if(p[k]){const E=g==="cw"?90:270;T.setRotation(E)}r.addPage(T)});const o=await r.save(),c=new Blob([o],{type:"application/pdf"}),m=URL.createObjectURL(c),v=document.createElement("a");v.href=m,v.download=i.name.replace(/\.pdf$/i,"")+"_rotated.pdf",v.click(),URL.revokeObjectURL(m)}catch(n){console.error(n),alert("Rotate failed: "+n.message)}finally{h(!1)}}}return e.jsxs("div",{children:[e.jsx("h2",{children:"Rotate Pages"}),e.jsxs("div",{className:"dropzone",children:[e.jsx("input",{type:"file",accept:"application/pdf",onChange:y}),e.jsx("div",{className:"muted",children:"Load a PDF then select pages to rotate."})]}),p.length>0&&e.jsxs("div",{style:{marginTop:12},children:[e.jsx("div",{className:"muted",children:"Click pages to toggle selection for rotation."}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(120px,1fr))",gap:8,marginTop:8},children:p.map((g,n)=>e.jsxs("div",{className:"file-item",onClick:()=>D(n),style:{cursor:"pointer",background:g?"#eef2ff":""},children:["Page ",n+1]},n))}),e.jsxs("div",{style:{marginTop:12,display:"flex",gap:8},children:[e.jsx("button",{className:"btn",onClick:()=>N("cw"),disabled:l,children:"Rotate CW"}),e.jsx("button",{className:"btn",onClick:()=>N("ccw"),disabled:l,children:"Rotate CCW"})]})]})]})}try{L.GlobalWorkerOptions.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${L.version}/pdf.worker.min.js`}catch{}function Ee({ov:i,onDrag:w,onStartDrag:p,onStartResize:x}){return e.jsxs("div",{className:"sig-overlay",style:{left:i.x,top:i.y,width:i.w,height:i.h},onMouseDown:p,children:[e.jsx("img",{src:i.dataUrl,className:"sig-image",alt:"sig"}),e.jsx("div",{className:"sig-resize",onMouseDown:x})]})}function Le(){const[i,w]=d.useState(null),[p,x]=d.useState([]),[l,h]=d.useState(null),[y,D]=d.useState([]),[N,g]=d.useState(null),n=d.useRef([]),[u,r]=d.useState(!1),a=d.useRef(null),t=d.useRef(null);d.useEffect(()=>{function b(f){if(!t.current)return;const{type:j,idx:C,startX:F,startY:R,startW:U,startH:O,page:B}=t.current,J=f.clientX-F,G=f.clientY-R;D(H=>{const A=H.slice(),X={...A[C]};return j==="move"?(X.x=Math.max(0,F+J-A[`_pageOffset${B}`]),X.y=Math.max(0,R+G-A[`_pageOffsetY${B}`])):j==="resize"&&(X.w=Math.max(10,U+J),X.h=Math.max(10,O+G)),A[C]=X,A})}function P(){t.current=null}return window.addEventListener("mousemove",b),window.addEventListener("mouseup",P),()=>{window.removeEventListener("mousemove",b),window.removeEventListener("mouseup",P)}},[]);async function s(b){var f;const P=(f=b.target.files)==null?void 0:f[0];P&&(w(P),await c(P))}function o(b){var j;const P=(j=b.target.files)==null?void 0:j[0];if(!P)return;const f=new FileReader;f.onload=()=>h(f.result),f.readAsDataURL(P)}async function c(b){const P=await b.arrayBuffer(),j=await L.getDocument({data:P}).promise,C=[];for(let F=1;F<=j.numPages;F++){const R=await j.getPage(F),U=R.getViewport({scale:1.5}),O=document.createElement("canvas");O.width=Math.floor(U.width),O.height=Math.floor(U.height);const B=O.getContext("2d");await R.render({canvasContext:B,viewport:U}).promise,C.push({canvas:O,width:O.width,height:O.height,viewportWidth:U.width,viewportHeight:U.height})}x(C),D([])}function m(b,P){b.preventDefault();const j=y[P].page,F=p[j].canvas.getBoundingClientRect();D(R=>{const U=R.slice();return U[`_pageOffset${j}`]=F.left,U[`_pageOffsetY${j}`]=F.top,U}),g(P),t.current={type:"move",idx:P,startX:b.clientX,startY:b.clientY,page:j}}function v(b,P){b.preventDefault();const f=y[P];t.current={type:"resize",idx:P,startX:b.clientX,startY:b.clientY,startW:f.w,startH:f.h}}function T(b){if(!l)return alert("Create or upload a signature first");const P=p[b];if(!P)return;const f=Math.min(200,P.width*.4),j=Math.min(80,P.height*.15),C=(P.width-f)/2,F=(P.height-j)/2;D(R=>{const U=R.concat({page:b,x:C,y:F,w:f,h:j,dataUrl:l});return n.current.push(R),U})}function k(){N!==null&&(D(b=>{const P=b.slice();return P.splice(N,1),n.current.push(b),P}),g(null))}function _(){const b=n.current.pop();b&&D(b)}async function E(){if(!i)return alert("Select a PDF first");if(y.length===0)return alert("Place a signature before exporting");r(!0);try{const b=await i.arrayBuffer(),P=await Z.load(b),f=await(await fetch(l)).arrayBuffer(),j=String(l).startsWith("data:image/jpeg")||String(l).startsWith("data:image/jpg");let C=null;if(j)try{C=await P.embedJpg(f)}catch{C=await P.embedPng(f)}else try{C=await P.embedPng(f)}catch{C=await P.embedJpg(f)}for(const B of y){const J=P.getPages()[B.page],{width:G,height:H}=J.getSize(),A=p[B.page],X=A.width,S=A.height,z=G/X,I=H/S,M=B.x*z,$=H-(B.y+B.h)*I,W=B.w*z,V=B.h*I;J.drawImage(C,{x:M,y:$,width:W,height:V})}const F=await P.save(),R=new Blob([F],{type:"application/pdf"}),U=URL.createObjectURL(R),O=document.createElement("a");O.href=U,O.download=i.name.replace(/\.pdf$/i,"")+"_signed.pdf",O.click(),URL.revokeObjectURL(U)}catch(b){console.error(b),alert("Failed: "+(b.message||b))}finally{r(!1)}}return e.jsxs("div",{children:[e.jsx("h2",{children:"Signature"}),e.jsxs("div",{style:{display:"flex",gap:12,flexWrap:"wrap"},children:[e.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:6},children:["Select PDF",e.jsx("input",{"aria-label":"Select PDF file",type:"file",accept:"application/pdf",onChange:s})]}),e.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:6},children:["Upload signature image",e.jsx("input",{"aria-label":"Upload signature image",type:"file",accept:"image/*",onChange:o})]})]}),e.jsx("div",{style:{marginTop:12},children:e.jsx("div",{className:"muted",children:`Render preview below, then click a page's "Add" to place signature, drag/resize overlay as needed.`})}),e.jsx("div",{ref:a,style:{marginTop:12,display:"flex",flexDirection:"column",gap:18},children:p.map((b,P)=>e.jsxs("div",{style:{position:"relative",border:"1px solid var(--border)",display:"inline-block"},children:[e.jsx("div",{style:{position:"absolute",right:8,top:8,zIndex:10},children:e.jsx("button",{className:"btn-ghost",onClick:()=>T(P),children:"Add"})}),e.jsx("div",{style:{position:"relative"},children:e.jsx("div",{style:{position:"relative"},children:e.jsxs("div",{style:{position:"relative"},children:[e.jsxs("div",{style:{width:b.width,height:b.height},children:[e.jsx("div",{dangerouslySetInnerHTML:{__html:""}}),e.jsx("div",{ref:f=>{f&&!f.firstChild&&f.appendChild(b.canvas)}})]}),y.map((f,j)=>f.page===P?e.jsx(Ee,{ov:f,onStartDrag:C=>m(C,j),onStartResize:C=>v(C,j)},j):null)]})})})]},P))}),e.jsxs("div",{style:{marginTop:12,display:"flex",gap:8},children:[e.jsx("button",{className:"btn-primary",onClick:E,disabled:u||!i||y.length===0,children:u?"Working...":"Export Signed PDF"}),e.jsx("button",{className:"btn-ghost",onClick:k,disabled:N===null,children:"Delete"}),e.jsx("button",{className:"btn-ghost",onClick:_,disabled:n.current.length===0,children:"Undo"})]})]})}function Ue(){const[i,w]=d.useState(null),[p,x]=d.useState("text"),[l,h]=d.useState("Sample Watermark"),[y,D]=d.useState(.25),[N,g]=d.useState(30),[n,u]=d.useState(1),[r,a]=d.useState(!1),[t,s]=d.useState(null),[o,c]=d.useState(null),[m,v]=d.useState(!1),T=d.useRef(null);d.useEffect(()=>{b()},[l,o,y,N,n,r,p]);async function k(f){var C;const j=(C=f.target.files)==null?void 0:C[0];j&&w(j)}async function _(f){var F;const j=(F=f.target.files)==null?void 0:F[0];if(!j)return;s(j);const C=new FileReader;C.onload=()=>c(C.result),C.readAsDataURL(j)}function E(f,j,C){f.clearRect(0,0,j,C),f.save(),f.globalAlpha=Number(y),f.translate(j/2,C/2),f.rotate(N*Math.PI/180);const F=Number(n)||1;if(p==="text"){f.font=`${48*F}px sans-serif`;try{const R=getComputedStyle(document.documentElement);f.fillStyle=R.getPropertyValue("--muted")||"#444"}catch{f.fillStyle="#444"}if(f.textAlign="center",f.textBaseline="middle",r){const R=300*F,U=200*F;for(let O=-C;O<C*2;O+=U)for(let B=-j;B<j*2;B+=R)f.save(),f.translate(B,O),f.fillText(l,0,0),f.restore()}else f.fillText(l,0,0)}else if(p==="image"&&o){const R=new Image;R.src=o,R.onload=()=>{const U=R.naturalWidth*F,O=R.naturalHeight*F;if(r){const B=U+60,J=O+60;for(let G=-C;G<C*2;G+=J)for(let H=-j;H<j*2;H+=B)f.drawImage(R,H,G,U,O)}else f.drawImage(R,-U/2,-O/2,U,O)}}f.restore()}function b(){const f=T.current;if(!f)return;const j=f.getContext("2d"),C=f.width,F=f.height;try{const R=getComputedStyle(document.documentElement);j.fillStyle=R.getPropertyValue("--paper")||"#fff",j.strokeStyle=R.getPropertyValue("--border")||"#ddd"}catch{j.fillStyle="#fff",j.strokeStyle="#ddd"}j.fillRect(0,0,C,F),j.strokeRect(10,10,C-20,F-20),j.save(),j.translate(C/2,F/2),E(j,C,F),j.restore()}async function P(){if(!i)return alert("Select a PDF");v(!0);try{const f=await i.arrayBuffer(),j=await Z.load(f),C=j.getPages();let F=null,R=null,U=!1;p==="image"&&t&&(F=await t.arrayBuffer(),U=(t.type||"").toLowerCase().includes("png"),U?R=await j.embedPng(F):R=await j.embedJpg(F));for(const H of C){const{width:A,height:X}=H.getSize();if(p==="text"){const S=48*Number(n||1),z={x:A/2,y:X/2,size:S,color:ae(.4,.4,.4),rotate:void 0,opacity:Number(y),xSkew:0};if(r){const I=300*Number(n||1),M=200*Number(n||1);for(let $=-M;$<X+M;$+=M)for(let W=-I;W<A+I;W+=I)H.drawText(l,{x:W+I/2,y:$+M/2,size:S,color:ae(.4,.4,.4),opacity:Number(y)})}else H.drawText(l,{x:A/2-l.length*S*.12,y:X/2,size:S,color:ae(.4,.4,.4),opacity:Number(y)})}else if(p==="image"&&R){const S=R.width*Number(n||1),z=R.height*Number(n||1);if(r){const I=S+40,M=z+40;for(let $=-M;$<X+M;$+=M)for(let W=-I;W<A+I;W+=I)H.drawImage(R,{x:W,y:$,width:S,height:z,opacity:Number(y)})}else H.drawImage(R,{x:A/2-S/2,y:X/2-z/2,width:S,height:z,opacity:Number(y)})}}const O=await j.save(),B=new Blob([O],{type:"application/pdf"}),J=URL.createObjectURL(B),G=document.createElement("a");G.href=J,G.download=i.name.replace(/\.pdf$/i,"")+"_watermarked.pdf",G.click(),URL.revokeObjectURL(J)}catch(f){console.error(f),alert("Failed: "+(f.message||f))}finally{v(!1)}}return e.jsxs("div",{children:[e.jsx("h2",{children:"Watermark PDF"}),e.jsx("div",{children:e.jsx("input",{type:"file",accept:"application/pdf",onChange:k})}),e.jsxs("div",{style:{marginTop:12,display:"flex",gap:12,alignItems:"center",flexWrap:"wrap"},children:[e.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[e.jsx("input",{type:"radio",name:"mode",value:"text",checked:p==="text",onChange:()=>x("text")})," Text"]}),e.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[e.jsx("input",{type:"radio",name:"mode",value:"image",checked:p==="image",onChange:()=>x("image")})," Image"]}),p==="image"&&e.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:["Image: ",e.jsx("input",{type:"file",accept:"image/*",onChange:_})]})]}),p==="text"&&e.jsx("div",{style:{marginTop:8},children:e.jsx("input",{value:l,onChange:f=>h(f.target.value),style:{width:"60%"}})}),e.jsxs("div",{style:{marginTop:8,display:"flex",gap:12,alignItems:"center",flexWrap:"wrap"},children:[e.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:["Opacity",e.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:y,onChange:f=>D(Number(f.target.value))}),e.jsxs("div",{style:{width:48,textAlign:"right"},children:[Math.round(y*100),"%"]})]}),e.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:["Rotation",e.jsx("input",{type:"number",value:N,onChange:f=>g(Number(f.target.value)),style:{width:80}})]}),e.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:["Scale",e.jsx("input",{type:"range",min:"0.1",max:"3",step:"0.05",value:n,onChange:f=>u(Number(f.target.value))}),e.jsxs("div",{style:{width:48,textAlign:"right"},children:[n.toFixed(2),"x"]})]}),e.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[e.jsx("input",{type:"checkbox",checked:r,onChange:f=>a(f.target.checked)})," Tiling"]})]}),e.jsxs("div",{style:{marginTop:12},children:[e.jsx("div",{className:"muted",children:"Preview"}),e.jsx("canvas",{"aria-label":"Watermark preview",ref:T,width:600,height:800,style:{width:"100%",maxWidth:600,display:"block",border:"1px solid var(--border)",background:"var(--paper)"}})]}),e.jsx("div",{style:{marginTop:12},children:e.jsx("button",{className:"btn-primary",onClick:P,disabled:m||!i,children:m?"Working...":"Apply Watermark"})})]})}function Oe(){const[i,w]=d.useState(null),[p,x]=d.useState(!1),[l,h]=d.useState(!1),[y,D]=d.useState(!1);async function N(t){const s=t.target.files[0];s&&w(s)}function g(t){t.preventDefault(),h(!0)}function n(t){t.preventDefault(),t.dataTransfer.dropEffect="copy"}function u(t){t.preventDefault(),h(!1)}async function r(t){var o,c;t.preventDefault(),h(!1);const s=(c=(o=t.dataTransfer)==null?void 0:o.files)==null?void 0:c[0];s&&(w(s),D(!0),setTimeout(()=>D(!1),1500))}async function a(){if(i){x(!0);try{const t=await i.arrayBuffer(),o=(await ue.convertToHtml({arrayBuffer:t})).value,c=document.createElement("div");c.innerHTML=o,c.style.padding="20px",document.body.appendChild(c);const v=(await me(c,{scale:2})).toDataURL("image/png"),{jsPDF:T}=await ne(async()=>{const{jsPDF:P}=await import("./vendor_jspdf-G1Ni3NiI.js").then(f=>f.j);return{jsPDF:P}},__vite__mapDeps([0,1])),k=new T("p","mm","a4"),_=k.getImageProperties(v),E=210,b=_.height*E/_.width;k.addImage(v,"PNG",0,0,E,b),k.save(i.name.replace(/\.docx$/i,"")+".pdf"),document.body.removeChild(c)}catch(t){console.error(t),alert("Failed: "+t.message)}finally{x(!1)}}}return e.jsxs("div",{children:[e.jsx("h2",{children:"Word (.docx) → PDF"}),e.jsxs("div",{className:`dropzone ${l?"dragover":""}`,onDragEnter:g,onDragOver:n,onDragLeave:u,onDrop:r,children:[e.jsx("input",{type:"file",accept:".docx,application/vnd.openxmlformats-officedocument.wordprocessingml.document",onChange:N}),e.jsx("div",{className:"muted",children:"Select a .docx file to convert to PDF (simple formatting)."}),y&&e.jsx("div",{className:"drop-overlay",children:"✓ Uploaded"})]}),e.jsx("div",{style:{marginTop:12},children:e.jsx("button",{className:"btn-primary",onClick:a,disabled:p||!i,children:p?"Working...":"Convert to PDF"})})]})}const Be={pdf2text:he,pdf2word:xe,merge:ye,split:we,imgs2pdf:ve,pdf2imgs:je,annotate:be,compress:Pe,edit:Se,ocr:De,pagenums:Te,pdf2ppt:Ce,ppt2pdf:Ne,reorder:Re,rotate:Fe,signature:Le,watermark:Ue,word2pdf:Oe};function Ie({toolId:i,onClose:w}){const[p,x]=d.useState(!1);d.useEffect(()=>{x(!0);const h=y=>{y.key==="Escape"&&w()};return window.addEventListener("keydown",h),()=>window.removeEventListener("keydown",h)},[]);const l=Be[i];return l?e.jsxs("div",{className:`tool-container ${p?"mounted":""}`,children:[e.jsxs("div",{className:"tool-header",children:[e.jsx("button",{onClick:w,className:"close-btn",children:"×"}),e.jsx("h1",{children:i})]}),e.jsx("div",{className:"tool-content",children:e.jsx(l,{})})]}):e.jsxs("div",{className:"tool-container",children:[e.jsxs("div",{className:"tool-header",children:[e.jsx("button",{onClick:w,className:"close-btn",children:"×"}),e.jsx("h1",{children:"Tool Not Found"})]}),e.jsx("div",{className:"tool-content",children:e.jsxs("p",{children:['The requested tool "',i,'" is not available.']})})]})}function Me(){const[i,w]=d.useState([]),[p,x]=d.useState(null);return d.useEffect(()=>{const l=h=>{x(h.detail)};return window.addEventListener("open-tool",l),()=>window.removeEventListener("open-tool",l)},[]),d.useEffect(()=>{fetch("/tools.json").then(l=>l.json()).then(l=>w(l)).catch(l=>console.error("Error loading tools:",l))},[]),e.jsx("div",{className:"app",children:p?e.jsx(Ie,{toolId:p,onClose:()=>{x(null),window.history.pushState({},"","/")}}):e.jsxs(e.Fragment,{children:[e.jsx("header",{className:"landing-header",children:e.jsxs("div",{className:"landing-inner",children:[e.jsx("div",{className:"landing-left",children:e.jsx("div",{className:"logo-dexpdf",children:e.jsxs("svg",{width:"92",height:"36",viewBox:"0 0 92 36",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("rect",{width:"82",height:"36",rx:"4",fill:"#CF2727"}),e.jsx("text",{x:"12",y:"26",fill:"white",fontFamily:"Arial",fontSize:"24",fontWeight:"bold",children:"DEX"})]})})}),e.jsxs("div",{className:"landing-right",children:[e.jsx("span",{className:"hello",children:"HELLO"}),e.jsx("div",{className:"logo-dexers",children:e.jsx("svg",{width:"120",height:"28",viewBox:"0 0 120 28",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("text",{x:"0",y:"22",fill:"#111",fontFamily:"Arial",fontSize:"22",fontWeight:"bold",children:"DEXERS"})})})]})]})}),e.jsx("main",{className:"landing-main",children:e.jsx("div",{className:"landing-grid-inner",children:i.map(l=>e.jsx("a",{href:`/?tool=${l.id}`,className:"landing-card-link",onClick:h=>{h.preventDefault(),console.log("Tool clicked:",l.id),window.dispatchEvent(new CustomEvent("open-tool",{detail:l.id}))},children:e.jsxs("div",{className:"landing-card",children:[e.jsx("h2",{className:"landing-card-title",children:l.name}),e.jsx("p",{className:"landing-card-desc",children:l.desc}),e.jsx("button",{className:"landing-card-btn",children:"Open"})]})},l.id))})})]})})}fe(document.getElementById("root")).render(e.jsx(pe.StrictMode,{children:e.jsx(Me,{})}));
