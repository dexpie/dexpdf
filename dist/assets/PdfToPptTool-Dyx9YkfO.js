const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/pptxgen.es-B9nbnVfh.js","assets/jszip.min-uDnA5uOy.js","assets/index-D_qvBJzx.js","assets/index-B8dLZLVq.css","assets/_commonjs-dynamic-modules-TDtrdbi3.js"])))=>i.map(i=>d[i]);
import{r as p,j as e,_ as T}from"./index-D_qvBJzx.js";import{p as m}from"./pdf-CB4NDRGm.js";import"./_commonjs-dynamic-modules-TDtrdbi3.js";try{m.GlobalWorkerOptions.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${m.version}/pdf.worker.min.js`}catch(o){console.warn("pdfjs worker not set",o)}function S(){const[o,x]=p.useState(null),[f,g]=p.useState(!1),[i,l]=p.useState([]);async function v(s){const t=s.target.files[0];if(t){x(t),l([]);try{const a=await t.arrayBuffer(),r=await m.getDocument({data:a}).promise,u=[];for(let c=1;c<=r.numPages;c++){const h=await r.getPage(c),d=h.getViewport({scale:1.5}),n=document.createElement("canvas");n.width=Math.ceil(d.width),n.height=Math.ceil(d.height);const P=n.getContext("2d");await h.render({canvasContext:P,viewport:d}).promise;const y=n.toDataURL("image/png");u.push({dataUrl:y,selected:!0})}l(u)}catch(a){console.error(a),alert("Failed to render preview: "+a.message)}}}function w(s){l(t=>t.map((a,r)=>r===s?{...a,selected:!a.selected}:a))}async function j(){if(!(!o||i.length===0)){g(!0);try{const s=(await T(async()=>{const{default:a}=await import("./pptxgen.es-B9nbnVfh.js");return{default:a}},__vite__mapDeps([0,1,2,3,4]))).default,t=new s;for(const a of i){if(!a.selected)continue;t.addSlide().addImage({data:a.dataUrl,x:0,y:0,w:"100%",h:"100%"})}await t.writeFile({fileName:o.name.replace(/\.pdf$/i,"")+".pptx"})}catch(s){console.error(s),alert("Conversion failed: "+s.message)}finally{g(!1)}}}return e.jsxs("div",{children:[e.jsx("h2",{children:"PDF → PPTX"}),e.jsxs("div",{className:"dropzone",children:[e.jsx("input",{type:"file",accept:"application/pdf",onChange:v}),e.jsx("div",{className:"muted",children:"Select a PDF — each page will become a PPTX slide (image). You can preview and deselect pages before export."}),e.jsx("div",{className:"muted",style:{marginTop:6,fontSize:12},children:"Note: slides are exported as images — text isn't editable in PowerPoint."})]}),i.length>0&&e.jsxs("div",{style:{marginTop:12},children:[e.jsx("div",{className:"muted",children:"Preview (click to toggle include)"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(120px,1fr))",gap:8,marginTop:8},children:i.map((s,t)=>e.jsxs("div",{style:{border:s.selected?"2px solid #3b82f6":"1px solid #ddd",padding:6,cursor:"pointer"},onClick:()=>w(t),children:[e.jsx("img",{src:s.dataUrl,style:{width:"100%",height:120,objectFit:"cover"},alt:`page-${t+1}`}),e.jsxs("div",{style:{fontSize:12,marginTop:6,textAlign:"center"},children:["Page ",t+1]})]},t))})]}),e.jsx("div",{style:{marginTop:12},children:e.jsx("button",{className:"btn",onClick:j,disabled:f||i.length===0,children:f?"Converting...":"Convert to PPTX"})})]})}export{S as default};
