const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/vendor_jszip-B1Nm6Iki.js","assets/vendor-zMBkNqCM.js","assets/vendor_jspdf-DlgZQKHI.js","assets/vendor_tesseract-BwXTs-dD.js","assets/vendor_pptxgenjs-DrD6mDTk.js","assets/vendor_pdf_lib-CHoXx7fs.js","assets/vendor_pdfjs-zbSBfwBn.js"])))=>i.map(i=>d[i]);
import{j as e,r as n,R as Q,P as De,k as Be,l as Re,m as Ue,n as Ee,B as we,o as Te,C as ze,T as Me,q as Ae}from"./vendor-zMBkNqCM.js";import{a as X}from"./vendor_pdfjs-zbSBfwBn.js";import{_ as de,E as Le}from"./vendor_jspdf-DlgZQKHI.js";import{PDFDocument as re,StandardFonts as je,rgb as ge}from"./vendor_pdf_lib-CHoXx7fs.js";import{J as ve}from"./vendor_jszip-B1Nm6Iki.js";import{P as We}from"./vendor_papaparse-CGyRCadE.js";import ke from"./vendor_html2canvas-CBrSDip1.js";(function(){const w=document.createElement("link").relList;if(w&&w.supports&&w.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))y(a);new MutationObserver(a=>{for(const E of a)if(E.type==="childList")for(const d of E.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&y(d)}).observe(document,{childList:!0,subtree:!0});function s(a){const E={};return a.integrity&&(E.integrity=a.integrity),a.referrerPolicy&&(E.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?E.credentials="include":a.crossOrigin==="anonymous"?E.credentials="omit":E.credentials="same-origin",E}function y(a){if(a.ep)return;a.ep=!0;const E=s(a);fetch(a.href,E)}})();window.addEventListener("open-tool",t=>{const w=t.detail;localStorage.setItem("lastTool",w);const s=new URL(window.location);s.searchParams.set("tool",w),window.history.pushState({},"",s),console.log("Opening tool:",w)});function ce({value:t,onChange:w,disabled:s=!1,placeholder:y="output",label:a="Nama File Output (opsional):",helperText:E="Kosongkan untuk menggunakan nama default. Ekstensi .pdf akan ditambahkan otomatis."}){return e.jsxs("div",{style:{marginTop:12},children:[e.jsx("label",{style:{display:"block",marginBottom:4,fontWeight:500,color:"#374151"},children:a}),e.jsx("input",{type:"text",value:t,onChange:w,placeholder:y,disabled:s,style:{width:"100%",padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:6,fontSize:14,outline:"none",transition:"border-color 0.2s"},onFocus:d=>d.target.style.borderColor="#3b82f6",onBlur:d=>d.target.style.borderColor="#d1d5db"}),e.jsx("div",{style:{fontSize:12,color:"#6b7280",marginTop:4},children:E})]})}function ie(t,w="output",s=".pdf"){const y=(t||w).trim(),a=s.startsWith(".")?s:"."+s;return y.endsWith(a)?y:y+a}function pe(t,w=""){if(!t||!t.name)return w||"output";const s=t.name.replace(/\.\w+$/i,"");return w?s+w:s}function ue({toolName:t="Process",processFile:w,acceptedTypes:s=".pdf",outputExtension:y=".pdf",maxFiles:a=100,showPreview:E=!1,customOptions:d=null,onComplete:S=null}){const[v,D]=n.useState([]),[W,T]=n.useState(!1),[x,N]=n.useState([]),[j,k]=n.useState([]),[l,f]=n.useState(0),[u,p]=n.useState(!1),[g,B]=n.useState(""),m=n.useRef(null),i=n.useRef(!1),r=_=>{const F=Array.from(_);if(F.length+v.length>a){B(`Maximum ${a} files allowed`);return}D(h=>[...h,...F]),N(h=>[...h,...F.map(()=>({status:"pending",progress:0,error:null}))]),B("")},o=_=>{D(F=>F.filter((h,P)=>P!==_)),N(F=>F.filter((h,P)=>P!==_)),k(F=>F.filter((h,P)=>P!==_))},c=async()=>{if(v.length===0){B("Please add files first");return}T(!0),p(!1),i.current=!1;const _=[];for(let F=0;F<v.length;F++){for(;i.current;)await new Promise(h=>setTimeout(h,100));try{N(P=>{const M=[...P];return M[F]={status:"processing",progress:0,error:null},M});const h=await w(v[F],F,P=>{N(M=>{const U=[...M];return U[F]={...U[F],progress:P},U})});_[F]=h,k(_),N(P=>{const M=[...P];return M[F]={status:"completed",progress:100,error:null},M})}catch(h){console.error(`Error processing file ${F}:`,h),N(P=>{const M=[...P];return M[F]={status:"error",progress:0,error:h.message||"Processing failed"},M})}f(Math.round((F+1)/v.length*100))}T(!1),S&&S(_.filter(Boolean))},b=()=>{p(_=>!_),i.current=!i.current},R=_=>{if(!j[_])return;const F=j[_],h=URL.createObjectURL(F),P=document.createElement("a");P.href=h,P.download=v[_].name.replace(/\.[^/.]+$/,"")+"_processed"+y,document.body.appendChild(P),P.click(),document.body.removeChild(P),URL.revokeObjectURL(h)},C=async()=>{if(j.length!==0)try{const _=(await de(async()=>{const{default:M}=await import("./vendor_jszip-B1Nm6Iki.js").then(U=>U.j);return{default:M}},__vite__mapDeps([0,1]))).default,{saveAs:F}=await de(async()=>{const{saveAs:M}=await import("./vendor-zMBkNqCM.js").then(U=>U.F);return{saveAs:M}},__vite__mapDeps([1,0])),h=new _;j.forEach((M,U)=>{if(M){const $=v[U].name.replace(/\.[^/.]+$/,"")+"_processed"+y;h.file($,M)}});const P=await h.generateAsync({type:"blob"});F(P,`${t.toLowerCase().replace(/\s/g,"_")}_batch_${Date.now()}.zip`)}catch(_){console.error("Error creating ZIP:",_),B("Failed to create ZIP file")}},L=_=>{_.preventDefault(),r(_.dataTransfer.files)},I=_=>{_.preventDefault()},z=x.filter(_=>_.status==="completed").length,A=x.filter(_=>_.status==="error").length,q=x.filter(_=>_.status==="pending").length;return e.jsxs("div",{className:"batch-processor",children:[e.jsxs("div",{className:"batch-header",children:[e.jsxs("h3",{children:["🔄 Batch ",t]}),e.jsxs("p",{children:["Process up to ",a," files at once"]})]}),g&&e.jsxs("div",{className:"batch-error",children:["⚠️ ",g]}),e.jsxs("div",{className:"batch-upload-zone",onDrop:L,onDragOver:I,onClick:()=>{var _;return(_=m.current)==null?void 0:_.click()},children:[e.jsx("input",{ref:m,type:"file",multiple:!0,accept:s,onChange:_=>r(_.target.files),style:{display:"none"}}),e.jsx("div",{className:"upload-icon",children:"📁"}),e.jsx("div",{className:"upload-text",children:"Drop files here or click to browse"}),e.jsxs("div",{className:"upload-hint",children:["Supports: ",s," • Max ",a," files"]})]}),d&&e.jsx("div",{className:"batch-options",children:d}),v.length>0&&e.jsxs("div",{className:"batch-files",children:[e.jsxs("div",{className:"batch-files-header",children:[e.jsxs("h4",{children:["📋 Files (",v.length,")"]}),!W&&e.jsx("button",{className:"btn-clear",onClick:()=>{D([]),N([]),k([])},children:"Clear All"})]}),e.jsx("div",{className:"batch-files-list",children:v.map((_,F)=>{var h,P,M,U,$,H;return e.jsxs("div",{className:"batch-file-item",children:[e.jsxs("div",{className:"file-info",children:[e.jsx("div",{className:"file-icon",children:((h=x[F])==null?void 0:h.status)==="completed"?"✅":((P=x[F])==null?void 0:P.status)==="error"?"❌":((M=x[F])==null?void 0:M.status)==="processing"?"⏳":"📄"}),e.jsxs("div",{className:"file-details",children:[e.jsx("div",{className:"file-name",children:_.name}),e.jsxs("div",{className:"file-size",children:[(_.size/1024).toFixed(1)," KB"]})]})]}),((U=x[F])==null?void 0:U.status)==="processing"&&e.jsx("div",{className:"file-progress",children:e.jsx("div",{className:"file-progress-bar",style:{width:`${x[F].progress}%`}})}),(($=x[F])==null?void 0:$.status)==="error"&&e.jsx("div",{className:"file-error",children:x[F].error}),e.jsxs("div",{className:"file-actions",children:[((H=x[F])==null?void 0:H.status)==="completed"&&e.jsx("button",{className:"btn-download-small",onClick:()=>R(F),children:"💾"}),!W&&e.jsx("button",{className:"btn-remove",onClick:()=>o(F),children:"🗑️"})]})]},F)})})]}),W&&e.jsxs("div",{className:"batch-global-progress",children:[e.jsxs("div",{className:"progress-stats",children:[e.jsxs("div",{className:"stat",children:[e.jsx("span",{className:"stat-label",children:"Completed:"}),e.jsxs("span",{className:"stat-value",children:[z,"/",v.length]})]}),e.jsxs("div",{className:"stat",children:[e.jsx("span",{className:"stat-label",children:"Errors:"}),e.jsx("span",{className:"stat-value error",children:A})]}),e.jsxs("div",{className:"stat",children:[e.jsx("span",{className:"stat-label",children:"Pending:"}),e.jsx("span",{className:"stat-value",children:q})]})]}),e.jsx("div",{className:"global-progress-bar",children:e.jsx("div",{className:"global-progress-fill",style:{width:`${l}%`}})}),e.jsxs("div",{className:"global-progress-text",children:[l,"% complete"]})]}),e.jsxs("div",{className:"batch-actions",children:[!W&&v.length>0&&e.jsxs("button",{className:"btn-primary-batch",onClick:c,children:["🚀 Process All (",v.length," files)"]}),W&&e.jsx("button",{className:"btn-pause",onClick:b,children:u?"▶️ Resume":"⏸️ Pause"}),z>0&&!W&&e.jsx(e.Fragment,{children:e.jsxs("button",{className:"btn-download-all",onClick:C,children:["📦 Download All as ZIP (",z," files)"]})})]})]})}try{X.GlobalWorkerOptions.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${X.version}/pdf.worker.min.js`}catch{}function $e(){const[t,w]=n.useState(!1),[s,y]=n.useState(null),[a,E]=n.useState(!1),[d,S]=n.useState(!1),[v,D]=n.useState(!1),[W,T]=n.useState(""),[x,N]=n.useState(""),[j,k]=n.useState(""),l=Q.useRef(null),f=Q.useRef(null);Q.useEffect(()=>{W&&l.current&&l.current.focus()},[W]),Q.useEffect(()=>{x&&f.current&&f.current.focus()},[x]);async function u(o){T(""),N("");const c=o.target.files[0];if(c){if(!c.name.toLowerCase().endsWith(".pdf")){T("File harus PDF.");return}if(c.size>50*1024*1024){T("Ukuran file terlalu besar (maks 50MB).");return}y(c),k(pe(c))}}function p(o){o.preventDefault(),a||S(!0)}function g(o){o.preventDefault(),a||(o.dataTransfer.dropEffect="copy")}function B(o){o.preventDefault(),a||S(!1)}async function m(o){var b,R;if(o.preventDefault(),a)return;S(!1);const c=(R=(b=o.dataTransfer)==null?void 0:b.files)==null?void 0:R[0];c&&(y(c),D(!0),setTimeout(()=>D(!1),1500))}async function i(){if(!s){T("Pilih file PDF terlebih dahulu.");return}T(""),N(""),E(!0);try{const o=await s.arrayBuffer(),c=await X.getDocument({data:o}).promise;let b="";for(let I=1;I<=c.numPages;I++){const q=(await(await c.getPage(I)).getTextContent()).items.map(_=>_.str);b+=`
--- Page ${I} ---
`+q.join(" ")+`
`}const R=new Blob([b],{type:"text/plain"}),C=URL.createObjectURL(R),L=document.createElement("a");L.href=C,L.download=ie(j,s.name.replace(/\.pdf$/i,""),".txt"),L.click(),URL.revokeObjectURL(C),N("Berhasil! Teks berhasil diekstrak dan diunduh.")}catch(o){console.error(o),T("Gagal: "+(o.message||o))}finally{E(!1)}}const r=async(o,c,b)=>{try{b(10);const R=await o.arrayBuffer(),C=await X.getDocument({data:R}).promise;b(25);let L="";const I=C.numPages;for(let A=1;A<=I;A++){const F=(await(await C.getPage(A)).getTextContent()).items.map(h=>h.str);L+=`
--- Page ${A} ---
`+F.join(" ")+`
`,b(25+A/I*65)}b(90);const z=new Blob([L],{type:"text/plain"});return b(100),z}catch(R){throw console.error(`Error extracting text from ${o.name}:`,R),R}};return e.jsxs("div",{style:{maxWidth:520,margin:"0 auto",padding:12},children:[e.jsx("h2",{style:{textAlign:"center",marginBottom:16},children:"PDF → Text"}),e.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:8,marginBottom:16},children:[e.jsx("button",{className:t?"btn-outline":"btn-primary",onClick:()=>w(!1),style:{minWidth:120},children:"📄 Single File"}),e.jsx("button",{className:t?"btn-primary":"btn-outline",onClick:()=>w(!0),style:{minWidth:120},children:"🔄 Batch Extract"})]}),t&&e.jsx(ue,{toolName:"Extract Text",processFile:r,acceptedTypes:".pdf",outputExtension:".txt",maxFiles:100,customOptions:e.jsxs("div",{style:{padding:"12px 0"},children:[e.jsxs("div",{style:{fontSize:14,color:"#666",marginBottom:8},children:["💡 ",e.jsx("strong",{children:"Batch Extract Mode:"})," Extract text from multiple PDFs at once."]}),e.jsxs("div",{style:{fontSize:13,color:"#888"},children:["📝 Plain text extraction with page separators",e.jsx("br",{}),"📦 Download individual .txt files or all as ZIP",e.jsx("br",{}),"⚡ Process up to 100 PDFs simultaneously"]})]})}),!t&&e.jsxs("div",{children:[W&&e.jsx("div",{ref:l,tabIndex:-1,"aria-live":"assertive",style:{color:"#dc2626",marginBottom:8,background:"#fee2e2",padding:8,borderRadius:6,outline:"none"},children:W}),x&&e.jsx("div",{ref:f,tabIndex:-1,"aria-live":"polite",style:{color:"#059669",marginBottom:8,background:"#d1fae5",padding:8,borderRadius:6,outline:"none"},children:x}),a&&e.jsxs("div",{style:{marginBottom:8,display:"flex",alignItems:"center",gap:8},children:[e.jsx("span",{className:"loader",style:{display:"inline-block",width:24,height:24,border:"3px solid #3b82f6",borderTop:"3px solid #fff",borderRadius:"50%",animation:"spin 1s linear infinite",verticalAlign:"middle"}})," ",e.jsx("span",{children:"Memproses, mohon tunggu..."})]}),e.jsxs("div",{className:`dropzone ${d?"dragover":""}`,onDragEnter:p,onDragOver:g,onDragLeave:B,onDrop:m,style:{opacity:a?.6:1,pointerEvents:a?"none":"auto",border:"2px dashed #3b82f6",borderRadius:16,padding:24,marginBottom:16,background:"#f8fafc"},children:[e.jsx("input",{type:"file",accept:"application/pdf",onChange:u,disabled:a}),e.jsx("div",{className:"muted",children:"Select a PDF to extract text (plain text)."}),v&&e.jsx("div",{className:"drop-overlay",style:{position:"absolute",top:0,left:0,right:0,bottom:0,background:"rgba(59,130,246,0.1)",color:"#2563eb",fontSize:32,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:16},children:"✓ Uploaded"})]}),s&&e.jsxs("div",{style:{marginBottom:8,background:"#f9fafb",borderRadius:8,padding:8,boxShadow:"0 1px 4px #0001"},children:[e.jsx("div",{style:{fontWeight:500,color:"#3b82f6",wordBreak:"break-all"},children:s.name}),e.jsxs("div",{style:{color:"#888",fontSize:13},children:[(s.size/1024).toFixed(1)," KB • ",s.lastModified?new Date(s.lastModified).toLocaleString():""]})]}),s&&e.jsx(ce,{value:j,onChange:o=>k(o.target.value),disabled:a,placeholder:"output"}),e.jsxs("div",{style:{marginTop:12,display:"flex",gap:8,flexWrap:"wrap"},children:[e.jsx("button",{className:"btn-primary",onClick:i,disabled:a||!s,children:a?"Working...":"Extract Text"}),e.jsx("button",{className:"btn-ghost",style:{color:"#dc2626",marginLeft:"auto"},onClick:()=>{y(null),T(""),N("")},disabled:a||!s,children:"Reset"})]})]})]})}try{X.GlobalWorkerOptions.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${X.version}/pdf.worker.min.js`}catch{}function Ge(){const[t,w]=n.useState(!1),[s,y]=n.useState(null),[a,E]=n.useState(!1),[d,S]=n.useState(!1),[v,D]=n.useState(!1),[W,T]=n.useState(""),[x,N]=n.useState(""),[j,k]=n.useState(""),l=Q.useRef(null),f=Q.useRef(null);Q.useEffect(()=>{W&&l.current&&l.current.focus()},[W]),Q.useEffect(()=>{x&&f.current&&f.current.focus()},[x]);async function u(o){T(""),N("");const c=o.target.files[0];if(c){if(!c.name.toLowerCase().endsWith(".pdf")){T("File harus PDF.");return}if(c.size>50*1024*1024){T("Ukuran file terlalu besar (maks 50MB).");return}y(c),k(pe(c))}}function p(o){o.preventDefault(),a||S(!0)}function g(o){o.preventDefault(),a||(o.dataTransfer.dropEffect="copy")}function B(o){o.preventDefault(),a||S(!1)}async function m(o){var b,R;if(o.preventDefault(),a)return;S(!1);const c=(R=(b=o.dataTransfer)==null?void 0:b.files)==null?void 0:R[0];c&&(y(c),D(!0),setTimeout(()=>D(!1),1500))}async function i(){if(!s){T("Pilih file PDF terlebih dahulu.");return}T(""),N(""),E(!0);try{const o=await s.arrayBuffer(),c=await X.getDocument({data:o}).promise,b=[];for(let z=1;z<=c.numPages;z++){const _=(await(await c.getPage(z)).getTextContent()).items.map(F=>F.str);b.push(new De(_.join(" ")))}const R=new Be({sections:[{children:b}]}),C=await Re.toBlob(R),L=URL.createObjectURL(C),I=document.createElement("a");I.href=L,I.download=ie(j,s.name.replace(/\.pdf$/i,""),".docx"),I.click(),URL.revokeObjectURL(L),N("Berhasil! File berhasil dikonversi dan diunduh.")}catch(o){console.error(o),T("Gagal: "+(o.message||o))}finally{E(!1)}}const r=async(o,c,b)=>{try{b(10);const R=await o.arrayBuffer(),C=await X.getDocument({data:R}).promise;b(25);const L=[],I=C.numPages;for(let q=1;q<=I;q++){const h=(await(await C.getPage(q)).getTextContent()).items.map(P=>P.str);L.push(new De(h.join(" "))),b(25+q/I*60)}b(85);const z=new Be({sections:[{children:L}]}),A=await Re.toBlob(z);return b(100),A}catch(R){throw console.error(`Error converting ${o.name}:`,R),R}};return e.jsxs("div",{style:{maxWidth:520,margin:"0 auto",padding:12},children:[e.jsx("h2",{style:{textAlign:"center",marginBottom:16},children:"PDF → Word (.docx)"}),e.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:8,marginBottom:16},children:[e.jsx("button",{className:t?"btn-outline":"btn-primary",onClick:()=>w(!1),style:{minWidth:120},children:"📄 Single File"}),e.jsx("button",{className:t?"btn-primary":"btn-outline",onClick:()=>w(!0),style:{minWidth:120},children:"🔄 Batch Convert"})]}),t&&e.jsx(ue,{toolName:"PDF to Word",processFile:r,acceptedTypes:".pdf",outputExtension:".docx",maxFiles:100,customOptions:e.jsxs("div",{style:{padding:"12px 0"},children:[e.jsxs("div",{style:{fontSize:14,color:"#666",marginBottom:8},children:["💡 ",e.jsx("strong",{children:"Batch Convert Mode:"})," Convert multiple PDFs to Word documents at once."]}),e.jsxs("div",{style:{fontSize:13,color:"#888"},children:["📝 Text-only conversion (preserves text content)",e.jsx("br",{}),"📦 Download individual .docx files or all as ZIP",e.jsx("br",{}),"⚡ Process up to 100 PDFs simultaneously"]})]})}),!t&&e.jsxs("div",{children:[W&&e.jsx("div",{ref:l,tabIndex:-1,"aria-live":"assertive",style:{color:"#dc2626",marginBottom:8,background:"#fee2e2",padding:8,borderRadius:6,outline:"none"},children:W}),x&&e.jsx("div",{ref:f,tabIndex:-1,"aria-live":"polite",style:{color:"#059669",marginBottom:8,background:"#d1fae5",padding:8,borderRadius:6,outline:"none"},children:x}),a&&e.jsxs("div",{style:{marginBottom:8,display:"flex",alignItems:"center",gap:8},children:[e.jsx("span",{className:"loader",style:{display:"inline-block",width:24,height:24,border:"3px solid #3b82f6",borderTop:"3px solid #fff",borderRadius:"50%",animation:"spin 1s linear infinite",verticalAlign:"middle"}})," ",e.jsx("span",{children:"Memproses, mohon tunggu..."})]}),e.jsxs("div",{className:`dropzone ${d?"dragover":""}`,onDragEnter:p,onDragOver:g,onDragLeave:B,onDrop:m,style:{opacity:a?.6:1,pointerEvents:a?"none":"auto",border:"2px dashed #3b82f6",borderRadius:16,padding:24,marginBottom:16,background:"#f8fafc"},children:[e.jsx("input",{type:"file",accept:"application/pdf",onChange:u,disabled:a}),e.jsx("div",{className:"muted",children:"Select a PDF to convert to a simple .docx (text-only)."}),v&&e.jsx("div",{className:"drop-overlay",style:{position:"absolute",top:0,left:0,right:0,bottom:0,background:"rgba(59,130,246,0.1)",color:"#2563eb",fontSize:32,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:16},children:"✓ Uploaded"})]}),s&&e.jsxs("div",{style:{marginBottom:8,background:"#f9fafb",borderRadius:8,padding:8,boxShadow:"0 1px 4px #0001"},children:[e.jsx("div",{style:{fontWeight:500,color:"#3b82f6",wordBreak:"break-all"},children:s.name}),e.jsxs("div",{style:{color:"#888",fontSize:13},children:[(s.size/1024).toFixed(1)," KB • ",s.lastModified?new Date(s.lastModified).toLocaleString():""]})]}),s&&e.jsx(ce,{value:j,onChange:o=>k(o.target.value),disabled:a,placeholder:"output"}),e.jsxs("div",{style:{marginTop:12,display:"flex",gap:8,flexWrap:"wrap"},children:[e.jsx("button",{className:"btn-primary",onClick:i,disabled:a||!s,children:a?"Working...":"Convert to DOCX"}),e.jsx("button",{className:"btn-ghost",style:{color:"#dc2626",marginLeft:"auto"},onClick:()=>{y(null),T(""),N("")},disabled:a||!s,children:"Reset"})]})]})]})}try{X.GlobalWorkerOptions.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${X.version}/pdf.worker.min.js`}catch{}function He(){const[t,w]=n.useState(!1),[s,y]=n.useState([]),[a,E]=n.useState(!1),[d,S]=n.useState(""),[v,D]=n.useState(""),[W,T]=n.useState("merged"),x=Q.useRef(null),N=Q.useRef(null);Q.useEffect(()=>{d&&x.current&&x.current.focus()},[d]),Q.useEffect(()=>{v&&N.current&&N.current.focus()},[v]);async function j(r){S(""),D("");const o=Array.from(r.target.files),c=[];for(const b of o){if(!b.name.toLowerCase().endsWith(".pdf")){S("Semua file harus PDF.");continue}if(b.size>50*1024*1024){S("Ukuran file terlalu besar (maks 50MB).");continue}const R=await m(b);c.push({file:b,thumb:R})}y(b=>b.concat(c))}async function k(){if(s.length){S(""),D(""),E(!0);try{const r=await re.create();for(const C of s){const I=await C.file.arrayBuffer(),z=await re.load(I);(await r.copyPages(z,z.getPageIndices())).forEach(q=>r.addPage(q))}const o=await r.save(),c=new Blob([o],{type:"application/pdf"}),b=URL.createObjectURL(c),R=document.createElement("a");R.href=b,R.download=ie(W,"merged"),R.click(),URL.revokeObjectURL(b),D("Berhasil! File PDF berhasil digabung dan diunduh.")}catch(r){console.error(r),S("Gagal menggabungkan: "+(r.message||r))}finally{E(!1)}}}function l(r){y(o=>o.filter((c,b)=>b!==r))}function f(r){y(o=>{if(r<=0)return o;const c=o.slice(),b=c[r-1];return c[r-1]=c[r],c[r]=b,c})}function u(r){y(o=>{if(r>=o.length-1)return o;const c=o.slice(),b=c[r+1];return c[r+1]=c[r],c[r]=b,c})}function p(r,o){r.dataTransfer.setData("text/plain",String(o)),r.dataTransfer.effectAllowed="move"}function g(r){r.preventDefault(),r.dataTransfer.dropEffect="move"}function B(r,o){r.preventDefault();const c=Number(r.dataTransfer.getData("text/plain"));Number.isNaN(c)||y(b=>{const R=b.slice(),[C]=R.splice(c,1);return R.splice(o,0,C),R})}async function m(r){try{const o=await r.arrayBuffer(),b=await(await X.getDocument({data:o}).promise).getPage(1),R=b.getViewport({scale:1.5}),C=document.createElement("canvas");C.width=Math.ceil(R.width),C.height=Math.ceil(R.height);const L=C.getContext("2d");return await b.render({canvasContext:L,viewport:R}).promise,C.toDataURL("image/png")}catch{return null}}const i=async(r,o,c)=>{try{c(10);const b=await r.arrayBuffer();c(30);const R=await re.load(b);c(60);const C=await R.save();c(90);const L=new Blob([C],{type:"application/pdf"});return c(100),L}catch(b){throw console.error(`Error processing ${r.name}:`,b),b}};return e.jsxs("div",{style:{maxWidth:520,margin:"0 auto",padding:12},children:[e.jsx("h2",{style:{textAlign:"center",marginBottom:16},children:"Merge PDF"}),e.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:8,marginBottom:16},children:[e.jsx("button",{className:t?"btn-outline":"btn-primary",onClick:()=>w(!1),style:{minWidth:120},children:"📄 Merge Multiple"}),e.jsx("button",{className:t?"btn-primary":"btn-outline",onClick:()=>w(!0),style:{minWidth:120},children:"🔄 Batch Optimize"})]}),t&&e.jsx(ue,{toolName:"Optimize PDFs",processFile:i,acceptedTypes:".pdf",outputExtension:".pdf",maxFiles:100,customOptions:e.jsxs("div",{style:{padding:"12px 0"},children:[e.jsxs("div",{style:{fontSize:14,color:"#666",marginBottom:8},children:["💡 ",e.jsx("strong",{children:"Batch Optimize Mode:"})," Process multiple PDFs individually with optimization."]}),e.jsxs("div",{style:{fontSize:13,color:"#888"},children:["⚡ Each PDF is optimized and compressed",e.jsx("br",{}),"📦 Download individual files or all as ZIP",e.jsx("br",{}),"💾 Original files remain unchanged"]})]})}),!t&&e.jsxs("div",{children:[d&&e.jsx("div",{ref:x,tabIndex:-1,"aria-live":"assertive",style:{color:"#dc2626",marginBottom:8,background:"#fee2e2",padding:8,borderRadius:6,outline:"none"},children:d}),v&&e.jsx("div",{ref:N,tabIndex:-1,"aria-live":"polite",style:{color:"#059669",marginBottom:8,background:"#d1fae5",padding:8,borderRadius:6,outline:"none"},children:v}),a&&e.jsxs("div",{style:{marginBottom:8,display:"flex",alignItems:"center",gap:8},children:[e.jsx("span",{className:"loader",style:{display:"inline-block",width:24,height:24,border:"3px solid #3b82f6",borderTop:"3px solid #fff",borderRadius:"50%",animation:"spin 1s linear infinite",verticalAlign:"middle"}})," ",e.jsx("span",{children:"Memproses, mohon tunggu..."})]}),e.jsxs("div",{className:"dropzone",style:{opacity:a?.6:1,pointerEvents:a?"none":"auto",border:"2px dashed #3b82f6",borderRadius:16,padding:24,marginBottom:16,background:"#f8fafc"},children:[e.jsx("input",{type:"file",accept:"application/pdf",multiple:!0,onChange:j,disabled:a}),e.jsx("div",{className:"muted",children:"Pilih beberapa file PDF. Urutan file bisa diubah sebelum digabung."})]}),e.jsx("div",{className:"file-list",children:s.map((r,o)=>e.jsxs("div",{className:"file-item",draggable:!a,onDragStart:c=>!a&&p(c,o),onDragOver:g,onDrop:c=>!a&&B(c,o),style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:8,background:"#f9fafb",borderRadius:8,marginBottom:8,padding:8,opacity:a?.7:1},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,flex:1,minWidth:0},children:[e.jsx("div",{style:{width:56,height:40,flex:"none",background:"#f4f6fb",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:4},children:r.thumb?e.jsx("img",{src:r.thumb,style:{maxWidth:"100%",maxHeight:"100%"},alt:"thumb"}):e.jsx("div",{className:"muted",children:"PDF"})}),e.jsx("div",{style:{minWidth:120,maxWidth:180,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontWeight:500},children:r.file.name}),e.jsxs("div",{style:{color:"#888",fontSize:13},children:[(r.file.size/1024).toFixed(1)," KB"]}),e.jsx("div",{style:{color:"#888",fontSize:13},children:r.file.lastModified?new Date(r.file.lastModified).toLocaleDateString():""})]}),e.jsxs("div",{style:{display:"flex",gap:8},children:[e.jsx("button",{className:"btn",onClick:()=>f(o),disabled:o===0||a,children:"↑"}),e.jsx("button",{className:"btn",onClick:()=>u(o),disabled:o===s.length-1||a,children:"↓"}),e.jsx("button",{className:"btn",onClick:()=>l(o),disabled:a,children:"Remove"})]})]},o))}),s.length>0&&e.jsx(ce,{value:W,onChange:r=>T(r.target.value),disabled:a,placeholder:"merged"}),e.jsxs("div",{style:{marginTop:12,display:"flex",gap:8,flexWrap:"wrap"},children:[e.jsx("button",{className:"btn-primary",onClick:k,disabled:a||s.length===0,children:a?"Working...":"Merge & Download"}),e.jsx("button",{className:"btn-ghost",style:{color:"#dc2626",marginLeft:"auto"},onClick:()=>{y([]),S(""),D("")},disabled:a||s.length===0,children:"Reset"})]})]})]})}function Ve(){const[t,w]=n.useState(!1),[s,y]=n.useState(null),[a,E]=n.useState([]),[d,S]=n.useState([]),[v,D]=n.useState(!1),[W,T]=n.useState(""),[x,N]=n.useState(""),[j,k]=n.useState(""),l=Q.useRef(null),f=Q.useRef(null);Q.useEffect(()=>{W&&l.current&&l.current.focus()},[W]),Q.useEffect(()=>{x&&f.current&&f.current.focus()},[x]);async function u(i){T(""),N("");const r=i.target.files[0];if(!r)return;if(!r.name.toLowerCase().endsWith(".pdf")){T("File harus PDF.");return}if(r.size>50*1024*1024){T("Ukuran file terlalu besar (maks 50MB).");return}y(r),k(pe(r,"_extracted"));const o=await r.arrayBuffer(),c=await re.load(o);E(new Array(c.getPageCount()).fill(!1)),S(new Array(c.getPageCount()).fill(0))}function p(i){E(r=>r.map((o,c)=>c===i?!o:o))}function g(i){S(r=>r.map((o,c)=>c===i?(o+90)%360:o))}async function B(){if(s){T(""),N(""),D(!0);try{const i=await s.arrayBuffer(),r=await re.load(i),o=a.flatMap((z,A)=>z?[A]:[]);if(o.length===0){T("Pilih halaman yang ingin diekspor."),D(!1);return}const c=await re.create();(await c.copyPages(r,o)).forEach((z,A)=>{c.addPage(z);const q=o[A],_=d[q]||0;_&&z.setRotation(_)});const R=await c.save(),C=new Blob([R],{type:"application/pdf"}),L=URL.createObjectURL(C),I=document.createElement("a");I.href=L,I.download=ie(j,"extracted"),I.click(),URL.revokeObjectURL(L),N("Berhasil! Halaman berhasil diekspor dan diunduh.")}catch(i){console.error(i),T("Gagal: "+(i.message||i))}finally{D(!1)}}}const m=async(i,r,o)=>{try{o(10);const c=await i.arrayBuffer(),b=await re.load(c);o(30);const R=await re.create(),[C]=await R.copyPages(b,[0]);R.addPage(C),o(70);const L=await R.save();o(90);const I=new Blob([L],{type:"application/pdf"});return o(100),I}catch(c){throw console.error(`Error splitting ${i.name}:`,c),c}};return e.jsxs("div",{style:{maxWidth:520,margin:"0 auto",padding:12},children:[e.jsx("h2",{style:{textAlign:"center",marginBottom:16},children:"Split / Extract Pages"}),e.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:8,marginBottom:16},children:[e.jsx("button",{className:t?"btn-outline":"btn-primary",onClick:()=>w(!1),style:{minWidth:120},children:"📄 Single PDF"}),e.jsx("button",{className:t?"btn-primary":"btn-outline",onClick:()=>w(!0),style:{minWidth:120},children:"🔄 Batch Split"})]}),t&&e.jsx(ue,{toolName:"Split PDFs",processFile:m,acceptedTypes:".pdf",outputExtension:".pdf",maxFiles:100,customOptions:e.jsxs("div",{style:{padding:"12px 0"},children:[e.jsxs("div",{style:{fontSize:14,color:"#666",marginBottom:8},children:["💡 ",e.jsx("strong",{children:"Batch Split Mode:"})," Extract first page from multiple PDFs at once."]}),e.jsxs("div",{style:{fontSize:13,color:"#888"},children:["📄 Each PDF's first page is extracted",e.jsx("br",{}),"📦 Download individual files or all as ZIP",e.jsx("br",{}),"⚡ Process up to 100 PDFs simultaneously"]})]})}),!t&&e.jsxs("div",{children:[W&&e.jsx("div",{ref:l,tabIndex:-1,"aria-live":"assertive",style:{color:"#dc2626",marginBottom:8,background:"#fee2e2",padding:8,borderRadius:6,outline:"none"},children:W}),x&&e.jsx("div",{ref:f,tabIndex:-1,"aria-live":"polite",style:{color:"#059669",marginBottom:8,background:"#d1fae5",padding:8,borderRadius:6,outline:"none"},children:x}),v&&e.jsxs("div",{style:{marginBottom:8,display:"flex",alignItems:"center",gap:8},children:[e.jsx("span",{className:"loader",style:{display:"inline-block",width:24,height:24,border:"3px solid #3b82f6",borderTop:"3px solid #fff",borderRadius:"50%",animation:"spin 1s linear infinite",verticalAlign:"middle"}})," ",e.jsx("span",{children:"Memproses, mohon tunggu..."})]}),e.jsxs("div",{className:"dropzone",style:{opacity:v?.6:1,pointerEvents:v?"none":"auto",border:"2px dashed #3b82f6",borderRadius:16,padding:24,marginBottom:16,background:"#f8fafc"},children:[e.jsx("input",{type:"file",accept:"application/pdf",onChange:u,disabled:v}),e.jsx("div",{className:"muted",children:"Load a PDF then select pages to export."})]}),s&&e.jsxs("div",{style:{marginBottom:8,background:"#f9fafb",borderRadius:8,padding:8,boxShadow:"0 1px 4px #0001"},children:[e.jsx("div",{style:{fontWeight:500,color:"#3b82f6",wordBreak:"break-all"},children:s.name}),e.jsxs("div",{style:{color:"#888",fontSize:13},children:[(s.size/1024).toFixed(1)," KB • ",s.lastModified?new Date(s.lastModified).toLocaleString():""]})]}),e.jsx("div",{style:{marginTop:12},children:a.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"muted",children:"Click pages to toggle selection. Use rotate to change orientation."}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(120px,1fr))",gap:8,marginTop:8},children:a.map((i,r)=>e.jsx("div",{className:"file-item",style:{cursor:v?"not-allowed":"pointer",background:i?"#eef2ff":"",opacity:v?.7:1},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%"},children:[e.jsxs("div",{onClick:()=>!v&&p(r),style:{flex:1},children:["Page ",r+1," ",d[r]?`• ${d[r]}°`:""]}),e.jsx("div",{style:{display:"flex",gap:6},children:e.jsx("button",{className:"btn",onClick:()=>g(r),disabled:v,children:"Rotate"})})]})},r))}),s&&e.jsx(ce,{value:j,onChange:i=>k(i.target.value),disabled:v,placeholder:"extracted"}),e.jsxs("div",{style:{marginTop:12,display:"flex",gap:8,flexWrap:"wrap"},children:[e.jsx("button",{className:"btn-primary",onClick:B,disabled:v,children:v?"Working...":"Export Selected"}),e.jsx("button",{className:"btn-ghost",style:{color:"#dc2626",marginLeft:"auto"},onClick:()=>{y(null),E([]),S([]),k(""),T(""),N("")},disabled:v,children:"Reset"})]})]})})]})]})}function qe(){const[t,w]=n.useState([]),[s,y]=n.useState(!1),[a,E]=n.useState("fit"),[d,S]=n.useState(""),[v,D]=n.useState(""),W=Q.useRef(null),T=Q.useRef(null);Q.useEffect(()=>{d&&W.current&&W.current.focus()},[d]),Q.useEffect(()=>{v&&T.current&&T.current.focus()},[v]);async function x(p){S(""),D("");const g=Array.from(p.target.files),B=[];for(const m of g){if(!m.type.startsWith("image/")){S("Semua file harus gambar.");continue}if(m.size>20*1024*1024){S("Ukuran gambar terlalu besar (maks 20MB).");continue}try{const i=await f(m);B.push({file:m,dataUrl:i.dataUrl,thumb:i.dataUrl,width:i.width,height:i.height})}catch(i){console.warn("failed to load image",m,i)}}B.length&&w(m=>m.concat(B))}function N(p){w(g=>g.filter((B,m)=>m!==p))}function j(p,g){p.dataTransfer.setData("text/plain",String(g)),p.dataTransfer.effectAllowed="move"}function k(p){p.preventDefault(),p.dataTransfer.dropEffect="move"}function l(p,g){p.preventDefault();const B=Number(p.dataTransfer.getData("text/plain"));Number.isNaN(B)||w(m=>{const i=m.slice(),[r]=i.splice(B,1);return i.splice(g,0,r),i})}function f(p){return new Promise((g,B)=>{const m=new FileReader;m.onload=()=>{const i=new Image;i.onload=()=>g({dataUrl:m.result,width:i.naturalWidth,height:i.naturalHeight}),i.onerror=B,i.src=m.result},m.onerror=B,m.readAsDataURL(p)})}async function u(){if(t.length!==0){y(!0);try{const{jsPDF:p}=await de(async()=>{const{jsPDF:o}=await import("./vendor_jspdf-DlgZQKHI.js").then(c=>c.j);return{jsPDF:o}},__vite__mapDeps([2,1,0])),g="mm",B=25.4/96,m=210,i=297,r=new p({unit:g,format:[m,i]});for(let o=0;o<t.length;o++){const c=t[o],b=c.dataUrl||c.thumb,R=c.width,C=c.height;if(!b){console.warn("skip image with no dataUrl/thumb",c);continue}const L=m,I=i;o>0&&r.addPage();const z=10,A=L-z*2,q=I-z*2,_=R*B,F=C*B;let h,P,M,U;if(a==="fit"){const H=Math.min(A/_,q/F,1);h=_*H,P=F*H,M=(L-h)/2,U=(I-P)/2}else if(a==="fill"){const H=Math.max(A/_,q/F);h=_*H,P=F*H,M=(L-h)/2,U=(I-P)/2}else h=Math.min(_,A),P=Math.min(F,q),M=(L-h)/2,U=(I-P)/2;const $=typeof b=="string"&&b.indexOf("image/png")>=0?"PNG":"JPEG";try{r.addImage(b,$,M,U,h,P)}catch(H){console.error("addImage failed for entry",o,H)}}r.save("images.pdf"),D("PDF berhasil dibuat dan diunduh!")}catch(p){console.error(p),S("Gagal membuat PDF: "+(p.message||p))}finally{y(!1)}}}return e.jsxs("div",{style:{maxWidth:520,margin:"0 auto",padding:12},children:[e.jsx("h2",{style:{textAlign:"center",marginBottom:16},children:"Images → PDF"}),d&&e.jsx("div",{ref:W,tabIndex:-1,"aria-live":"assertive",style:{color:"#dc2626",marginBottom:8,background:"#fee2e2",padding:8,borderRadius:6,outline:"none"},children:d}),v&&e.jsx("div",{ref:T,tabIndex:-1,"aria-live":"polite",style:{color:"#059669",marginBottom:8,background:"#d1fae5",padding:8,borderRadius:6,outline:"none"},children:v}),s&&e.jsxs("div",{style:{marginBottom:8,display:"flex",alignItems:"center",gap:8},children:[e.jsx("span",{className:"loader",style:{display:"inline-block",width:24,height:24,border:"3b82f6",borderTop:"3px solid #fff",borderRadius:"50%",animation:"spin 1s linear infinite",verticalAlign:"middle"}})," ",e.jsx("span",{children:"Memproses, mohon tunggu..."})]}),e.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:8},children:[e.jsx("label",{style:{display:"flex",alignItems:"center",gap:6},children:"Mode:"}),e.jsxs("select",{value:a,onChange:p=>E(p.target.value),disabled:s,children:[e.jsx("option",{value:"fit",children:"Fit (contain)"}),e.jsx("option",{value:"fill",children:"Fill (cover)"}),e.jsx("option",{value:"actual",children:"Actual size (max page)"})]})]}),e.jsxs("div",{className:"dropzone",style:{opacity:s?.6:1,pointerEvents:s?"none":"auto",border:"2px dashed #3b82f6",borderRadius:16,padding:24,marginBottom:16,background:"#f8fafc"},children:[e.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:x,disabled:s}),e.jsx("div",{className:"muted",children:"Select images in the order you want them to appear."})]}),e.jsx("div",{className:"file-list",children:t.map((p,g)=>e.jsxs("div",{className:"file-item",draggable:!s,onDragStart:B=>!s&&j(B,g),onDragOver:k,onDrop:B=>!s&&l(B,g),style:{display:"flex",alignItems:"center",gap:8,background:"#f9fafb",borderRadius:8,marginBottom:8,padding:8,opacity:s?.7:1},children:[e.jsx("img",{src:p.thumb,style:{width:80,height:60,objectFit:"cover",borderRadius:4},alt:"thumb"}),e.jsx("div",{style:{minWidth:120,maxWidth:180,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontWeight:500},children:p.file.name}),e.jsxs("div",{style:{color:"#888",fontSize:13},children:[(p.file.size/1024).toFixed(1)," KB"]}),e.jsx("button",{className:"btn",onClick:()=>N(g),disabled:s,children:"Remove"})]},g))}),e.jsxs("div",{style:{marginTop:12,display:"flex",gap:8,flexWrap:"wrap"},children:[e.jsx("button",{className:"btn-primary",onClick:u,disabled:s||t.length===0,children:s?"Working...":"Create PDF"}),e.jsx("button",{className:"btn-ghost",style:{color:"#dc2626",marginLeft:"auto"},onClick:()=>{w([]),S(""),D("")},disabled:s||t.length===0,children:"Reset"})]})]})}try{X.GlobalWorkerOptions.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${X.version}/pdf.worker.min.js`}catch(t){console.warn("pdfjs worker not set",t)}function Ze(){const[t,w]=n.useState(!1),[s,y]=n.useState(null),[a,E]=n.useState([]),[d,S]=n.useState(!1),[v,D]=n.useState(""),[W,T]=n.useState(""),[x,N]=n.useState("png"),[j,k]=n.useState(.92),[l,f]=n.useState("");async function u(i){const r=i.target.files[0];if(r){if(D(""),T(""),!r.type.includes("pdf")){D("Please select a PDF file.");return}if(r.size>50*1024*1024){D("File too large (max 50MB).");return}try{y(r),f(pe(r));const o=await r.arrayBuffer(),c=await X.getDocument({data:o}).promise;E(new Array(c.numPages).fill(!1)),T(`Loaded ${c.numPages} pages. Select pages to export.`)}catch(o){console.error(o),D("Failed to load PDF: "+o.message),y(null),E([])}}}function p(i){E(r=>r.map((o,c)=>c===i?!o:o))}async function g(){if(!s)return;const i=a.flatMap((r,o)=>r?[o+1]:[]);if(i.length===0){D("Please select at least one page to export.");return}D(""),T(""),S(!0);try{const r=await s.arrayBuffer(),o=await X.getDocument({data:r}).promise,c=[];for(const R of i){const C=await o.getPage(R),L=C.getViewport({scale:2}),I=document.createElement("canvas");I.width=Math.ceil(L.width),I.height=Math.ceil(L.height);const z=I.getContext("2d");await C.render({canvasContext:z,viewport:L}).promise;const A=x==="png"?"image/png":x==="webp"?"image/webp":"image/jpeg",q=await new Promise(_=>x==="png"?I.toBlob(_,"image/png"):I.toBlob(_,A,j));c.push({pnum:R,blob:q})}const b=x==="png"?".png":x==="webp"?".webp":".jpg";if(i.length===1){const R=c[0].blob,C=URL.createObjectURL(R),L=document.createElement("a");L.href=C,L.download=ie(l,s.name.replace(/\.pdf$/i,"")+`_page_${c[0].pnum}`,b),L.click(),URL.revokeObjectURL(C),T(`Exported 1 page as ${x.toUpperCase()}!`)}else{const R=new ve;for(const z of c){const A=await z.blob.arrayBuffer();R.file(`${s.name.replace(/\.pdf$/i,"")}_page_${z.pnum}${b}`,A)}const C=await R.generateAsync({type:"blob"}),L=URL.createObjectURL(C),I=document.createElement("a");I.href=L,I.download=ie(l,s.name.replace(/\.pdf$/i,"")+"_pages",".zip"),I.click(),URL.revokeObjectURL(L),T(`Exported ${i.length} pages as ${x.toUpperCase()} in ZIP!`)}}catch(r){console.error(r),D("Export failed: "+r.message)}finally{S(!1)}}async function B(i,r){try{r(10);const o=await i.arrayBuffer();r(20);const c=await X.getDocument({data:o}).promise,b=c.numPages;r(30);const R=new ve,C=x==="png"?".png":x==="webp"?".webp":".jpg";for(let I=1;I<=b;I++){const z=await c.getPage(I),A=z.getViewport({scale:2}),q=document.createElement("canvas");q.width=Math.ceil(A.width),q.height=Math.ceil(A.height);const _=q.getContext("2d");await z.render({canvasContext:_,viewport:A}).promise;const F=x==="png"?"image/png":x==="webp"?"image/webp":"image/jpeg",P=await(await new Promise(M=>x==="png"?q.toBlob(M,"image/png"):q.toBlob(M,F,j))).arrayBuffer();R.file(`page_${I}${C}`,P),r(30+I/b*60)}r(90);const L=await R.generateAsync({type:"blob"});return r(100),L}catch(o){throw new Error(`Failed to convert PDF to images: ${o.message||o}`)}}function m(){y(null),E([]),D(""),T(""),w(!1)}return e.jsxs("div",{children:[e.jsx("h2",{children:"PDF → Images"}),e.jsx("p",{className:"muted",children:"Convert PDF pages to image files (PNG, JPEG, or WEBP)."}),e.jsxs("div",{style:{display:"flex",gap:8,marginBottom:16,borderBottom:"2px solid var(--border)",paddingBottom:8},children:[e.jsx("button",{onClick:()=>w(!1),disabled:d,style:{padding:"8px 16px",backgroundColor:t?"transparent":"var(--primary)",color:t?"var(--text)":"white",border:t?"1px solid var(--border)":"none",borderRadius:4,cursor:"pointer",fontWeight:t?"normal":"bold"},children:"📄 Single File"}),e.jsx("button",{onClick:()=>w(!0),disabled:d,style:{padding:"8px 16px",backgroundColor:t?"var(--primary)":"transparent",color:t?"white":"var(--text)",border:t?"none":"1px solid var(--border)",borderRadius:4,cursor:"pointer",fontWeight:t?"bold":"normal"},children:"📚 Batch Process"})]}),v&&e.jsxs("div",{className:"error-message",role:"alert",children:["⚠️ ",v]}),W&&e.jsxs("div",{className:"success-message",role:"status",children:["✅ ",W]}),t?e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:16},children:[e.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:6,maxWidth:300},children:[e.jsx("strong",{children:"Output Format:"}),e.jsxs("select",{value:x,onChange:i=>N(i.target.value),disabled:d,className:"select",children:[e.jsx("option",{value:"png",children:"PNG (Lossless, larger file)"}),e.jsx("option",{value:"jpeg",children:"JPEG (Compressed, smaller file)"}),e.jsx("option",{value:"webp",children:"WEBP (Modern, best quality/size)"})]})]}),x!=="png"&&e.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:6,marginTop:12,maxWidth:300},children:[e.jsxs("strong",{children:["Quality: ",Math.round(j*100),"%"]}),e.jsx("input",{type:"range",min:"0.5",max:"1",step:"0.05",value:j,onChange:i=>k(Number(i.target.value)),disabled:d})]})]}),e.jsxs("div",{style:{marginBottom:16,padding:12,background:"var(--paper)",border:"1px solid var(--border)",borderRadius:4},children:[e.jsx("strong",{children:"Batch Mode Settings:"}),e.jsxs("ul",{style:{marginTop:8,marginBottom:0,paddingLeft:20},children:[e.jsxs("li",{children:["Format: ",x.toUpperCase()]}),x!=="png"&&e.jsxs("li",{children:["Quality: ",Math.round(j*100),"%"]}),e.jsx("li",{children:"All pages from each PDF will be converted"}),e.jsx("li",{children:"Each PDF's images will be saved as a separate ZIP file"})]})]}),e.jsx(ue,{processFile:B,outputFilenameSuffix:`_${x}_images`,acceptedFileTypes:"application/pdf",description:"Convert multiple PDFs to images",outputFileExtension:".zip"})]}):e.jsxs("div",{children:[e.jsxs("div",{className:"dropzone",children:[e.jsx("input",{type:"file",accept:"application/pdf",onChange:u,disabled:d}),e.jsx("div",{className:"muted",children:"Select a PDF, then choose pages and format to export."})]}),s&&e.jsxs("div",{className:"file-info",children:[e.jsx("strong",{children:"📄 File:"})," ",s.name," (",(s.size/1024).toFixed(1)," KB)"]}),a.length>0&&e.jsxs("div",{style:{marginTop:16},children:[e.jsxs("div",{style:{marginBottom:12},children:[e.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:6,maxWidth:300},children:[e.jsx("strong",{children:"Output Format:"}),e.jsxs("select",{value:x,onChange:i=>N(i.target.value),disabled:d,className:"select",children:[e.jsx("option",{value:"png",children:"PNG (Lossless, larger file)"}),e.jsx("option",{value:"jpeg",children:"JPEG (Compressed, smaller file)"}),e.jsx("option",{value:"webp",children:"WEBP (Modern, best quality/size)"})]})]}),x!=="png"&&e.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:6,marginTop:12,maxWidth:300},children:[e.jsxs("strong",{children:["Quality: ",Math.round(j*100),"%"]}),e.jsx("input",{type:"range",min:"0.5",max:"1",step:"0.05",value:j,onChange:i=>k(Number(i.target.value)),disabled:d})]})]}),e.jsxs("div",{className:"muted",style:{marginBottom:8},children:["Click pages to select. Selected: ",a.filter(i=>i).length," / ",a.length]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(90px,1fr))",gap:8,marginBottom:16},children:a.map((i,r)=>e.jsxs("div",{className:"file-item",onClick:()=>p(r),style:{cursor:"pointer",background:i?"#eef2ff":"",border:i?"2px solid #4f46e5":"1px solid var(--border)",fontWeight:i?"600":"400"},children:["📄 ",r+1]},r))}),s&&e.jsx(ce,{value:l,onChange:i=>f(i.target.value),disabled:d,placeholder:"output"}),e.jsxs("div",{style:{display:"flex",gap:12},children:[e.jsx("button",{className:"btn-primary",onClick:g,disabled:d||a.filter(i=>i).length===0,children:d?"⏳ Rendering...":`📥 Export as ${x.toUpperCase()}`}),e.jsx("button",{className:"btn-ghost",style:{color:"#dc2626"},onClick:m,disabled:d,children:"Reset"})]})]})]})]})}try{X.GlobalWorkerOptions.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${X.version}/pdf.worker.min.js`}catch{}function Ke(){const[t,w]=n.useState(null),[s,y]=n.useState(null),a=n.useRef(),[E,d]=n.useState(!1),[S,v]=n.useState(""),[D,W]=n.useState(""),[T,x]=n.useState(!1),[N,j]=n.useState("");async function k(m){const i=m.target.files[0];if(i){if(v(""),W(""),!i.type.includes("pdf")){v("Please select a PDF file.");return}try{x(!0),w(i),j(pe(i,"_annotated"));const r=await i.arrayBuffer(),c=await(await X.getDocument({data:r}).promise).getPage(1),b=c.getViewport({scale:1.5}),R=document.createElement("canvas");R.width=Math.ceil(b.width),R.height=Math.ceil(b.height);const C=R.getContext("2d");await c.render({canvasContext:C,viewport:b}).promise,y(R.toDataURL("image/png")),W("PDF loaded! Draw on the canvas to annotate.")}catch(r){console.error(r),v("Failed to load PDF: "+r.message),w(null),y(null)}finally{x(!1)}}}n.useEffect(()=>{const m=a.current;if(!m||!s)return;const i=m.getContext("2d"),r=new Image;r.onload=()=>{m.width=r.width,m.height=r.height,i.drawImage(r,0,0)},r.src=s},[s]);function l(m){d(!0),u(m)}function f(){d(!1)}function u(m){if(!E)return;const i=a.current,r=i.getBoundingClientRect(),o=m.clientX-r.left,c=m.clientY-r.top,b=i.getContext("2d");b.fillStyle="rgba(255,0,0,0.6)",b.beginPath(),b.arc(o,c,6,0,Math.PI*2),b.fill()}function p(){if(!a.current||!s)return;const i=a.current.getContext("2d"),r=new Image;r.onload=()=>i.drawImage(r,0,0),r.src=s,W("Canvas cleared!")}async function g(){if(!(!t||!a.current)){v(""),x(!0);try{const m=await new Promise(I=>a.current.toBlob(I,"image/png")),i=await re.create(),r=await m.arrayBuffer(),o=await i.embedPng(r);i.addPage([o.width,o.height]).drawImage(o,{x:0,y:0,width:o.width,height:o.height});const b=await i.save(),R=new Blob([b],{type:"application/pdf"}),C=URL.createObjectURL(R),L=document.createElement("a");L.href=C,L.download=ie(N,t.name.replace(/\.pdf$/i,"")+"_annotated"),L.click(),URL.revokeObjectURL(C),W("Annotated PDF exported successfully!")}catch(m){console.error(m),v("Export failed: "+m.message)}finally{x(!1)}}}function B(){w(null),y(null),v(""),W("")}return e.jsxs("div",{children:[e.jsx("h2",{children:"Annotate PDF"}),e.jsx("p",{className:"muted",children:"Draw annotations on the first page of your PDF."}),S&&e.jsxs("div",{className:"error-message",role:"alert",children:["⚠️ ",S]}),D&&e.jsxs("div",{className:"success-message",role:"status",children:["✅ ",D]}),e.jsxs("div",{className:"dropzone",children:[e.jsx("input",{type:"file",accept:"application/pdf",onChange:k,disabled:T}),e.jsx("div",{className:"muted",children:"Load a PDF (first page shown). Click and drag to draw annotations."})]}),t&&!s&&T&&e.jsx("div",{style:{marginTop:12},children:"⏳ Loading PDF..."}),s&&e.jsxs("div",{style:{marginTop:12},children:[e.jsx("div",{style:{border:"2px solid var(--border)",borderRadius:8,overflow:"hidden"},children:e.jsx("canvas",{ref:a,onMouseDown:l,onMouseUp:f,onMouseMove:u,style:{display:"block",width:"100%",cursor:"crosshair"}})}),t&&e.jsx(ce,{value:N,onChange:m=>j(m.target.value),disabled:T,placeholder:"output_annotated"}),e.jsxs("div",{style:{marginTop:12,display:"flex",gap:12},children:[e.jsx("button",{className:"btn-primary",onClick:g,disabled:T,children:T?"⏳ Exporting...":"📥 Export Annotated PDF"}),e.jsx("button",{className:"btn-ghost",onClick:p,disabled:T,children:"🧹 Clear Drawings"}),e.jsx("button",{className:"btn-ghost",style:{color:"#dc2626"},onClick:B,disabled:T,children:"Reset"})]})]})]})}try{X.GlobalWorkerOptions.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${X.version}/pdf.worker.min.js`}catch(t){console.warn("pdfjs worker not set",t)}function Xe(){const[t,w]=n.useState(!1),[s,y]=n.useState(null),[a,E]=n.useState(0),[d,S]=n.useState(!1),[v,D]=n.useState(!1),[W,T]=n.useState(!1),[x,N]=n.useState(.9),[j,k]=n.useState(1),[l,f]=n.useState("jpeg");n.useEffect(()=>{document.createElement("canvas").toDataURL("image/webp").indexOf("data:image/webp")===0&&f("webp")},[]);const[u,p]=n.useState(null),[g,B]=n.useState(null),[m,i]=n.useState(null),[r,o]=n.useState(!1),[c,b]=n.useState(""),[R,C]=n.useState(""),[L,I]=n.useState(""),[z,A]=n.useState("idle"),[q,_]=n.useState(""),F=n.useRef(null),h=n.useRef(null);n.useEffect(()=>{R&&F.current&&F.current.focus()},[R]),n.useEffect(()=>{L&&h.current&&h.current.focus()},[L]);const P=n.useRef(0),M=n.useRef(null);async function U(O){var K;C(""),I("");const G=(K=O.target.files)==null?void 0:K[0];if(G){if(!G.name.toLowerCase().endsWith(".pdf")){C("File harus PDF.");return}if(G.size>50*1024*1024){C("Ukuran file terlalu besar (maks 50MB).");return}y(G),B(G.size),i(null),b(""),p(null),_(pe(G,"_compressed"));try{const Z=await G.arrayBuffer(),J=await X.getDocument({data:Z.slice(0)}).promise;E(J.numPages)}catch(Z){console.error(Z),C("Unable to read PDF: "+(Z.message||Z))}}}function $(O){O.preventDefault(),d||D(!0)}function H(O){O.preventDefault(),d||(O.dataTransfer.dropEffect="copy")}function V(O){O.preventDefault(),d||D(!1)}async function ee(O){var K,Z;if(O.preventDefault(),d)return;D(!1);const G=(Z=(K=O.dataTransfer)==null?void 0:K.files)==null?void 0:Z[0];if(G){y(G),B(G.size),i(null),b(""),p(null);const J=await G.arrayBuffer(),te=await X.getDocument({data:J.slice(0)}).promise;E(te.numPages),T(!0),setTimeout(()=>T(!1),1500)}}async function ae({download:O=!0}={download:!0}){if(C(""),I(""),!s){C("Select a PDF to compress");return}S(!0),A("checking");try{const G=await fetch("https://dexpdfbackend-production.up.railway.app/",{method:"GET"});A("online")}catch{A("sleeping")}try{const G=new FormData;G.append("pdf",s);const K=await fetch("https://dexpdfbackend-production.up.railway.app/compress",{method:"POST",body:G});if(!K.ok)throw new Error("Compression failed");const Z=await K.blob(),J=window.URL.createObjectURL(Z),te=document.createElement("a");te.href=J,te.download=ie(q,"compressed"),document.body.appendChild(te),te.click(),te.remove(),window.URL.revokeObjectURL(J),I("Berhasil! File terdownload.")}catch(G){console.error(G),C("Compression failed: "+(G.message||G))}finally{S(!1),A("idle")}}async function ne(){if(!s)return alert("Select a PDF first");o(!0),i(null),b("Preparing...");try{const O=await s.arrayBuffer(),G=await X.getDocument({data:O.slice(0)}).promise,K=G.numPages;E(K),b("Rendering sample page...");const Z=await G.getPage(1),J=Z.getViewport({scale:j}),te=document.createElement("canvas");te.width=Math.ceil(J.width),te.height=Math.ceil(J.height);const me=te.getContext("2d");await Z.render({canvasContext:me,viewport:J}).promise;const fe=await new Promise(ye=>te.toBlob(ye,l==="webp"?"image/webp":"image/jpeg",Number(x))),xe=fe?fe.size:0,be=Math.max(0,Math.round(xe*K+2e3));i(be),b("Estimated using sample page at current settings"),te.width=0,te.height=0}catch(O){console.error(O),alert("Estimate failed: "+(O.message||O))}finally{o(!1)}}async function Y(O,G){const K=await s.arrayBuffer(),Z=await X.getDocument({data:K.slice(0)}).promise,J=Z.numPages,te=await Z.getPage(1),me=te.getViewport({scale:G}),fe=document.createElement("canvas");fe.width=Math.ceil(me.width),fe.height=Math.ceil(me.height);const xe=fe.getContext("2d");await te.render({canvasContext:xe,viewport:me}).promise;const he=await new Promise(Se=>fe.toBlob(Se,l==="webp"?"image/webp":"image/jpeg",Number(O))),be=he?he.size:0,ye=2e3;return fe.width=0,fe.height=0,Math.max(0,Math.round(be*J+ye))}async function le(){if(!s)return alert("Select a PDF first");o(!0),b("Estimating range...");try{const O=await s.arrayBuffer(),K=(await X.getDocument({data:O.slice(0)}).promise).numPages;E(K);const Z=.1,J=.5,te=1,me=1,fe=Number(x),xe=Number(j);b("Rendering low-quality sample...");const he=++P.current,be=await Y(Z,J);if(he!==P.current)throw new Error("Cancelled");b("Rendering current settings sample...");const ye=await Y(fe,xe);if(he!==P.current)throw new Error("Cancelled");b("Rendering high-quality sample...");const Se=await Y(te,me);if(he!==P.current)throw new Error("Cancelled");i({low:be,cur:ye,high:Se}),b("Range estimated using first-page extrapolation")}catch(O){console.error(O),alert("Range estimate failed: "+(O.message||O))}finally{o(!1)}}n.useEffect(()=>{if(s)return M.current&&clearTimeout(M.current),M.current=setTimeout(()=>{(P.current++)(async()=>{try{o(!0),b("Estimating...");const O=await Y(Number(x),Number(j));if(P.current===0)return;i({cur:O}),b("Live estimate updated")}catch(O){O.message!=="Cancelled"&&console.error(O)}finally{o(!1)}})()},350),()=>{M.current&&clearTimeout(M.current)}},[s,x,j]);function oe(O){return O==null?"-":O<1024?O+" B":O<1024*1024?(O/1024).toFixed(1)+" KB":(O/(1024*1024)).toFixed(2)+" MB"}const se=async(O,G,K)=>{try{K(10);const Z=new FormData;Z.append("pdf",O),K(30);const J=await fetch("https://dexpdfbackend-production.up.railway.app/compress",{method:"POST",body:Z});if(K(70),!J.ok)throw new Error(`Compression failed: ${J.statusText}`);const te=await J.blob();return K(100),te}catch(Z){throw console.error(`Error compressing file ${O.name}:`,Z),Z}};return e.jsxs("div",{style:{maxWidth:520,margin:"0 auto",padding:12},children:[e.jsx("h2",{style:{textAlign:"center",marginBottom:16},children:"Compress PDF"}),e.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:8,marginBottom:16},children:[e.jsx("button",{className:t?"btn-outline":"btn-primary",onClick:()=>w(!1),style:{minWidth:120},children:"📄 Single File"}),e.jsx("button",{className:t?"btn-primary":"btn-outline",onClick:()=>w(!0),style:{minWidth:120},children:"🔄 Batch Mode"})]}),t&&e.jsx(ue,{toolName:"Compress PDF",processFile:se,acceptedTypes:".pdf",outputExtension:".pdf",maxFiles:100,customOptions:e.jsxs("div",{style:{padding:"12px 0"},children:[e.jsxs("div",{style:{fontSize:14,color:"#666",marginBottom:8},children:["💡 ",e.jsx("strong",{children:"Batch Tips:"})," Backend compression optimizes automatically for best quality/size ratio."]}),e.jsxs("div",{style:{fontSize:13,color:"#888"},children:["⚡ Processing speed: ~2-5 seconds per PDF",e.jsx("br",{}),"🎯 Quality: High (automatic optimization)",e.jsx("br",{}),"📦 Download: Individual files or all as ZIP"]})]})}),!t&&e.jsxs("div",{children:[R&&e.jsx("div",{ref:F,tabIndex:-1,"aria-live":"assertive",style:{color:"#dc2626",marginBottom:8,background:"#fee2e2",padding:8,borderRadius:6,outline:"none"},children:R}),L&&e.jsx("div",{ref:h,tabIndex:-1,"aria-live":"polite",style:{color:"#059669",marginBottom:8,background:"#d1fae5",padding:8,borderRadius:6,outline:"none"},children:L}),z==="sleeping"&&e.jsx("div",{style:{color:"#b45309",marginBottom:8,background:"#fef3c7",padding:8,borderRadius:6},children:"Backend sedang bangun (sleeping), mohon tunggu beberapa detik lalu coba lagi."}),d&&e.jsxs("div",{style:{marginBottom:8,display:"flex",alignItems:"center",gap:8},children:[e.jsx("span",{className:"loader",style:{display:"inline-block",width:24,height:24,border:"3px solid #3b82f6",borderTop:"3px solid #fff",borderRadius:"50%",animation:"spin 1s linear infinite",verticalAlign:"middle"}})," ",e.jsx("span",{children:"Memproses, mohon tunggu..."})]}),e.jsxs("div",{className:`dropzone big-dropzone ${v?"dragover":""}`,onDragEnter:$,onDragOver:H,onDragLeave:V,onDrop:ee,style:{border:"2px dashed #3b82f6",borderRadius:16,padding:32,textAlign:"center",background:v?"#e0f2fe":"#f8fafc",position:"relative",marginBottom:16,transition:"background 0.2s",opacity:d?.6:1,pointerEvents:d?"none":"auto"},children:[e.jsx("input",{type:"file",accept:"application/pdf",onChange:U,style:{display:"none"},id:"pdf-upload-input",disabled:d}),e.jsxs("label",{htmlFor:"pdf-upload-input",style:{cursor:d?"not-allowed":"pointer",display:"block"},children:[e.jsx("div",{style:{fontSize:48,color:"#3b82f6",marginBottom:8},children:e.jsxs("svg",{width:"48",height:"48",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("path",{fill:"#3b82f6",d:"M12 16V4m0 0-4 4m4-4 4 4",stroke:"#3b82f6",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("rect",{x:"4",y:"16",width:"16",height:"4",rx:"2",fill:"#3b82f6",opacity:".15"})]})}),e.jsx("div",{style:{fontSize:20,fontWeight:600,color:"#222"},children:"Drop PDF here or click to upload"}),e.jsxs("div",{className:"muted",style:{marginTop:6,color:"#555"},children:["Kompres PDF: ",e.jsx("b",{children:"Ukuran kecil, kualitas tetap tinggi"}),".",e.jsx("br",{}),e.jsx("b",{children:"Tips:"})," Pilih kualitas tinggi untuk hasil tajam, atau turunkan untuk file lebih kecil.",e.jsx("br",{}),l==="webp"?"WebP mode aktif (hasil lebih kecil & tajam)":"JPEG mode (WebP tidak didukung browser)"]})]}),e.jsxs("div",{style:{marginTop:8,display:"flex",gap:8,justifyContent:"center",flexWrap:"wrap"},children:[e.jsx("button",{className:"btn-ghost",style:{minWidth:110},onClick:()=>{N(.95),k(1),C(""),I("")},disabled:d,children:"High Quality"}),e.jsx("button",{className:"btn-ghost",style:{minWidth:110},onClick:()=>{N(.8),k(.9),C(""),I("")},disabled:d,children:"Balanced"}),e.jsx("button",{className:"btn-ghost",style:{minWidth:110},onClick:()=>{N(.5),k(.7),C(""),I("")},disabled:d,children:"Smallest Size"})]}),W&&e.jsx("div",{className:"drop-overlay",style:{position:"absolute",top:0,left:0,right:0,bottom:0,background:"rgba(59,130,246,0.1)",color:"#2563eb",fontSize:32,display:"flex",alignItems:"center",justifyContent:"center",borderRadius:16},children:"✓ Uploaded"})]}),s&&e.jsxs("div",{style:{marginTop:12,background:"#f9fafb",borderRadius:12,padding:16,boxShadow:"0 1px 4px #0001"},children:[e.jsxs("div",{style:{fontSize:18,fontWeight:600,marginBottom:4,wordBreak:"break-all"},children:[e.jsx("span",{style:{color:"#3b82f6"},children:s.name})," — ",a," pages"]}),e.jsxs("div",{style:{display:"flex",gap:16,alignItems:"center",marginBottom:8,flexWrap:"wrap"},children:[e.jsx("span",{style:{color:"#888"},children:"Original:"})," ",e.jsx("span",{style:{fontWeight:500},children:oe(g)}),e.jsx("span",{style:{color:"#888"},children:"Type:"})," ",e.jsx("span",{style:{fontWeight:500},children:s.type||"application/pdf"}),e.jsx("span",{style:{color:"#888"},children:"Last modified:"})," ",e.jsx("span",{style:{fontWeight:500},children:s.lastModified?new Date(s.lastModified).toLocaleString():"-"}),m&&typeof m=="object"&&m.cur&&e.jsxs(e.Fragment,{children:[e.jsx("span",{style:{color:"#888"},children:"→ Compressed:"})," ",e.jsx("span",{style:{fontWeight:500,color:"#059669"},children:oe(m.cur)}),e.jsxs("span",{style:{color:"#888"},children:["(",g?Math.round(100-m.cur/g*100):0,"% smaller)"]})]})]}),m&&e.jsxs("div",{style:{marginTop:8,color:"#b45309",background:"#fef3c7",padding:8,borderRadius:6},children:["Estimasi ukuran hanya berlaku untuk mode compress di browser, bukan backend Railway.",e.jsx("br",{}),"Hasil compress backend biasanya lebih optimal."]}),c&&e.jsxs("div",{style:{marginTop:8,color:"#6b7280",width:"100%"},children:[e.jsx("div",{style:{height:8,background:"#e5e7eb",borderRadius:4,overflow:"hidden",marginBottom:4},children:r||d?e.jsx("div",{style:{width:"100%",height:"100%",background:"#3b82f6",animation:"progressBarAnim 1.2s linear infinite"}}):null}),e.jsx("span",{children:c})]}),e.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center",marginTop:8,flexWrap:"wrap"},children:[e.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:["JPEG Quality:",e.jsx("input",{type:"range",min:"0.1",max:"1",step:"0.05",value:x,onChange:O=>N(Number(O.target.value)),disabled:d}),e.jsxs("div",{style:{width:44,textAlign:"right"},children:[Math.round(x*100),"%"]})]}),e.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:["Render Scale:",e.jsxs("select",{value:j,onChange:O=>k(Number(O.target.value)),disabled:d,children:[e.jsx("option",{value:1,children:"100%"}),e.jsx("option",{value:.9,children:"90%"}),e.jsx("option",{value:.8,children:"80%"}),e.jsx("option",{value:.7,children:"70%"}),e.jsx("option",{value:.6,children:"60%"}),e.jsx("option",{value:.5,children:"50%"})]})]})]}),e.jsx(ce,{value:q,onChange:O=>_(O.target.value),disabled:d,placeholder:"compressed"}),e.jsxs("div",{style:{marginTop:12,display:"flex",gap:8,flexWrap:"wrap"},children:[e.jsx("button",{className:"btn-primary",onClick:()=>ae({download:!0}),disabled:d,children:d?"Compressing...":"Compress & Download"}),e.jsx("button",{className:"btn-outline",disabled:!0,title:"Preview hanya untuk mode browser",children:"Preview"}),e.jsx("button",{className:"btn-ghost",onClick:ne,disabled:r||d,children:r?"Estimating...":"Estimate size"}),e.jsx("button",{className:"btn-ghost",onClick:le,disabled:r||d,children:r?"Estimating...":"Estimate range (min/cur/max)"}),e.jsx("button",{className:"btn-ghost",style:{color:"#dc2626",marginLeft:"auto"},onClick:()=>{y(null),E(0),i(null),B(null),p(null),C(""),I("")},disabled:d,children:"Reset"})]}),u&&e.jsxs("div",{style:{marginTop:12},children:[e.jsx("div",{className:"muted",children:"Preview (close tab/window to dismiss):"}),e.jsx("iframe",{title:"compress-preview",src:u,style:{width:"100%",height:400,border:"1px solid #ddd"}})]})]})]})]})}function Pe(t){return new Promise((w,s)=>{if(typeof t=="string"){const y=We.parse(t.trim(),{header:!1});w(y.data)}else We.parse(t,{complete:y=>w(y.data),error:y=>s(y)})})}function Je(){const[t,w]=n.useState([]),[s,y]=n.useState(null),a=n.useRef(null),[E,d]=n.useState("table"),[S,v]=n.useState(!1);async function D(N){var k;y(null);const j=(k=N.target.files)==null?void 0:k[0];if(j)try{const l=await Pe(j);w(l)}catch{y("Failed to parse CSV")}}async function W(){try{const N=await navigator.clipboard.readText(),j=await Pe(N);w(j)}catch{y("Failed to parse pasted CSV")}}async function T(N){const j=await Pe(N),k=document.createElement("table"),l=document.createElement("tbody");j.forEach(u=>{const p=document.createElement("tr");u.forEach(g=>{const B=document.createElement("td");B.textContent=g,B.style.border="1px solid #ddd",B.style.padding="8px",p.appendChild(B)}),l.appendChild(p)}),k.appendChild(l),k.style.borderCollapse="collapse",k.style.width="100%";const f=document.createElement("div");f.style.position="absolute",f.style.left="-9999px",f.appendChild(k),document.body.appendChild(f);try{const p=(await ke(k,{scale:2})).toDataURL("image/png"),g=new Le("p","pt","a4"),B=g.getImageProperties(p),m=g.internal.pageSize.getWidth(),i=B.height*m/B.width;return g.addImage(p,"PNG",0,0,m,i),g.output("blob")}finally{document.body.removeChild(f)}}async function x(){if(!a.current)return;const N=a.current,k=(await ke(N,{scale:2})).toDataURL("image/png"),l=new Le("p","pt","a4"),f=l.getImageProperties(k),u=l.internal.pageSize.getWidth(),p=f.height*u/f.width;l.addImage(k,"PNG",0,0,u,p),l.save(ie(E,"table"))}return e.jsxs("div",{className:"tool-csv2pdf",children:[e.jsx("div",{style:{marginBottom:12},children:e.jsx("button",{onClick:()=>v(!S),style:{padding:"6px 12px",borderRadius:4,border:"1px solid #ccc",background:S?"#3b82f6":"#fff",color:S?"#fff":"#000",cursor:"pointer"},children:S?"Switch to Single Mode":"Switch to Batch Mode"})}),S?e.jsx(ue,{accept:".csv,text/csv",processFile:T,outputNameSuffix:"",taskName:"Convert CSV to PDF"}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"tool-controls",children:[e.jsxs("label",{className:"btn",children:["Upload CSV",e.jsx("input",{type:"file",accept:".csv,text/csv",onChange:D,style:{display:"none"}})]}),e.jsx("button",{className:"btn",onClick:W,children:"Paste CSV from clipboard"}),e.jsx("button",{className:"btn",onClick:()=>{w([]),y(null)},children:"Clear"})]}),s&&e.jsx("div",{className:"tool-error",children:s}),t&&t.length>0&&e.jsx(ce,{value:E,onChange:N=>d(N.target.value),disabled:!1,placeholder:"table"}),e.jsx("div",{style:{marginTop:12},children:e.jsx("button",{className:"btn primary",onClick:x,disabled:!t||t.length===0,children:"Export to PDF"})}),e.jsx("div",{className:"csv-preview",ref:a,children:e.jsx("table",{children:e.jsx("tbody",{children:t.map((N,j)=>e.jsx("tr",{children:N.map((k,l)=>e.jsx("td",{children:k},l))},j))})})})]})]})}function Ye(){const[t,w]=n.useState(null),[s,y]=n.useState("text"),[a,E]=n.useState("New text"),[d,S]=n.useState(!1),[v,D]=n.useState(null),[W,T]=n.useState(""),[x,N]=n.useState(!1);async function j(u){var g;const p=(g=u.target.files)==null?void 0:g[0];p&&(w(p),T(pe(p,"_edited")))}async function k(u){var g;const p=(g=u.target.files)==null?void 0:g[0];p&&D(p)}async function l(u){const p=await u.arrayBuffer(),g=await re.load(p),B=g.getPages(),m=await g.embedFont(je.Helvetica),i=B[0],{width:r,height:o}=i.getSize();if(s==="text")i.drawText(a,{x:40,y:o-80,size:14,font:m,color:ge(0,0,0)});else if(s==="image"&&v){const b=await v.arrayBuffer(),R=(v.type||"").toLowerCase();let C;R.includes("png")?C=await g.embedPng(b):C=await g.embedJpg(b),i.drawImage(C,{x:40,y:o-200,width:150,height:120})}else i.drawRectangle({x:40,y:o-240,width:200,height:100,color:ge(.9,.9,.9)});const c=await g.save();return new Blob([c],{type:"application/pdf"})}async function f(){if(!t)return alert("Select a PDF");S(!0);try{const u=await t.arrayBuffer(),p=await re.load(u),g=p.getPages(),B=await p.embedFont(je.Helvetica),m=g[0],{width:i,height:r}=m.getSize();if(s==="text")m.drawText(a,{x:40,y:r-80,size:14,font:B,color:ge(0,0,0)});else if(s==="image"&&v){const C=await v.arrayBuffer(),L=(v.type||"").toLowerCase();let I;L.includes("png")?I=await p.embedPng(C):I=await p.embedJpg(C),m.drawImage(I,{x:40,y:r-200,width:150,height:120})}else m.drawRectangle({x:40,y:r-240,width:200,height:100,color:ge(.9,.9,.9)});const o=await p.save(),c=new Blob([o],{type:"application/pdf"}),b=URL.createObjectURL(c),R=document.createElement("a");R.href=b,R.download=ie(W,t.name.replace(/\.pdf$/i,"")+"_edited"),R.click(),URL.revokeObjectURL(b)}catch(u){console.error(u),alert("Failed: "+u.message)}finally{S(!1)}}return e.jsxs("div",{children:[e.jsx("h2",{children:"Edit PDF"}),e.jsx("div",{style:{marginBottom:12},children:e.jsx("button",{onClick:()=>N(!x),style:{padding:"6px 12px",borderRadius:4,border:"1px solid #ccc",background:x?"#3b82f6":"#fff",color:x?"#fff":"#000",cursor:"pointer"},children:x?"Switch to Single Mode":"Switch to Batch Mode"})}),e.jsxs("div",{style:{marginTop:8},children:[e.jsx("label",{children:"Mode"}),e.jsxs("select",{value:s,onChange:u=>y(u.target.value),children:[e.jsx("option",{value:"text",children:"Add Text"}),e.jsx("option",{value:"image",children:"Add Image"}),e.jsx("option",{value:"shape",children:"Add Shape"})]})]}),s==="text"&&e.jsx("div",{style:{marginTop:8},children:e.jsx("input",{value:a,onChange:u=>E(u.target.value),style:{width:"60%"}})}),s==="image"&&e.jsx("div",{style:{marginTop:8},children:e.jsx("input",{type:"file",accept:"image/*",onChange:k})}),x?e.jsx("div",{style:{marginTop:16},children:e.jsx(ue,{accept:"application/pdf",processFile:l,outputNameSuffix:"_edited",taskName:`Edit PDF (${s})`})}):e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"file",accept:"application/pdf",onChange:j}),t&&e.jsx(ce,{value:W,onChange:u=>T(u.target.value),disabled:d,placeholder:"output_edited"}),e.jsx("div",{style:{marginTop:12},children:e.jsx("button",{className:"btn-primary",onClick:f,disabled:d,children:d?"Working...":"Apply Edits"})})]})]})}try{X.GlobalWorkerOptions.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${X.version}/pdf.worker.min.js`}catch{}function Qe(){const[t,w]=n.useState(null),[s,y]=n.useState(""),[a,E]=n.useState(!1),[d,S]=n.useState(!1);async function v(T){const x=T.target.files[0];if(x){w(x),y(""),E(!0);try{if(x.type==="application/pdf"){const N=await x.arrayBuffer(),k=await(await X.getDocument({data:N}).promise).getPage(1),l=k.getViewport({scale:2}),f=document.createElement("canvas");f.width=Math.ceil(l.width),f.height=Math.ceil(l.height);const u=f.getContext("2d");await k.render({canvasContext:u,viewport:l}).promise,await D(f)}else{const N=new Image,j=URL.createObjectURL(x);N.src=j,await new Promise(f=>N.onload=f);const k=document.createElement("canvas");k.width=N.naturalWidth,k.height=N.naturalHeight,k.getContext("2d").drawImage(N,0,0),URL.revokeObjectURL(j),await D(k)}}catch(N){console.error(N),alert("OCR failed: "+N.message)}finally{E(!1)}}}async function D(T){const{createWorker:x}=await de(async()=>{const{createWorker:k}=await import("./vendor_tesseract-BwXTs-dD.js").then(l=>l.i);return{createWorker:k}},__vite__mapDeps([3,1,0])),N=await x({logger:k=>{}});await N.load(),await N.loadLanguage("eng"),await N.initialize("eng");const{data:{text:j}}=await N.recognize(T);y(j),await N.terminate()}async function W(T){let x;if(T.type==="application/pdf"){const l=await T.arrayBuffer(),u=await(await X.getDocument({data:l}).promise).getPage(1),p=u.getViewport({scale:2});x=document.createElement("canvas"),x.width=Math.ceil(p.width),x.height=Math.ceil(p.height);const g=x.getContext("2d");await u.render({canvasContext:g,viewport:p}).promise}else{const l=new Image,f=URL.createObjectURL(T);l.src=f,await new Promise(p=>l.onload=p),x=document.createElement("canvas"),x.width=l.naturalWidth,x.height=l.naturalHeight,x.getContext("2d").drawImage(l,0,0),URL.revokeObjectURL(f)}const{createWorker:N}=await de(async()=>{const{createWorker:l}=await import("./vendor_tesseract-BwXTs-dD.js").then(f=>f.i);return{createWorker:l}},__vite__mapDeps([3,1,0])),j=await N({logger:l=>{}});await j.load(),await j.loadLanguage("eng"),await j.initialize("eng");const{data:{text:k}}=await j.recognize(x);return await j.terminate(),new Blob([k],{type:"text/plain"})}return e.jsxs("div",{children:[e.jsx("h2",{children:"OCR (Tesseract.js)"}),e.jsx("div",{style:{marginBottom:12},children:e.jsx("button",{onClick:()=>S(!d),style:{padding:"6px 12px",borderRadius:4,border:"1px solid #ccc",background:d?"#3b82f6":"#fff",color:d?"#fff":"#000",cursor:"pointer"},children:d?"Switch to Single Mode":"Switch to Batch Mode"})}),d?e.jsx(ue,{accept:".png,.jpg,.jpeg,application/pdf",processFile:W,outputNameSuffix:"_ocr.txt",taskName:"OCR Text Extraction"}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"dropzone",children:[e.jsx("input",{type:"file",accept:".png,.jpg,.jpeg,application/pdf",onChange:v}),e.jsx("div",{className:"muted",children:"Select an image or scanned PDF. Large files may take time; Tesseract runs locally in your browser."})]}),e.jsx("div",{style:{marginTop:12},children:a?e.jsx("div",{className:"muted",children:"Recognizing... (this may take a while)"}):e.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:s})})]})]})}function et(){const[t,w]=n.useState(null),[s,y]=n.useState("bottom-right"),[a,E]=n.useState(1),[d,S]=n.useState(!1),[v,D]=n.useState(""),[W,T]=n.useState(!1);async function x(k){var f;const l=(f=k.target.files)==null?void 0:f[0];l&&(w(l),D(pe(l,"_pagenums")))}async function N(k){const l=await k.arrayBuffer(),f=await re.load(l),u=f.getPages(),p=await f.embedFont(je.Helvetica);for(let B=0;B<u.length;B++){const m=u[B],{width:i,height:r}=m.getSize(),o=String(Number(a)+B),c=12;let b=i-40,R=20;s==="bottom-left"&&(b=20),s==="top-right"&&(R=r-20),s==="top-left"&&(b=20,R=r-20),m.drawText(o,{x:b,y:R,size:c,font:p,color:ge(0,0,0)})}const g=await f.save();return new Blob([g],{type:"application/pdf"})}async function j(){if(!t)return alert("Select a PDF");S(!0);try{const k=await t.arrayBuffer(),l=await re.load(k),f=l.getPages(),u=await l.embedFont(je.Helvetica);for(let i=0;i<f.length;i++){const r=f[i],{width:o,height:c}=r.getSize(),b=String(Number(a)+i),R=12;let C=o-40,L=20;s==="bottom-left"&&(C=20),s==="top-right"&&(L=c-20),s==="top-left"&&(C=20,L=c-20),r.drawText(b,{x:C,y:L,size:R,font:u,color:ge(0,0,0)})}const p=await l.save(),g=new Blob([p],{type:"application/pdf"}),B=URL.createObjectURL(g),m=document.createElement("a");m.href=B,m.download=ie(v,t.name.replace(/\.pdf$/i,"")+"_pagenums"),m.click(),URL.revokeObjectURL(B)}catch(k){console.error(k),alert("Failed: "+k.message)}finally{S(!1)}}return e.jsxs("div",{children:[e.jsx("h2",{children:"Page Numbers"}),e.jsx("div",{style:{marginBottom:12},children:e.jsx("button",{onClick:()=>T(!W),style:{padding:"6px 12px",borderRadius:4,border:"1px solid #ccc",background:W?"#3b82f6":"#fff",color:W?"#fff":"#000",cursor:"pointer"},children:W?"Switch to Single Mode":"Switch to Batch Mode"})}),W?e.jsx(ue,{accept:"application/pdf",processFile:N,outputNameSuffix:"_pagenums",taskName:`Add page numbers (${s}, start: ${a})`}):e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"file",accept:"application/pdf",onChange:x}),e.jsxs("div",{style:{marginTop:8},children:[e.jsx("label",{children:"Position"}),e.jsxs("select",{value:s,onChange:k=>y(k.target.value),children:[e.jsx("option",{value:"bottom-right",children:"Bottom Right"}),e.jsx("option",{value:"bottom-left",children:"Bottom Left"}),e.jsx("option",{value:"top-right",children:"Top Right"}),e.jsx("option",{value:"top-left",children:"Top Left"})]}),e.jsx("label",{style:{marginLeft:8},children:"Start"}),e.jsx("input",{type:"number",value:a,onChange:k=>E(k.target.value),style:{width:80,marginLeft:6}})]}),t&&e.jsx(ce,{value:v,onChange:k=>D(k.target.value),disabled:d,placeholder:"output_pagenums"}),e.jsx("div",{style:{marginTop:12},children:e.jsx("button",{className:"btn-primary",onClick:j,disabled:d,children:d?"Working...":"Add Page Numbers"})})]})]})}try{X.GlobalWorkerOptions.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${X.version}/pdf.worker.min.js`}catch(t){console.warn("pdfjs worker not set",t)}function tt(){const[t,w]=n.useState(!1),[s,y]=n.useState(null),[a,E]=n.useState(!1),[d,S]=n.useState([]),[v,D]=n.useState("");async function W(j){const k=j.target.files[0];if(k){y(k),S([]),D(pe(k));try{const l=await k.arrayBuffer(),f=await X.getDocument({data:l}).promise,u=[];for(let p=1;p<=f.numPages;p++){const g=await f.getPage(p),B=g.getViewport({scale:1.5}),m=document.createElement("canvas");m.width=Math.ceil(B.width),m.height=Math.ceil(B.height);const i=m.getContext("2d");await g.render({canvasContext:i,viewport:B}).promise;const r=m.toDataURL("image/png");u.push({dataUrl:r,selected:!0})}S(u)}catch(l){console.error(l),alert("Failed to render preview: "+l.message)}}}function T(j){S(k=>k.map((l,f)=>f===j?{...l,selected:!l.selected}:l))}async function x(){if(!(!s||d.length===0)){E(!0);try{const j=(await de(async()=>{const{default:l}=await import("./vendor_pptxgenjs-DrD6mDTk.js");return{default:l}},__vite__mapDeps([4,2,1,0]))).default,k=new j;for(const l of d){if(!l.selected)continue;k.addSlide().addImage({data:l.dataUrl,x:0,y:0,w:"100%",h:"100%"})}await k.writeFile({fileName:ie(v,s.name.replace(/\.pdf$/i,""),".pptx")})}catch(j){console.error(j),alert("Conversion failed: "+j.message)}finally{E(!1)}}}async function N(j,k){try{k(10);const l=await j.arrayBuffer();k(20);const f=await X.getDocument({data:l}).promise,u=f.numPages;k(30);const p=(await de(async()=>{const{default:m}=await import("./vendor_pptxgenjs-DrD6mDTk.js");return{default:m}},__vite__mapDeps([4,2,1,0]))).default,g=new p;for(let m=1;m<=u;m++){const i=await f.getPage(m),r=i.getViewport({scale:1.5}),o=document.createElement("canvas");o.width=Math.ceil(r.width),o.height=Math.ceil(r.height);const c=o.getContext("2d");await i.render({canvasContext:c,viewport:r}).promise;const b=o.toDataURL("image/png");g.addSlide().addImage({data:b,x:0,y:0,w:"100%",h:"100%"}),k(30+m/u*60)}k(90);const B=await g.write({outputType:"blob"});return k(100),B}catch(l){throw new Error(`Failed to convert PDF to PPTX: ${l.message||l}`)}}return e.jsxs("div",{children:[e.jsx("h2",{children:"PDF → PPTX"}),e.jsxs("div",{style:{display:"flex",gap:8,marginBottom:16,borderBottom:"2px solid var(--border)",paddingBottom:8},children:[e.jsx("button",{onClick:()=>w(!1),disabled:a,style:{padding:"8px 16px",backgroundColor:t?"transparent":"var(--primary)",color:t?"var(--text)":"white",border:t?"1px solid var(--border)":"none",borderRadius:4,cursor:"pointer",fontWeight:t?"normal":"bold"},children:"📄 Single File"}),e.jsx("button",{onClick:()=>w(!0),disabled:a,style:{padding:"8px 16px",backgroundColor:t?"var(--primary)":"transparent",color:t?"white":"var(--text)",border:t?"none":"1px solid var(--border)",borderRadius:4,cursor:"pointer",fontWeight:t?"bold":"normal"},children:"📚 Batch Process"})]}),t?e.jsxs("div",{children:[e.jsxs("p",{style:{marginBottom:16,padding:12,background:"var(--paper)",border:"1px solid var(--border)",borderRadius:4},children:[e.jsx("strong",{children:"Batch Mode:"})," Convert multiple PDFs to PowerPoint (.pptx) files. Each page becomes a slide with an image.",e.jsx("br",{}),e.jsx("em",{style:{fontSize:"0.9em",color:"var(--muted)"},children:"Note: Slides are exported as images — text isn't editable in PowerPoint."})]}),e.jsx(ue,{processFile:N,outputFilenameSuffix:"",acceptedFileTypes:"application/pdf",description:"Convert multiple PDFs to PowerPoint presentations",outputFileExtension:".pptx"})]}):e.jsxs("div",{children:[e.jsxs("div",{className:"dropzone",children:[e.jsx("input",{type:"file",accept:"application/pdf",onChange:W}),e.jsx("div",{className:"muted",children:"Select a PDF — each page will become a PPTX slide (image). You can preview and deselect pages before export."}),e.jsx("div",{className:"muted",style:{marginTop:6,fontSize:12},children:"Note: slides are exported as images — text isn't editable in PowerPoint."})]}),d.length>0&&e.jsxs("div",{style:{marginTop:12},children:[e.jsx("div",{className:"muted",children:"Preview (click to toggle include)"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(120px,1fr))",gap:8,marginTop:8},children:d.map((j,k)=>e.jsxs("div",{style:{border:j.selected?"2px solid #3b82f6":"1px solid #ddd",padding:6,cursor:"pointer"},onClick:()=>T(k),children:[e.jsx("img",{src:j.dataUrl,style:{width:"100%",height:120,objectFit:"cover"},alt:`page-${k+1}`}),e.jsxs("div",{style:{fontSize:12,marginTop:6,textAlign:"center"},children:["Page ",k+1]})]},k))})]}),s&&e.jsx(ce,{value:v,onChange:j=>D(j.target.value),disabled:a,placeholder:"output"}),e.jsx("div",{style:{marginTop:12},children:e.jsx("button",{className:"btn",onClick:x,disabled:a||d.length===0,children:a?"Converting...":"Convert to PPTX"})})]})]})}function st(){const[t,w]=n.useState(!1),[s,y]=n.useState(null),[a,E]=n.useState(!1),[d,S]=n.useState(""),[v,D]=n.useState(""),[W,T]=n.useState(""),x=Q.useRef(null),N=Q.useRef(null);Q.useEffect(()=>{d&&x.current&&x.current.focus()},[d]),Q.useEffect(()=>{v&&N.current&&N.current.focus()},[v]);function j(f){S(""),D("");const u=f.target.files[0];u&&(y(u),T(pe(u)))}async function k(){if(!s){S("Pilih file PPTX terlebih dahulu.");return}S(""),D(""),E(!0);try{const f=await s.arrayBuffer(),u=await ve.loadAsync(f),p=Object.keys(u.files).filter(B=>B.startsWith("ppt/media/")),g=[];for(const B of p){const m=await u.file(B).async("blob");g.push(m)}if(g.length===0){S("Tidak ditemukan gambar slide di PPTX. Hanya mendukung PPTX dengan gambar slide."),E(!1);return}if(g.length>0){const{jsPDF:B}=await de(async()=>{const{jsPDF:i}=await import("./vendor_jspdf-DlgZQKHI.js").then(r=>r.j);return{jsPDF:i}},__vite__mapDeps([2,1,0])),m=new B({unit:"px",format:"a4"});for(let i=0;i<g.length;i++){const r=g[i],o=URL.createObjectURL(r),c=await new Promise(C=>{const L=new Image;L.onload=()=>C(L),L.src=o}),b=m.internal.pageSize.getWidth(),R=m.internal.pageSize.getHeight();m.addImage(c,"PNG",0,0,b,R),i<g.length-1&&m.addPage(),URL.revokeObjectURL(o)}m.save(ie(W,s.name.replace(/\.pptx$/i,""))),D("Berhasil! PDF berhasil dibuat dan diunduh.")}else{const B=new ve;for(let i=0;i<g.length;i++){const r=await g[i].arrayBuffer();B.file(`slide_${i+1}.png`,r)}const m=await B.generateAsync({type:"blob"});Ue.saveAs(m,s.name.replace(/\.pptx$/i,"")+"_slides.zip"),D("Berhasil! ZIP gambar slide diunduh.")}}catch(f){S("Gagal: "+(f.message||f)),console.error(f)}finally{E(!1)}}async function l(f,u){try{u(10);const p=await f.arrayBuffer();u(20);const g=await ve.loadAsync(p),B=Object.keys(g.files).filter(c=>c.startsWith("ppt/media/"));u(40);const m=[];for(const c of B){const b=await g.file(c).async("blob");m.push(b)}if(m.length===0)throw new Error("No slide images found in PPTX. Only supports PPTX with slide images.");u(60);const{jsPDF:i}=await de(async()=>{const{jsPDF:c}=await import("./vendor_jspdf-DlgZQKHI.js").then(b=>b.j);return{jsPDF:c}},__vite__mapDeps([2,1,0])),r=new i({unit:"px",format:"a4"});for(let c=0;c<m.length;c++){const b=m[c],R=URL.createObjectURL(b),C=await new Promise(z=>{const A=new Image;A.onload=()=>z(A),A.src=R}),L=r.internal.pageSize.getWidth(),I=r.internal.pageSize.getHeight();r.addImage(C,"PNG",0,0,L,I),c<m.length-1&&r.addPage(),URL.revokeObjectURL(R),u(60+c/m.length*30)}u(90);const o=r.output("blob");return u(100),o}catch(p){throw new Error(`Failed to convert PPTX to PDF: ${p.message||p}`)}}return e.jsxs("div",{style:{maxWidth:520,margin:"0 auto",padding:12},children:[e.jsx("h2",{style:{textAlign:"center",marginBottom:16},children:"PPTX → PDF"}),e.jsxs("div",{style:{display:"flex",gap:8,marginBottom:16,borderBottom:"2px solid var(--border)",paddingBottom:8},children:[e.jsx("button",{onClick:()=>w(!1),disabled:a,style:{padding:"8px 16px",backgroundColor:t?"transparent":"var(--primary)",color:t?"var(--text)":"white",border:t?"1px solid var(--border)":"none",borderRadius:4,cursor:"pointer",fontWeight:t?"normal":"bold"},children:"📄 Single File"}),e.jsx("button",{onClick:()=>w(!0),disabled:a,style:{padding:"8px 16px",backgroundColor:t?"var(--primary)":"transparent",color:t?"white":"var(--text)",border:t?"none":"1px solid var(--border)",borderRadius:4,cursor:"pointer",fontWeight:t?"bold":"normal"},children:"📚 Batch Process"})]}),d&&e.jsx("div",{ref:x,tabIndex:-1,"aria-live":"assertive",style:{color:"#dc2626",marginBottom:8,background:"#fee2e2",padding:8,borderRadius:6,outline:"none"},children:d}),v&&e.jsx("div",{ref:N,tabIndex:-1,"aria-live":"polite",style:{color:"#059669",marginBottom:8,background:"#d1fae5",padding:8,borderRadius:6,outline:"none"},children:v}),t?e.jsxs("div",{children:[e.jsxs("p",{style:{marginBottom:16,padding:12,background:"var(--paper)",border:"1px solid var(--border)",borderRadius:4},children:[e.jsx("strong",{children:"Batch Mode:"})," Convert multiple PowerPoint (.pptx) presentations to PDF. Slide images will be converted to PDF pages."]}),e.jsx(ue,{processFile:l,outputFilenameSuffix:"",acceptedFileTypes:".pptx,application/vnd.openxmlformats-officedocument.presentationml.presentation",description:"Convert multiple PowerPoint presentations to PDF",outputFileExtension:".pdf"})]}):e.jsxs("div",{children:[a&&e.jsxs("div",{style:{marginBottom:8,display:"flex",alignItems:"center",gap:8},children:[e.jsx("span",{className:"loader",style:{display:"inline-block",width:24,height:24,border:"3b82f6",borderTop:"3px solid #fff",borderRadius:"50%",animation:"spin 1s linear infinite",verticalAlign:"middle"}})," ",e.jsx("span",{children:"Memproses, mohon tunggu..."})]}),e.jsxs("div",{className:"dropzone",style:{opacity:a?.6:1,pointerEvents:a?"none":"auto",border:"2px dashed #3b82f6",borderRadius:16,padding:24,marginBottom:16,background:"#f8fafc"},children:[e.jsx("input",{type:"file",accept:".pptx,application/vnd.openxmlformats-officedocument.presentationml.presentation",onChange:j,disabled:a}),e.jsx("div",{className:"muted",children:"Select a PPTX. If the file contains embedded slide images, they'll be converted to PDF pages; otherwise you'll get a ZIP of extracted images."})]}),s&&e.jsx("div",{className:"file-list",style:{margin:"16px 0"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,background:"#f9fafb",borderRadius:8,marginBottom:8,padding:8,opacity:a?.7:1},children:[e.jsx("div",{style:{minWidth:120,maxWidth:180,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontWeight:500},children:s.name}),e.jsxs("div",{style:{color:"#888",fontSize:13},children:[(s.size/1024).toFixed(1)," KB"]}),e.jsx("button",{className:"btn",onClick:()=>y(null),disabled:a,children:"Remove"})]})}),s&&e.jsx(ce,{value:W,onChange:f=>T(f.target.value),disabled:a,placeholder:"output"}),e.jsxs("div",{style:{marginTop:12,display:"flex",gap:8,flexWrap:"wrap"},children:[e.jsx("button",{className:"btn-primary",onClick:k,disabled:!s||a,children:a?"Converting...":"Convert to PDF"}),e.jsx("button",{className:"btn-ghost",style:{color:"#dc2626",marginLeft:"auto"},onClick:()=>{y(null),S(""),D("")},disabled:a||!s,children:"Reset"})]})]})]})}try{X.GlobalWorkerOptions.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${X.version}/pdf.worker.min.js`}catch{}function at(t,w,s){const y=t.slice(),a=y.splice(w,1)[0];return y.splice(s,0,a),y}function nt(){const[t,w]=n.useState(null),[s,y]=n.useState([]),[a,E]=n.useState(!1),[d,S]=n.useState(""),[v,D]=n.useState(""),[W,T]=n.useState(""),x=Q.useRef(null),N=Q.useRef(null);Q.useEffect(()=>{d&&x.current&&x.current.focus()},[d]),Q.useEffect(()=>{v&&N.current&&N.current.focus()},[v]);async function j(u){S(""),D("");const p=u.target.files[0];if(p){w(p),y([]),T(pe(p,"_reordered")),E(!0);try{const g=await p.arrayBuffer(),B=await X.getDocument({data:g}).promise,m=[];for(let i=1;i<=B.numPages;i++){const r=await B.getPage(i),o=r.getViewport({scale:1}),c=document.createElement("canvas");c.width=Math.ceil(o.width),c.height=Math.ceil(o.height);const b=c.getContext("2d");await r.render({canvasContext:b,viewport:o}).promise,m.push({thumb:c.toDataURL("image/png"),idx:i-1})}y(m),D("Berhasil memuat PDF.")}catch(g){S("Gagal memuat PDF: "+(g.message||g)),console.error(g)}E(!1)}}function k(u,p){u.dataTransfer.setData("text/plain",p)}function l(u,p){u.preventDefault();const g=parseInt(u.dataTransfer.getData("text/plain"),10);y(B=>at(B,g,p))}async function f(){if(!t){S("Pilih file PDF terlebih dahulu.");return}S(""),D(""),E(!0);try{const u=await t.arrayBuffer(),p=await re.load(u),g=await re.create(),B=s.map(b=>b.idx);(await g.copyPages(p,B)).forEach(b=>g.addPage(b));const i=await g.save(),r=new Blob([i],{type:"application/pdf"}),o=URL.createObjectURL(r),c=document.createElement("a");c.href=o,c.download=ie(W,t.name.replace(/\.pdf$/i,"")+"_reordered"),c.click(),URL.revokeObjectURL(o),D("Berhasil! PDF berhasil diekspor dan diunduh.")}catch(u){S("Gagal ekspor PDF: "+(u.message||u)),console.error(u)}E(!1)}return e.jsxs("div",{style:{maxWidth:520,margin:"0 auto",padding:12},children:[e.jsx("h2",{style:{textAlign:"center",marginBottom:16},children:"Reorder Pages"}),d&&e.jsx("div",{ref:x,tabIndex:-1,"aria-live":"assertive",style:{color:"#dc2626",marginBottom:8,background:"#fee2e2",padding:8,borderRadius:6,outline:"none"},children:d}),v&&e.jsx("div",{ref:N,tabIndex:-1,"aria-live":"polite",style:{color:"#059669",marginBottom:8,background:"#d1fae5",padding:8,borderRadius:6,outline:"none"},children:v}),a&&e.jsxs("div",{style:{marginBottom:8,display:"flex",alignItems:"center",gap:8},children:[e.jsx("span",{className:"loader",style:{display:"inline-block",width:24,height:24,border:"3b82f6",borderTop:"3px solid #fff",borderRadius:"50%",animation:"spin 1s linear infinite",verticalAlign:"middle"}})," ",e.jsx("span",{children:"Memproses, mohon tunggu..."})]}),e.jsxs("div",{className:"dropzone",style:{opacity:a?.6:1,pointerEvents:a?"none":"auto",border:"2px dashed #3b82f6",borderRadius:16,padding:24,marginBottom:16,background:"#f8fafc"},children:[e.jsx("input",{type:"file",accept:"application/pdf",onChange:j,disabled:a}),e.jsx("div",{className:"muted",children:"Drag thumbnails to reorder pages, then export."})]}),t&&e.jsx("div",{className:"file-list",style:{margin:"16px 0"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,background:"#f9fafb",borderRadius:8,marginBottom:8,padding:8,opacity:a?.7:1},children:[e.jsx("div",{style:{minWidth:120,maxWidth:180,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontWeight:500},children:t.name}),e.jsxs("div",{style:{color:"#888",fontSize:13},children:[(t.size/1024).toFixed(1)," KB"]}),e.jsx("button",{className:"btn",onClick:()=>{w(null),y([]),S(""),D("")},disabled:a,children:"Remove"})]})}),s.length>0&&e.jsxs("div",{style:{marginTop:12},children:[e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(100px,1fr))",gap:8},children:s.map((u,p)=>e.jsxs("div",{className:"file-item",draggable:!a,onDragStart:g=>!a&&k(g,p),onDragOver:g=>g.preventDefault(),onDrop:g=>!a&&l(g,p),style:{textAlign:"center",opacity:a?.7:1},children:[e.jsx("img",{src:u.thumb,style:{width:"100%",height:100,objectFit:"cover"},alt:`page-${p+1}`}),e.jsxs("div",{style:{fontSize:12,marginTop:6},children:["Pos ",p+1]})]},p))}),t&&e.jsx(ce,{value:W,onChange:u=>T(u.target.value),disabled:a,placeholder:"output_reordered"}),e.jsxs("div",{style:{marginTop:12,display:"flex",gap:8,flexWrap:"wrap"},children:[e.jsx("button",{className:"btn-primary",onClick:f,disabled:a,children:a?"Exporting...":"Export Reordered PDF"}),e.jsx("button",{className:"btn-ghost",style:{color:"#dc2626",marginLeft:"auto"},onClick:()=>{w(null),y([]),S(""),D("")},disabled:a||!t,children:"Reset"})]})]})]})}function rt(){const[t,w]=n.useState(!1),[s,y]=n.useState(90),[a,E]=n.useState(null),[d,S]=n.useState([]),[v,D]=n.useState(!1),[W,T]=n.useState(""),[x,N]=n.useState(""),[j,k]=n.useState(""),l=n.useRef(null),f=n.useRef(null);n.useEffect(()=>{W&&l.current&&l.current.focus()},[W]),n.useEffect(()=>{x&&f.current&&f.current.focus()},[x]);async function u(i){const r=i.target.files[0];if(r){if(T(""),N(""),!r.type.includes("pdf")){T("Please select a PDF file.");return}if(r.size>50*1024*1024){T("File too large (max 50MB).");return}try{E(r),k(pe(r,"_rotated"));const o=await r.arrayBuffer(),c=await re.load(o);S(new Array(c.getPageCount()).fill(!1)),N(`Loaded ${c.getPageCount()} pages successfully!`)}catch(o){console.error(o),T("Failed to load PDF: "+o.message),E(null),S([])}}}function p(i){S(r=>r.map((o,c)=>c===i?!o:o))}async function g(i){if(!a)return;const r=d.filter(o=>o).length;if(r===0){T("Please select at least one page to rotate.");return}T(""),N(""),D(!0);try{const o=await a.arrayBuffer(),c=await re.load(o),b=await re.create(),R=c.getPageCount(),C=[...Array(R).keys()];(await b.copyPages(c,C)).forEach((_,F)=>{if(d[F]){const P=i==="cw"?90:270;_.setRotation(P)}b.addPage(_)});const I=await b.save(),z=new Blob([I],{type:"application/pdf"}),A=URL.createObjectURL(z),q=document.createElement("a");q.href=A,q.download=ie(j,a.name.replace(/\.pdf$/i,"")+"_rotated"),q.click(),URL.revokeObjectURL(A),N(`Successfully rotated ${r} page(s) and downloaded!`)}catch(o){console.error(o),T("Rotation failed: "+o.message)}finally{D(!1)}}function B(){E(null),S([]),k(""),T(""),N("")}const m=async(i,r,o)=>{try{o(10);const c=await i.arrayBuffer(),b=await re.load(c);o(30);const R=b.getPageCount();for(let I=0;I<R;I++)b.getPage(I).setRotation({angle:s}),o(30+I/R*50);o(80);const C=await b.save();o(95);const L=new Blob([C],{type:"application/pdf"});return o(100),L}catch(c){throw console.error(`Error rotating ${i.name}:`,c),c}};return e.jsxs("div",{children:[e.jsx("h2",{children:"Rotate Pages"}),e.jsx("p",{className:"muted",children:"Select pages and rotate them clockwise or counter-clockwise."}),e.jsxs("div",{style:{display:"flex",justifyContent:"center",gap:8,marginBottom:16},children:[e.jsx("button",{className:t?"btn-outline":"btn-primary",onClick:()=>w(!1),style:{minWidth:120},children:"📄 Single PDF"}),e.jsx("button",{className:t?"btn-primary":"btn-outline",onClick:()=>w(!0),style:{minWidth:120},children:"🔄 Batch Rotate"})]}),t&&e.jsx(ue,{toolName:"Rotate PDFs",processFile:m,acceptedTypes:".pdf",outputExtension:".pdf",maxFiles:100,customOptions:e.jsxs("div",{style:{padding:"12px 0"},children:[e.jsxs("div",{style:{fontSize:14,color:"#666",marginBottom:8},children:["💡 ",e.jsx("strong",{children:"Batch Rotate Mode:"})," Rotate all pages in multiple PDFs at once."]}),e.jsx("div",{style:{marginBottom:12},children:e.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:["Rotation:",e.jsxs("select",{value:s,onChange:i=>y(Number(i.target.value)),style:{padding:"6px 12px",borderRadius:6,border:"1px solid #ddd"},children:[e.jsx("option",{value:90,children:"90° (Clockwise)"}),e.jsx("option",{value:180,children:"180° (Upside Down)"}),e.jsx("option",{value:270,children:"270° (Counter-clockwise)"})]})]})}),e.jsxs("div",{style:{fontSize:13,color:"#888"},children:["🔄 All pages in each PDF will be rotated",e.jsx("br",{}),"📦 Download individual files or all as ZIP",e.jsx("br",{}),"⚡ Process up to 100 PDFs simultaneously"]})]})}),!t&&e.jsxs("div",{children:[W&&e.jsxs("div",{className:"error-message",ref:l,tabIndex:-1,role:"alert",children:["⚠️ ",W]}),x&&e.jsxs("div",{className:"success-message",ref:f,tabIndex:-1,role:"status",children:["✅ ",x]}),e.jsxs("div",{className:"dropzone",children:[e.jsx("input",{type:"file",accept:"application/pdf",onChange:u,disabled:v,"aria-label":"Upload PDF to rotate"}),e.jsx("div",{className:"muted",children:"Load a PDF then select pages to rotate."})]}),a&&e.jsxs("div",{className:"file-info",children:[e.jsx("strong",{children:"📄 File:"})," ",a.name," (",(a.size/1024).toFixed(1)," KB)"]}),d.length>0&&e.jsxs("div",{style:{marginTop:16},children:[e.jsxs("div",{className:"muted",style:{marginBottom:12},children:["Click pages to toggle selection for rotation. Selected: ",d.filter(i=>i).length," / ",d.length]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(120px,1fr))",gap:8,marginBottom:16},children:d.map((i,r)=>e.jsxs("div",{className:"file-item",onClick:()=>p(r),style:{cursor:"pointer",background:i?"#eef2ff":"",border:i?"2px solid #4f46e5":"1px solid var(--border)",fontWeight:i?"600":"400"},role:"checkbox","aria-checked":i,tabIndex:0,onKeyDown:o=>{(o.key==="Enter"||o.key===" ")&&p(r)},children:["📄 Page ",r+1]},r))}),a&&e.jsx(ce,{value:j,onChange:i=>k(i.target.value),disabled:v,placeholder:"rotated"}),e.jsxs("div",{style:{display:"flex",gap:12,flexWrap:"wrap",alignItems:"center"},children:[e.jsx("button",{className:"btn",onClick:()=>g("cw"),disabled:v||d.filter(i=>i).length===0,children:v?"⏳ Processing...":"↻ Rotate Clockwise"}),e.jsx("button",{className:"btn",onClick:()=>g("ccw"),disabled:v||d.filter(i=>i).length===0,children:v?"⏳ Processing...":"↺ Rotate Counter-Clockwise"}),e.jsx("button",{className:"btn-ghost",style:{color:"#dc2626",marginLeft:"auto"},onClick:B,disabled:v,children:"Reset"})]})]})]})]})}try{X.GlobalWorkerOptions.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${X.version}/pdf.worker.min.js`}catch{}function ot({ov:t,onDrag:w,onStartDrag:s,onStartResize:y}){return e.jsxs("div",{className:"sig-overlay",style:{left:t.x,top:t.y,width:t.w,height:t.h},onMouseDown:s,children:[e.jsx("img",{src:t.dataUrl,className:"sig-image",alt:"sig"}),e.jsx("div",{className:"sig-resize",onMouseDown:y})]})}function it(){const[t,w]=n.useState(!1),[s,y]=n.useState(null),[a,E]=n.useState([]),[d,S]=n.useState(null),[v,D]=n.useState([]),[W,T]=n.useState(null),x=n.useRef([]),[N,j]=n.useState(!1),k=n.useRef(null),l=n.useRef(null),[f,u]=n.useState(""),[p,g]=n.useState(""),[B,m]=n.useState(""),i=n.useRef(null),r=n.useRef(null);n.useEffect(()=>{f&&i.current&&i.current.focus()},[f]),n.useEffect(()=>{p&&r.current&&r.current.focus()},[p]),n.useEffect(()=>{function F(P){if(!l.current)return;const{type:M,idx:U,startX:$,startY:H,startW:V,startH:ee,page:ae}=l.current,ne=P.clientX-$,Y=P.clientY-H;D(le=>{const oe=le.slice(),se={...oe[U]};return M==="move"?(se.x=Math.max(0,$+ne-oe[`_pageOffset${ae}`]),se.y=Math.max(0,H+Y-oe[`_pageOffsetY${ae}`])):M==="resize"&&(se.w=Math.max(10,V+ne),se.h=Math.max(10,ee+Y)),oe[U]=se,oe})}function h(){l.current=null}return window.addEventListener("mousemove",F),window.addEventListener("mouseup",h),()=>{window.removeEventListener("mousemove",F),window.removeEventListener("mouseup",h)}},[]);async function o(F){var P;const h=(P=F.target.files)==null?void 0:P[0];if(h){if(u(""),g(""),!h.type.includes("pdf")){u("Please select a PDF file.");return}if(h.size>50*1024*1024){u("File too large (max 50MB).");return}try{y(h),m(pe(h,"_signed")),await b(h),g("PDF loaded successfully! Upload or draw a signature.")}catch(M){console.error(M),u("Failed to load PDF: "+M.message),y(null),E([])}}}function c(F){var M;const h=(M=F.target.files)==null?void 0:M[0];if(!h)return;if(u(""),!h.type.startsWith("image/")){u("Please select an image file.");return}const P=new FileReader;P.onload=()=>{S(P.result),g('Signature image loaded! Click "Add" on any page to place it.')},P.onerror=()=>u("Failed to read image file."),P.readAsDataURL(h)}async function b(F){const h=await F.arrayBuffer(),M=await X.getDocument({data:h}).promise,U=[];for(let $=1;$<=M.numPages;$++){const H=await M.getPage($),V=H.getViewport({scale:1.5}),ee=document.createElement("canvas");ee.width=Math.floor(V.width),ee.height=Math.floor(V.height);const ae=ee.getContext("2d");await H.render({canvasContext:ae,viewport:V}).promise,U.push({canvas:ee,width:ee.width,height:ee.height,viewportWidth:V.width,viewportHeight:V.height})}E(U),D([])}function R(F,h){F.preventDefault();const M=v[h].page,$=a[M].canvas.getBoundingClientRect();D(H=>{const V=H.slice();return V[`_pageOffset${M}`]=$.left,V[`_pageOffsetY${M}`]=$.top,V}),T(h),l.current={type:"move",idx:h,startX:F.clientX,startY:F.clientY,page:M}}function C(F,h){F.preventDefault();const P=v[h];l.current={type:"resize",idx:h,startX:F.clientX,startY:F.clientY,startW:P.w,startH:P.h}}function L(F){if(!d){u("Please upload a signature image first.");return}const h=a[F];if(!h)return;const P=Math.min(200,h.width*.4),M=Math.min(80,h.height*.15),U=(h.width-P)/2,$=(h.height-M)/2;D(H=>{const V=H.concat({page:F,x:U,y:$,w:P,h:M,dataUrl:d});return x.current.push(H),V}),g(`Signature added to page ${F+1}. Drag to reposition or resize.`)}function I(){W!==null&&(D(F=>{const h=F.slice();return h.splice(W,1),x.current.push(F),h}),T(null))}function z(){const F=x.current.pop();F&&D(F)}async function A(){if(!s){u("Please select a PDF first.");return}if(v.length===0){u("Please place at least one signature before exporting.");return}u(""),g(""),j(!0);try{const F=await s.arrayBuffer(),h=await re.load(F),P=await(await fetch(d)).arrayBuffer(),M=String(d).startsWith("data:image/jpeg")||String(d).startsWith("data:image/jpg");let U=null;if(M)try{U=await h.embedJpg(P)}catch{U=await h.embedPng(P)}else try{U=await h.embedPng(P)}catch{U=await h.embedJpg(P)}for(const ae of v){const ne=h.getPages()[ae.page],{width:Y,height:le}=ne.getSize(),oe=a[ae.page],se=oe.width,O=oe.height,G=Y/se,K=le/O,Z=ae.x*G,J=le-(ae.y+ae.h)*K,te=ae.w*G,me=ae.h*K;ne.drawImage(U,{x:Z,y:J,width:te,height:me})}const $=await h.save(),H=new Blob([$],{type:"application/pdf"}),V=URL.createObjectURL(H),ee=document.createElement("a");ee.href=V,ee.download=ie(B,s.name.replace(/\.pdf$/i,"")+"_signed"),ee.click(),URL.revokeObjectURL(V),g(`Successfully signed PDF with ${v.length} signature(s) and downloaded!`)}catch(F){console.error(F),u("Failed to export signed PDF: "+(F.message||F))}finally{j(!1)}}async function q(F,h){try{if(!d)throw new Error("Please upload a signature image first.");h(10);const P=await F.arrayBuffer();h(30);const M=await re.load(P);h(50);const U=await(await fetch(d)).arrayBuffer(),$=String(d).startsWith("data:image/jpeg")||String(d).startsWith("data:image/jpg");let H=null;if($)try{H=await M.embedJpg(U)}catch{H=await M.embedPng(U)}else try{H=await M.embedPng(U)}catch{H=await M.embedJpg(U)}h(60);const V=M.getPages();for(let ne=0;ne<V.length;ne++){const Y=V[ne],{width:le,height:oe}=Y.getSize(),se=150,O=60,G=le-se-20;Y.drawImage(H,{x:G,y:20,width:se,height:O}),h(60+ne/V.length*30)}h(90);const ee=await M.save(),ae=new Blob([ee],{type:"application/pdf"});return h(100),ae}catch(P){throw new Error(`Failed to sign PDF: ${P.message||P}`)}}function _(){y(null),E([]),S(null),D([]),T(null),x.current=[],m(""),u(""),g(""),w(!1)}return e.jsxs("div",{children:[e.jsx("h2",{children:"Add Signature to PDF"}),e.jsx("p",{className:"muted",children:"Upload a PDF and signature image, then place and position signatures on pages."}),e.jsxs("div",{style:{display:"flex",gap:8,marginBottom:16,borderBottom:"2px solid var(--border)",paddingBottom:8},children:[e.jsx("button",{onClick:()=>w(!1),disabled:N,style:{padding:"8px 16px",backgroundColor:t?"transparent":"var(--primary)",color:t?"var(--text)":"white",border:t?"1px solid var(--border)":"none",borderRadius:4,cursor:"pointer",fontWeight:t?"normal":"bold"},children:"📄 Single File"}),e.jsx("button",{onClick:()=>w(!0),disabled:N,style:{padding:"8px 16px",backgroundColor:t?"var(--primary)":"transparent",color:t?"white":"var(--text)",border:t?"none":"1px solid var(--border)",borderRadius:4,cursor:"pointer",fontWeight:t?"bold":"normal"},children:"📚 Batch Process"})]}),f&&e.jsxs("div",{className:"error-message",ref:i,tabIndex:-1,role:"alert",children:["⚠️ ",f]}),p&&e.jsxs("div",{className:"success-message",ref:r,tabIndex:-1,role:"status",children:["✅ ",p]}),t?e.jsxs("div",{children:[e.jsx("div",{style:{marginBottom:16},children:e.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:6},children:[e.jsx("strong",{children:"Upload Signature Image"}),e.jsx("input",{"aria-label":"Upload signature image",type:"file",accept:"image/*",onChange:c,disabled:N})]})}),d&&e.jsxs("div",{style:{marginBottom:16,padding:12,border:"1px solid var(--border)",borderRadius:4},children:[e.jsx("strong",{children:"✅ Signature loaded!"}),e.jsx("p",{className:"muted",style:{marginTop:8},children:"In batch mode, the signature will be automatically placed in the bottom-right corner of all pages in each PDF."})]}),e.jsx(ue,{processFile:q,outputFilenameSuffix:"_signed",acceptedFileTypes:"application/pdf",description:"Add signatures to multiple PDFs automatically"})]}):e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",gap:12,flexWrap:"wrap",marginBottom:16},children:[e.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:6},children:[e.jsx("strong",{children:"1. Select PDF"}),e.jsx("input",{"aria-label":"Select PDF file",type:"file",accept:"application/pdf",onChange:o,disabled:N})]}),e.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:6},children:[e.jsx("strong",{children:"2. Upload Signature Image"}),e.jsx("input",{"aria-label":"Upload signature image",type:"file",accept:"image/*",onChange:c,disabled:N})]})]}),s&&e.jsxs("div",{className:"file-info",children:[e.jsx("strong",{children:"📄 PDF:"})," ",s.name," (",(s.size/1024).toFixed(1)," KB) |",e.jsx("strong",{children:" 📝 Signatures placed:"})," ",v.length]}),e.jsx("div",{style:{marginTop:12},children:e.jsx("div",{className:"muted",children:`Click a page's "Add" button to place signature, then drag to reposition or resize.`})}),e.jsx("div",{ref:k,style:{marginTop:12,display:"flex",flexDirection:"column",gap:18},children:a.map((F,h)=>e.jsxs("div",{style:{position:"relative",border:"1px solid var(--border)",display:"inline-block"},children:[e.jsx("div",{style:{position:"absolute",right:8,top:8,zIndex:10},children:e.jsx("button",{className:"btn-ghost",onClick:()=>L(h),children:"Add"})}),e.jsx("div",{style:{position:"relative"},children:e.jsx("div",{style:{position:"relative"},children:e.jsxs("div",{style:{position:"relative"},children:[e.jsxs("div",{style:{width:F.width,height:F.height},children:[e.jsx("div",{dangerouslySetInnerHTML:{__html:""}}),e.jsx("div",{ref:P=>{P&&!P.firstChild&&P.appendChild(F.canvas)}})]}),v.map((P,M)=>P.page===h?e.jsx(ot,{ov:P,onStartDrag:U=>R(U,M),onStartResize:U=>C(U,M)},M):null)]})})})]},h))}),s&&e.jsx(ce,{value:B,onChange:F=>m(F.target.value),disabled:N,placeholder:"signed"}),e.jsxs("div",{style:{marginTop:16,display:"flex",gap:12,flexWrap:"wrap",alignItems:"center"},children:[e.jsx("button",{className:"btn-primary",onClick:A,disabled:N||!s||v.length===0,children:N?"⏳ Processing...":"📥 Export Signed PDF"}),e.jsx("button",{className:"btn-ghost",onClick:I,disabled:W===null||N,children:"🗑️ Delete Selected"}),e.jsx("button",{className:"btn-ghost",onClick:z,disabled:x.current.length===0||N,children:"↶ Undo"}),e.jsx("button",{className:"btn-ghost",style:{color:"#dc2626",marginLeft:"auto"},onClick:_,disabled:N,children:"Reset"})]})]})]})}function lt(){const[t,w]=n.useState(!1),[s,y]=n.useState(null),[a,E]=n.useState("text"),[d,S]=n.useState("Sample Watermark"),[v,D]=n.useState(.25),[W,T]=n.useState(30),[x,N]=n.useState(1),[j,k]=n.useState(!1),[l,f]=n.useState(null),[u,p]=n.useState(null),[g,B]=n.useState(!1),[m,i]=n.useState(""),[r,o]=n.useState(""),[c,b]=n.useState(""),R=n.useRef(null),C=n.useRef(null);n.useEffect(()=>{m&&R.current&&R.current.focus()},[m]),n.useEffect(()=>{r&&C.current&&C.current.focus()},[r]);const L=n.useRef(null);n.useEffect(()=>{q()},[d,u,v,W,x,j,a]);async function I(h){var M;i(""),o("");const P=(M=h.target.files)==null?void 0:M[0];if(P){if(!P.name.toLowerCase().endsWith(".pdf")){i("File harus PDF.");return}if(P.size>50*1024*1024){i("Ukuran file terlalu besar (maks 50MB).");return}y(P),b(pe(P,"_watermarked"))}}async function z(h){var U;i(""),o("");const P=(U=h.target.files)==null?void 0:U[0];if(!P)return;f(P);const M=new FileReader;M.onload=()=>p(M.result),M.readAsDataURL(P)}function A(h,P,M){h.clearRect(0,0,P,M),h.save(),h.globalAlpha=Number(v),h.translate(P/2,M/2),h.rotate(W*Math.PI/180);const U=Number(x)||1;if(a==="text"){h.font=`${48*U}px sans-serif`;try{const $=getComputedStyle(document.documentElement);h.fillStyle=$.getPropertyValue("--muted")||"#444"}catch{h.fillStyle="#444"}if(h.textAlign="center",h.textBaseline="middle",j){const $=300*U,H=200*U;for(let V=-M;V<M*2;V+=H)for(let ee=-P;ee<P*2;ee+=$)h.save(),h.translate(ee,V),h.fillText(d,0,0),h.restore()}else h.fillText(d,0,0)}else if(a==="image"&&u){const $=new Image;$.src=u,$.onload=()=>{const H=$.naturalWidth*U,V=$.naturalHeight*U;if(j){const ee=H+60,ae=V+60;for(let ne=-M;ne<M*2;ne+=ae)for(let Y=-P;Y<P*2;Y+=ee)h.drawImage($,Y,ne,H,V)}else h.drawImage($,-H/2,-V/2,H,V)}}h.restore()}function q(){const h=L.current;if(!h)return;const P=h.getContext("2d"),M=h.width,U=h.height;try{const $=getComputedStyle(document.documentElement);P.fillStyle=$.getPropertyValue("--paper")||"#fff",P.strokeStyle=$.getPropertyValue("--border")||"#ddd"}catch{P.fillStyle="#fff",P.strokeStyle="#ddd"}P.fillRect(0,0,M,U),P.strokeRect(10,10,M-20,U-20),P.save(),P.translate(M/2,U/2),A(P,M,U),P.restore()}async function _(){if(!s){i("Pilih file PDF terlebih dahulu.");return}i(""),o(""),B(!0);try{const h=await s.arrayBuffer(),P=await re.load(h),M=P.getPages();let U=null,$=null,H=!1;a==="image"&&l&&(U=await l.arrayBuffer(),H=(l.type||"").toLowerCase().includes("png"),H?$=await P.embedPng(U):$=await P.embedJpg(U));for(const Y of M){const{width:le,height:oe}=Y.getSize();if(a==="text"){const se=48*Number(x||1);if(j){const O=300*Number(x||1),G=200*Number(x||1);for(let K=-G;K<oe+G;K+=G)for(let Z=-O;Z<le+O;Z+=O)Y.drawText(d,{x:Z+O/2,y:K+G/2,size:se,color:ge(.4,.4,.4),opacity:Number(v)})}else Y.drawText(d,{x:le/2-d.length*se*.12,y:oe/2,size:se,color:ge(.4,.4,.4),opacity:Number(v)})}else if(a==="image"&&$){const se=$.width*Number(x||1),O=$.height*Number(x||1);if(j){const G=se+40,K=O+40;for(let Z=-K;Z<oe+K;Z+=K)for(let J=-G;J<le+G;J+=G)Y.drawImage($,{x:J,y:Z,width:se,height:O,opacity:Number(v)})}else Y.drawImage($,{x:le/2-se/2,y:oe/2-O/2,width:se,height:O,opacity:Number(v)})}}const V=await P.save(),ee=new Blob([V],{type:"application/pdf"}),ae=URL.createObjectURL(ee),ne=document.createElement("a");ne.href=ae,ne.download=ie(c,s.name.replace(/\.pdf$/i,"")+"_watermarked"),ne.click(),URL.revokeObjectURL(ae),o("Berhasil! Watermark berhasil diterapkan dan diunduh.")}catch(h){console.error(h),i("Gagal: "+(h.message||h))}finally{B(!1)}}async function F(h,P){try{if(a==="image"&&!l)throw new Error("Please upload a watermark image first.");P(10);const M=await h.arrayBuffer();P(30);const U=await re.load(M),$=U.getPages();P(50);let H=null,V=null,ee=!1;a==="image"&&l&&(H=await l.arrayBuffer(),ee=(l.type||"").toLowerCase().includes("png"),ee?V=await U.embedPng(H):V=await U.embedJpg(H)),P(60);for(let Y=0;Y<$.length;Y++){const le=$[Y],{width:oe,height:se}=le.getSize();if(a==="text"){const O=48*Number(x||1);if(j){const G=300*Number(x||1),K=200*Number(x||1);for(let Z=-K;Z<se+K;Z+=K)for(let J=-G;J<oe+G;J+=G)le.drawText(d,{x:J+G/2,y:Z+K/2,size:O,color:ge(.4,.4,.4),opacity:Number(v)})}else le.drawText(d,{x:oe/2-d.length*O*.12,y:se/2,size:O,color:ge(.4,.4,.4),opacity:Number(v)})}else if(a==="image"&&V){const O=V.width*Number(x||1),G=V.height*Number(x||1);if(j){const K=O+40,Z=G+40;for(let J=-Z;J<se+Z;J+=Z)for(let te=-K;te<oe+K;te+=K)le.drawImage(V,{x:te,y:J,width:O,height:G,opacity:Number(v)})}else le.drawImage(V,{x:oe/2-O/2,y:se/2-G/2,width:O,height:G,opacity:Number(v)})}P(60+Y/$.length*30)}P(90);const ae=await U.save(),ne=new Blob([ae],{type:"application/pdf"});return P(100),ne}catch(M){throw new Error(`Failed to watermark PDF: ${M.message||M}`)}}return e.jsxs("div",{style:{maxWidth:520,margin:"0 auto",padding:12},children:[e.jsx("h2",{style:{textAlign:"center",marginBottom:16},children:"Watermark PDF"}),e.jsxs("div",{style:{display:"flex",gap:8,marginBottom:16,borderBottom:"2px solid var(--border)",paddingBottom:8},children:[e.jsx("button",{onClick:()=>w(!1),disabled:g,style:{padding:"8px 16px",backgroundColor:t?"transparent":"var(--primary)",color:t?"var(--text)":"white",border:t?"1px solid var(--border)":"none",borderRadius:4,cursor:"pointer",fontWeight:t?"normal":"bold"},children:"📄 Single File"}),e.jsx("button",{onClick:()=>w(!0),disabled:g,style:{padding:"8px 16px",backgroundColor:t?"var(--primary)":"transparent",color:t?"white":"var(--text)",border:t?"none":"1px solid var(--border)",borderRadius:4,cursor:"pointer",fontWeight:t?"bold":"normal"},children:"📚 Batch Process"})]}),m&&e.jsx("div",{ref:R,tabIndex:-1,"aria-live":"assertive",style:{color:"#dc2626",marginBottom:8,background:"#fee2e2",padding:8,borderRadius:6,outline:"none"},children:m}),r&&e.jsx("div",{ref:C,tabIndex:-1,"aria-live":"polite",style:{color:"#059669",marginBottom:8,background:"#d1fae5",padding:8,borderRadius:6,outline:"none"},children:r}),t?e.jsxs("div",{children:[e.jsxs("div",{style:{marginTop:12,display:"flex",gap:12,alignItems:"center",flexWrap:"wrap"},children:[e.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[e.jsx("input",{type:"radio",name:"mode",value:"text",checked:a==="text",onChange:()=>E("text"),disabled:g})," Text"]}),e.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[e.jsx("input",{type:"radio",name:"mode",value:"image",checked:a==="image",onChange:()=>E("image"),disabled:g})," Image"]}),a==="image"&&e.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:["Image: ",e.jsx("input",{type:"file",accept:"image/*",onChange:z,disabled:g})]})]}),a==="text"&&e.jsx("div",{style:{marginTop:8},children:e.jsx("input",{value:d,onChange:h=>S(h.target.value),style:{width:"60%"},disabled:g,placeholder:"Watermark text"})}),e.jsxs("div",{style:{marginTop:8,display:"flex",gap:12,alignItems:"center",flexWrap:"wrap"},children:[e.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:["Opacity",e.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:v,onChange:h=>D(Number(h.target.value)),disabled:g}),e.jsxs("div",{style:{width:48,textAlign:"right"},children:[Math.round(v*100),"%"]})]}),e.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:["Scale",e.jsx("input",{type:"range",min:"0.1",max:"3",step:"0.05",value:x,onChange:h=>N(Number(h.target.value)),disabled:g}),e.jsxs("div",{style:{width:48,textAlign:"right"},children:[x.toFixed(2),"x"]})]}),e.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[e.jsx("input",{type:"checkbox",checked:j,onChange:h=>k(h.target.checked),disabled:g})," Tiling"]})]}),e.jsxs("div",{style:{marginTop:12,padding:12,border:"1px solid var(--border)",borderRadius:4,background:"var(--paper)"},children:[e.jsx("strong",{children:"Watermark Settings:"}),e.jsxs("ul",{style:{marginTop:8,marginBottom:0,paddingLeft:20},children:[e.jsxs("li",{children:["Mode: ",a==="text"?`Text ("${d}")`:"Image"]}),e.jsxs("li",{children:["Opacity: ",Math.round(v*100),"%"]}),e.jsxs("li",{children:["Scale: ",x.toFixed(2),"x"]}),e.jsxs("li",{children:["Tiling: ",j?"Yes":"No"]})]})]}),e.jsx(ue,{processFile:F,outputFilenameSuffix:"_watermarked",acceptedFileTypes:"application/pdf",description:"Apply watermark to multiple PDFs"})]}):e.jsxs("div",{children:[g&&e.jsxs("div",{style:{marginBottom:8,display:"flex",alignItems:"center",gap:8},children:[e.jsx("span",{className:"loader",style:{display:"inline-block",width:24,height:24,border:"3px solid #3b82f6",borderTop:"3px solid #fff",borderRadius:"50%",animation:"spin 1s linear infinite",verticalAlign:"middle"}})," ",e.jsx("span",{children:"Memproses, mohon tunggu..."})]}),e.jsxs("div",{style:{marginBottom:8,background:"#f9fafb",borderRadius:8,padding:8,boxShadow:"0 1px 4px #0001"},children:[e.jsx("input",{type:"file",accept:"application/pdf",onChange:I,disabled:g}),s&&e.jsxs("div",{style:{marginTop:8},children:[e.jsx("div",{style:{fontWeight:500,color:"#3b82f6",wordBreak:"break-all"},children:s.name}),e.jsxs("div",{style:{color:"#888",fontSize:13},children:[(s.size/1024).toFixed(1)," KB • ",s.lastModified?new Date(s.lastModified).toLocaleString():""]})]})]}),e.jsxs("div",{style:{marginTop:12,display:"flex",gap:12,alignItems:"center",flexWrap:"wrap"},children:[e.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[e.jsx("input",{type:"radio",name:"mode",value:"text",checked:a==="text",onChange:()=>E("text"),disabled:g})," Text"]}),e.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[e.jsx("input",{type:"radio",name:"mode",value:"image",checked:a==="image",onChange:()=>E("image"),disabled:g})," Image"]}),a==="image"&&e.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:["Image: ",e.jsx("input",{type:"file",accept:"image/*",onChange:z,disabled:g})]})]}),a==="text"&&e.jsx("div",{style:{marginTop:8},children:e.jsx("input",{value:d,onChange:h=>S(h.target.value),style:{width:"60%"},disabled:g})}),e.jsxs("div",{style:{marginTop:8,display:"flex",gap:12,alignItems:"center",flexWrap:"wrap"},children:[e.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:["Opacity",e.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:v,onChange:h=>D(Number(h.target.value)),disabled:g}),e.jsxs("div",{style:{width:48,textAlign:"right"},children:[Math.round(v*100),"%"]})]}),e.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:["Rotation",e.jsx("input",{type:"number",value:W,onChange:h=>T(Number(h.target.value)),style:{width:80},disabled:g})]}),e.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:["Scale",e.jsx("input",{type:"range",min:"0.1",max:"3",step:"0.05",value:x,onChange:h=>N(Number(h.target.value)),disabled:g}),e.jsxs("div",{style:{width:48,textAlign:"right"},children:[x.toFixed(2),"x"]})]}),e.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[e.jsx("input",{type:"checkbox",checked:j,onChange:h=>k(h.target.checked),disabled:g})," Tiling"]})]}),e.jsxs("div",{style:{marginTop:12},children:[e.jsx("div",{className:"muted",children:"Preview"}),e.jsx("canvas",{"aria-label":"Watermark preview",ref:L,width:600,height:800,style:{width:"100%",maxWidth:600,display:"block",border:"1px solid var(--border)",background:"var(--paper)"}})]}),s&&e.jsx(ce,{value:c,onChange:h=>b(h.target.value),disabled:g,placeholder:"watermarked"}),e.jsxs("div",{style:{marginTop:12,display:"flex",gap:8,flexWrap:"wrap"},children:[e.jsx("button",{className:"btn-primary",onClick:_,disabled:g||!s,children:g?"Working...":"Apply Watermark"}),e.jsx("button",{className:"btn-ghost",style:{color:"#dc2626",marginLeft:"auto"},onClick:()=>{y(null),f(null),p(null),b(""),i(""),o("")},disabled:g||!s,children:"Reset"})]})]})]})}function ct(t){const w=new Blob([t],{type:"application/javascript"}),s=URL.createObjectURL(w),y=new Worker(s,{type:"module"});return y._blobUrl=s,y}function Ne(t){if(t){try{t.terminate()}catch{}if(t._blobUrl){try{URL.revokeObjectURL(t._blobUrl)}catch{}t._blobUrl=null}}}const dt=`
self._aborted = false
self.onmessage = async (ev) => {
  const msg = ev.data
  if (!msg) return
  if (msg.cmd === "abort") { self._aborted = true; self.postMessage({ type: "cancelled" }); return }
  if (msg.cmd === "start") {
    self._aborted = false
    const files = msg.files || []
    const watermark = msg.watermark || "CONFIDENTIAL"
    try {
      const PDFLib = await import('pdf-lib')
      const JSZip = (await import('jszip')).default
      const zip = new JSZip()
      let totalPages = 0
      const pageCounts = []
      for (let i = 0; i < files.length; i++) {
        const f = files[i]
        try {
          if (!f.buffer) { pageCounts.push(0); continue }
          const arr = f.buffer instanceof ArrayBuffer ? f.buffer : f.buffer.buffer
          const pdfDoc = await PDFLib.PDFDocument.load(arr)
          const pages = pdfDoc.getPages()
          pageCounts.push(pages.length)
          totalPages += pages.length
        } catch (e) { pageCounts.push(0) }
      }
      let processed = 0
      for (let fi = 0; fi < files.length; fi++) {
        if (self._aborted) { self.postMessage({ type: "cancelled" }); return }
        const f = files[fi]
        try {
          self.postMessage({ type: "progress", percent: Math.round((processed / Math.max(1, totalPages)) * 100), message: "Starting " + f.name, fileIndex: fi, filePercent: 0 })
          if (!f.buffer) { self.postMessage({ type: "file-done", fileIndex: fi }); continue }
          const arr = f.buffer instanceof ArrayBuffer ? f.buffer : f.buffer.buffer
          const pdfDoc = await PDFLib.PDFDocument.load(arr)
          const pages = pdfDoc.getPages()
          for (let pi = 0; pi < pages.length; pi++) {
            if (self._aborted) { self.postMessage({ type: "cancelled" }); return }
            const page = pages[pi]
            const { width, height } = page.getSize()
            page.drawText(watermark, {
              x: width / 2 - 100,
              y: height / 2,
              size: 48,
              color: PDFLib.rgb ? PDFLib.rgb(0.8, 0.1, 0.1) : PDFLib.rgb(0.8, 0.1, 0.1),
              rotate: PDFLib.degrees ? PDFLib.degrees(-45) : PDFLib.degrees(-45),
              opacity: 0.25,
            })
            processed += 1
            const percent = totalPages > 0 ? Math.round((processed / totalPages) * 100) : 0
            const filePercent = pages.length > 0 ? Math.round(((pi+1) / pages.length) * 100) : 0
            self.postMessage({ type: "progress", percent: percent, message: "Processing " + f.name + " (" + (pi+1) + "/" + pages.length + ")", fileIndex: fi, filePercent: filePercent })
          }
          const out = await pdfDoc.save()
          zip.file(f.name.replace(/\\.pdf$/i, '') + '-watermarked.pdf', out)
          self.postMessage({ type: "file-done", fileIndex: fi })
        } catch (err) {
          self.postMessage({ type: "progress", percent: Math.round((processed / Math.max(1, totalPages)) * 100), message: "Error processing " + f.name, fileIndex: fi, filePercent: 0 })
        }
      }
      const blob = await zip.generateAsync({ type: 'blob' })
      const arrayBuffer = await blob.arrayBuffer()
      self.postMessage({ type: 'result', buffer: arrayBuffer }, [arrayBuffer])
    } catch (err) {
      self.postMessage({ type: 'error', error: String(err) })
    }
  }
}
`;function ut(){const[t,w]=n.useState([]),[s,y]=n.useState("CONFIDENTIAL"),[a,E]=n.useState(!1),d=n.useRef({aborted:!1}),S=n.useRef(null),[v,D]=n.useState([]),[W,T]=n.useState("watermarked-files");n.useEffect(()=>()=>{if(S.current){try{S.current.terminate()}catch{}S.current=null}},[]);const x=j=>{const k=Array.from(j.target.files||[]);w(k),D(k.map(l=>({name:l.name,status:"pending",percent:0})))},N=async()=>{if(!t.length)return;E(!0),d.current.aborted=!1;const j=[];for(const l of t)try{const f=await l.arrayBuffer();j.push({name:l.name,buffer:f})}catch{j.push({name:l.name,buffer:null})}let k=!1;try{const l=ct(dt);S.current=l,k=!0,l.onmessage=u=>{const p=u.data;if(p)if(p.type==="progress"){const{percent:g,message:B,fileIndex:m,filePercent:i}=p;window.dispatchEvent(new CustomEvent("pdf-progress",{detail:{percent:g,message:B}})),typeof m=="number"&&D(r=>{const o=r.slice();return o[m]={...o[m]||{},status:"processing",percent:i},o})}else if(p.type==="file-done"){const{fileIndex:g}=p;D(B=>{const m=B.slice();return m[g]={...m[g]||{},status:"done",percent:100},m})}else if(p.type==="result"){const{buffer:g}=p,B=new Blob([g],{type:"application/zip"}),m=URL.createObjectURL(B),i=document.createElement("a");i.href=m,i.download=ie(W,"watermarked-files",".zip"),document.body.appendChild(i),i.click(),i.remove(),URL.revokeObjectURL(m),E(!1),window.dispatchEvent(new CustomEvent("pdf-progress",{detail:{end:!0,message:"Complete"}})),Ne(S.current),S.current=null}else p.type==="error"?(console.error("Worker error",p.error),E(!1),window.dispatchEvent(new CustomEvent("pdf-progress",{detail:{end:!0,message:"Error"}})),Ne(S.current),S.current=null):p.type==="cancelled"&&(E(!1),window.dispatchEvent(new CustomEvent("pdf-progress",{detail:{end:!0,message:"Cancelled"}})),Ne(S.current),S.current=null)};const f=j.reduce((u,p)=>(p.buffer&&u.push(p.buffer),u),[]);l.postMessage({cmd:"start",files:j,watermark:s},f)}catch(l){console.warn("Worker not available, falling back to in-thread processing",l),k=!1}if(!k)try{const{PDFDocument:l,rgb:f,degrees:u}=await de(async()=>{const{PDFDocument:C,rgb:L,degrees:I}=await import("./vendor_pdf_lib-CHoXx7fs.js");return{PDFDocument:C,rgb:L,degrees:I}},__vite__mapDeps([5,1,0])),p=(await de(async()=>{const{default:C}=await import("./vendor_jszip-B1Nm6Iki.js").then(L=>L.j);return{default:C}},__vite__mapDeps([0,1]))).default,g=new p;let B=0;const m=[];for(const C of t)try{const L=await C.arrayBuffer(),z=(await l.load(L)).getPages();m.push(z.length),B+=z.length}catch(L){console.warn("Could not read file for page count",C.name,L),m.push(0)}window.dispatchEvent(new CustomEvent("pdf-progress",{detail:{percent:0,message:"Starting batch watermark",indeterminate:!1}}));let i=0,r=null;const o=C=>{const L=Date.now(),I=()=>{window.dispatchEvent(new CustomEvent("pdf-progress",{detail:C})),i=Date.now()},z=L-i;z>=200||C.percent===100?(r&&(clearTimeout(r),r=null),I()):(r&&clearTimeout(r),r=setTimeout(()=>{I(),r=null},200-z))};for(let C=0;C<t.length&&!d.current.aborted;C++){const L=t[C];try{D(_=>{const F=_.slice();return F[C]={...F[C]||{},status:"processing",percent:0},F});const I=await L.arrayBuffer();if(d.current.aborted)break;const z=await l.load(I),A=z.getPages();for(let _=0;_<A.length&&!d.current.aborted;_++){const F=A[_],{width:h,height:P}=F.getSize();F.drawText(s,{x:h/2-100,y:P/2,size:48,color:f(.8,.1,.1),rotate:u(-45),opacity:.25});try{const M=m.slice(0,C).reduce((H,V)=>H+V,0)+(_+1),U=B>0?Math.round(M/B*100):0;o({percent:U,message:`Processing ${L.name} (${_+1}/${A.length})`});const $=A.length>0?Math.round((_+1)/A.length*100):0;D(H=>{const V=H.slice();return V[C]={...V[C]||{},percent:$},V})}catch{}}const q=await z.save();g.file(L.name.replace(/\.pdf$/i,"")+"-watermarked.pdf",q),D(_=>{const F=_.slice();return F[C]={...F[C]||{},status:"done",percent:100},F})}catch(I){console.error("Error watermarking",L.name,I),D(z=>{const A=z.slice();return A[C]={...A[C]||{},status:"error",percent:0},A})}}window.dispatchEvent(new CustomEvent("pdf-progress",{detail:{percent:100,message:"Packaging ZIP",indeterminate:!1}}));const c=await g.generateAsync({type:"blob"}),b=URL.createObjectURL(c),R=document.createElement("a");R.href=b,R.download=ie(W,"watermarked-files",".zip"),document.body.appendChild(R),R.click(),R.remove(),URL.revokeObjectURL(b),E(!1),window.dispatchEvent(new CustomEvent("pdf-progress",{detail:{end:!0,message:"Complete"}}))}catch(l){console.error("Fallback processing failed",l),E(!1),window.dispatchEvent(new CustomEvent("pdf-progress",{detail:{end:!0,message:"Error"}}))}};return e.jsxs("div",{className:"batch-tool",children:[e.jsx("h2",{children:"Batch Watermark"}),e.jsx("p",{children:"Upload multiple PDFs and apply a text watermark to each page. Results are returned as a ZIP."}),e.jsxs("div",{children:[e.jsx("label",{children:"Watermark text:"}),e.jsx("input",{value:s,onChange:j=>y(j.target.value)})]}),e.jsx("div",{style:{marginTop:8},children:e.jsx("input",{type:"file",accept:"application/pdf",multiple:!0,onChange:x})}),v.length>0&&e.jsxs("div",{className:"batch-file-list",children:[e.jsx("h3",{children:"Files"}),e.jsx("ul",{style:{listStyle:"none",padding:0},children:v.map((j,k)=>e.jsxs("li",{className:"batch-file-item",children:[e.jsxs("div",{className:"batch-file-row",children:[e.jsx("div",{style:{flex:1},children:j.name}),e.jsx("div",{style:{width:120,textAlign:"right",fontSize:12},children:j.status||"pending"})]}),e.jsx("div",{className:"progress-bar-small",style:{marginTop:6},children:e.jsx("div",{className:"progress-fill",style:{width:`${j.percent||0}%`,background:j.status==="error"?"#e53935":void 0}})})]},k))})]}),t.length>0&&e.jsx(ce,{value:W,onChange:j=>T(j.target.value),disabled:a,placeholder:"watermarked-files"}),e.jsxs("div",{style:{marginTop:12,display:"flex",gap:8},children:[e.jsx("button",{className:"btn-primary",onClick:N,disabled:a||t.length===0,children:a?"Processing...":"Apply Watermark & Download ZIP"}),e.jsx("button",{className:"btn-cancel",onClick:()=>{if(S.current){try{S.current.postMessage({cmd:"abort"})}catch{}try{S.current.terminate()}catch{}S.current=null}d.current.aborted=!0,E(!1),D(j=>j.map(k=>k.status==="processing"?{...k,status:"pending"}:k)),window.dispatchEvent(new CustomEvent("pdf-progress",{detail:{end:!0,message:"Cancelled"}}))},disabled:!a,children:"Cancel"})]}),e.jsxs("div",{style:{marginTop:12},children:[e.jsx("strong",{children:t.length})," file(s) selected"]})]})}function pt(){const[t,w]=n.useState(null),[s,y]=n.useState(null),[a,E]=n.useState(!1),[d,S]=n.useState(""),[v,D]=n.useState(""),W=n.useRef(null),T=n.useRef(null);n.useEffect(()=>{d&&W.current&&W.current.focus()},[d]),n.useEffect(()=>{v&&T.current&&T.current.focus()},[v]);const x=async N=>{var k;S(""),D(""),y(null);const j=(k=N.target.files)==null?void 0:k[0];if(j){w(j),E(!0);try{const{PDFDocument:l}=await de(async()=>{const{PDFDocument:c}=await import("./vendor_pdf_lib-CHoXx7fs.js");return{PDFDocument:c}},__vite__mapDeps([5,1,0])),f=await j.arrayBuffer(),u=await l.load(f),p=u.getTitle()||"No title",g=u.getAuthor()||"Unknown author",B=u.getSubject()||"No subject",m=u.getCreator()||"Unknown creator",i=u.getProducer()||"Unknown producer",r=u.getCreationDate(),o=u.getModificationDate();y({pages:u.getPageCount(),title:p,author:g,subject:B,creator:m,producer:i,creationDate:r?r.toISOString():"Unknown",modificationDate:o?o.toISOString():"Unknown",fileSize:j.size,fileName:j.name}),D("Berhasil membaca info PDF.")}catch(l){S("Gagal membaca PDF: "+(l.message||l)),y({error:"Could not read PDF"}),console.error("Error reading PDF",l)}E(!1)}};return e.jsxs("div",{style:{maxWidth:520,margin:"0 auto",padding:12},children:[e.jsx("h2",{style:{textAlign:"center",marginBottom:16},children:"PDF Info"}),e.jsx("p",{children:"Upload a PDF to view basic information (page count, metadata)."}),d&&e.jsx("div",{ref:W,tabIndex:-1,"aria-live":"assertive",style:{color:"#dc2626",marginBottom:8,background:"#fee2e2",padding:8,borderRadius:6,outline:"none"},children:d}),v&&e.jsx("div",{ref:T,tabIndex:-1,"aria-live":"polite",style:{color:"#059669",marginBottom:8,background:"#d1fae5",padding:8,borderRadius:6,outline:"none"},children:v}),a&&e.jsxs("div",{style:{marginBottom:8,display:"flex",alignItems:"center",gap:8},children:[e.jsx("span",{className:"loader",style:{display:"inline-block",width:24,height:24,border:"3px solid #3b82f6",borderTop:"3px solid #fff",borderRadius:"50%",animation:"spin 1s linear infinite",verticalAlign:"middle"}})," ",e.jsx("span",{children:"Memproses, mohon tunggu..."})]}),e.jsx("input",{type:"file",accept:"application/pdf",onChange:x,disabled:a}),t&&e.jsx("div",{className:"file-list",style:{margin:"16px 0"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,background:"#f9fafb",borderRadius:8,marginBottom:8,padding:8,opacity:a?.7:1},children:[e.jsx("div",{style:{minWidth:120,maxWidth:180,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontWeight:500},children:t.name}),e.jsxs("div",{style:{color:"#888",fontSize:13},children:[(t.size/1024).toFixed(1)," KB"]}),e.jsx("button",{className:"btn",onClick:()=>{w(null),y(null),S(""),D("")},disabled:a,children:"Remove"})]})}),s&&e.jsx("div",{style:{marginTop:16,background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:12,padding:16},children:s.error?e.jsx("div",{style:{color:"#dc2626",fontWeight:500},children:s.error}):e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[e.jsx("h3",{style:{margin:0,fontSize:18,fontWeight:600,color:"#1f2937",borderBottom:"2px solid #e5e7eb",paddingBottom:8},children:"📄 PDF Information"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"140px 1fr",gap:8,fontSize:14},children:[e.jsx("div",{style:{fontWeight:600,color:"#6b7280"},children:"File Name:"}),e.jsx("div",{style:{color:"#1f2937",wordBreak:"break-word"},children:s.fileName}),e.jsx("div",{style:{fontWeight:600,color:"#6b7280"},children:"File Size:"}),e.jsxs("div",{style:{color:"#1f2937"},children:[(s.fileSize/1024).toFixed(2)," KB (",(s.fileSize/(1024*1024)).toFixed(2)," MB)"]}),e.jsx("div",{style:{fontWeight:600,color:"#6b7280"},children:"Total Pages:"}),e.jsx("div",{style:{color:"#1f2937",fontWeight:600},children:s.pages}),e.jsx("div",{style:{fontWeight:600,color:"#6b7280",paddingTop:8,borderTop:"1px solid #e5e7eb"},children:"Title:"}),e.jsx("div",{style:{color:"#1f2937",paddingTop:8,borderTop:"1px solid #e5e7eb"},children:s.title}),e.jsx("div",{style:{fontWeight:600,color:"#6b7280"},children:"Author:"}),e.jsx("div",{style:{color:"#1f2937"},children:s.author}),e.jsx("div",{style:{fontWeight:600,color:"#6b7280"},children:"Subject:"}),e.jsx("div",{style:{color:"#1f2937"},children:s.subject}),e.jsx("div",{style:{fontWeight:600,color:"#6b7280"},children:"Creator:"}),e.jsx("div",{style:{color:"#1f2937"},children:s.creator}),e.jsx("div",{style:{fontWeight:600,color:"#6b7280"},children:"Producer:"}),e.jsx("div",{style:{color:"#1f2937"},children:s.producer}),e.jsx("div",{style:{fontWeight:600,color:"#6b7280",paddingTop:8,borderTop:"1px solid #e5e7eb"},children:"Created:"}),e.jsx("div",{style:{color:"#1f2937",paddingTop:8,borderTop:"1px solid #e5e7eb",fontSize:13},children:s.creationDate==="Unknown"?"Unknown":new Date(s.creationDate).toLocaleString("id-ID")}),e.jsx("div",{style:{fontWeight:600,color:"#6b7280"},children:"Modified:"}),e.jsx("div",{style:{color:"#1f2937",fontSize:13},children:s.modificationDate==="Unknown"?"Unknown":new Date(s.modificationDate).toLocaleString("id-ID")})]})]})}),e.jsx("div",{style:{marginTop:12,display:"flex",gap:8,flexWrap:"wrap"},children:e.jsx("button",{className:"btn-ghost",style:{color:"#dc2626",marginLeft:"auto"},onClick:()=>{w(null),y(null),S(""),D("")},disabled:a||!t,children:"Reset"})})]})}function ft(){const[t,w]=n.useState(!0),[s,y]=n.useState([]),[a,E]=n.useState(!1),[d,S]=n.useState(""),[v,D]=n.useState(""),[W,T]=n.useState("extracted-images"),x=React.useRef(null),N=React.useRef(null);React.useEffect(()=>{d&&x.current&&x.current.focus()},[d]),React.useEffect(()=>{v&&N.current&&N.current.focus()},[v]);const j=f=>{S(""),D(""),y(Array.from(f.target.files||[]))},k=async()=>{if(!s.length){S("Pilih file PDF terlebih dahulu.");return}S(""),D(""),E(!0);try{const{PDFDocument:f}=await de(async()=>{const{PDFDocument:i}=await import("./vendor_pdf_lib-CHoXx7fs.js");return{PDFDocument:i}},__vite__mapDeps([5,1,0])),u=(await de(async()=>{const{default:i}=await import("./vendor_jszip-B1Nm6Iki.js").then(r=>r.j);return{default:i}},__vite__mapDeps([0,1]))).default,p=new u;for(const i of s)try{const r=await i.arrayBuffer(),c=await(await f.load(r)).save();p.file(i.name.replace(/\.pdf$/i,"")+"-original.pdf",c)}catch(r){S("Gagal ekstrak gambar dari "+i.name),console.error("Error extracting images",r)}const g=await p.generateAsync({type:"blob"}),B=URL.createObjectURL(g),m=document.createElement("a");m.href=B,m.download=ie(W,"extracted-images",".zip"),document.body.appendChild(m),m.click(),m.remove(),URL.revokeObjectURL(B),D("Berhasil! File ZIP berhasil diunduh.")}catch(f){S("Gagal: "+(f.message||f)),console.error(f)}finally{E(!1)}};async function l(f,u){try{u(10);const p=await de(()=>import("./vendor_pdfjs-zbSBfwBn.js").then(c=>c.p),__vite__mapDeps([6,1,0]));try{p.GlobalWorkerOptions.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${p.version}/pdf.worker.min.js`}catch{}u(20);const g=await f.arrayBuffer(),m=await p.getDocument({data:g}).promise;u(40);const i=(await de(async()=>{const{default:c}=await import("./vendor_jszip-B1Nm6Iki.js").then(b=>b.j);return{default:c}},__vite__mapDeps([0,1]))).default,r=new i;for(let c=1;c<=m.numPages;c++){const b=await m.getPage(c),R=await b.getOperatorList();let C=0;for(let L=0;L<R.fnArray.length;L++)if(R.fnArray[L]===p.OPS.paintImageXObject||R.fnArray[L]===p.OPS.paintJpegXObject)try{const I=R.argsArray[L][0],z=b.objs.get(I);if(z&&z.data){const A=document.createElement("canvas");A.width=z.width,A.height=z.height;const q=A.getContext("2d"),_=new ImageData(new Uint8ClampedArray(z.data),z.width,z.height);q.putImageData(_,0,0);const F=await new Promise(h=>A.toBlob(h,"image/png"));r.file(`page${c}_img${C}.png`,F),C++}}catch(I){console.warn("Failed to extract image:",I)}u(40+c/m.numPages*50)}u(90),Object.keys(r.files).length===0&&r.file("no-images-found.txt",`No images were found in ${f.name}`);const o=await r.generateAsync({type:"blob"});return u(100),o}catch(p){throw new Error(`Failed to extract images: ${p.message||p}`)}}return e.jsxs("div",{style:{maxWidth:520,margin:"0 auto",padding:12},children:[e.jsx("h2",{style:{textAlign:"center",marginBottom:16},children:"Extract Images"}),e.jsx("p",{children:"Upload PDFs and extract images."}),e.jsxs("div",{style:{display:"flex",gap:8,marginBottom:16,borderBottom:"2px solid var(--border)",paddingBottom:8},children:[e.jsx("button",{onClick:()=>w(!1),disabled:a,style:{padding:"8px 16px",backgroundColor:t?"transparent":"var(--primary)",color:t?"var(--text)":"white",border:t?"1px solid var(--border)":"none",borderRadius:4,cursor:"pointer",fontWeight:t?"normal":"bold"},children:"📄 Single File"}),e.jsx("button",{onClick:()=>w(!0),disabled:a,style:{padding:"8px 16px",backgroundColor:t?"var(--primary)":"transparent",color:t?"white":"var(--text)",border:t?"none":"1px solid var(--border)",borderRadius:4,cursor:"pointer",fontWeight:t?"bold":"normal"},children:"📚 Batch Process"})]}),d&&e.jsx("div",{ref:x,tabIndex:-1,"aria-live":"assertive",style:{color:"#dc2626",marginBottom:8,background:"#fee2e2",padding:8,borderRadius:6,outline:"none"},children:d}),v&&e.jsx("div",{ref:N,tabIndex:-1,"aria-live":"polite",style:{color:"#059669",marginBottom:8,background:"#d1fae5",padding:8,borderRadius:6,outline:"none"},children:v}),t?e.jsxs("div",{children:[e.jsx("p",{style:{marginBottom:16,padding:12,background:"var(--paper)",border:"1px solid var(--border)",borderRadius:4},children:"In batch mode, each PDF's extracted images will be saved as a separate ZIP file. Images are extracted from all pages."}),e.jsx(ue,{processFile:l,outputFilenameSuffix:"_images",acceptedFileTypes:"application/pdf",description:"Extract images from multiple PDFs",outputFileExtension:".zip"})]}):e.jsxs("div",{children:[a&&e.jsxs("div",{style:{marginBottom:8,display:"flex",alignItems:"center",gap:8},children:[e.jsx("span",{className:"loader",style:{display:"inline-block",width:24,height:24,border:"3b82f6",borderTop:"3px solid #fff",borderRadius:"50%",animation:"spin 1s linear infinite",verticalAlign:"middle"}})," ",e.jsx("span",{children:"Memproses, mohon tunggu..."})]}),e.jsx("input",{type:"file",accept:"application/pdf",multiple:!0,onChange:j,disabled:a}),e.jsx("div",{className:"file-list",style:{margin:"16px 0"},children:s.map((f,u)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,background:"#f9fafb",borderRadius:8,marginBottom:8,padding:8,opacity:a?.7:1},children:[e.jsx("div",{style:{minWidth:120,maxWidth:180,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",fontWeight:500},children:f.name}),e.jsxs("div",{style:{color:"#888",fontSize:13},children:[(f.size/1024).toFixed(1)," KB"]}),e.jsx("button",{className:"btn",onClick:()=>y(p=>p.filter((g,B)=>B!==u)),disabled:a,children:"Remove"})]},u))}),s.length>0&&e.jsx(ce,{value:W,onChange:f=>T(f.target.value),disabled:a,placeholder:"extracted-images"}),e.jsxs("div",{style:{marginTop:12,display:"flex",gap:8,flexWrap:"wrap"},children:[e.jsx("button",{className:"btn-primary",onClick:k,disabled:a||s.length===0,children:a?"Working...":"Extract & Download"}),e.jsx("button",{className:"btn-ghost",style:{color:"#dc2626",marginLeft:"auto"},onClick:()=>{y([]),S(""),D("")},disabled:a||s.length===0,children:"Reset"})]})]})]})}function gt(){const[t,w]=n.useState(!1),[s,y]=n.useState(null),[a,E]=n.useState(!1),[d,S]=n.useState(!1),[v,D]=n.useState(!1),[W,T]=n.useState(""),[x,N]=n.useState(""),[j,k]=n.useState("");async function l(r){const o=r.target.files[0];if(o){if(T(""),N(""),!o.name.endsWith(".docx")){T("Please select a .docx file.");return}if(o.size>20*1024*1024){T("File too large (max 20MB).");return}y(o),k(pe(o)),N('Document loaded! Click "Convert to PDF" to proceed.')}}function f(r){r.preventDefault(),S(!0)}function u(r){r.preventDefault(),r.dataTransfer.dropEffect="copy"}function p(r){r.preventDefault(),S(!1)}async function g(r){var c,b;r.preventDefault(),S(!1);const o=(b=(c=r.dataTransfer)==null?void 0:c.files)==null?void 0:b[0];o&&(y(o),D(!0),setTimeout(()=>D(!1),1500))}async function B(){if(!s){T("Please select a Word document first.");return}T(""),N(""),E(!0);try{const r=await s.arrayBuffer(),c=(await Ee.convertToHtml({arrayBuffer:r})).value,b=document.createElement("div");b.innerHTML=c,b.style.padding="20px",document.body.appendChild(b);const C=(await ke(b,{scale:2})).toDataURL("image/png"),{jsPDF:L}=await de(async()=>{const{jsPDF:_}=await import("./vendor_jspdf-DlgZQKHI.js").then(F=>F.j);return{jsPDF:_}},__vite__mapDeps([2,1,0])),I=new L("p","mm","a4"),z=I.getImageProperties(C),A=210,q=z.height*A/z.width;I.addImage(C,"PNG",0,0,A,q),I.save(ie(j,s.name.replace(/\.docx$/i,""))),document.body.removeChild(b),N("Successfully converted Word document to PDF and downloaded!")}catch(r){console.error(r),T("Conversion failed: "+r.message)}finally{E(!1)}}async function m(r,o){try{o(10);const c=await r.arrayBuffer();o(30);const R=(await Ee.convertToHtml({arrayBuffer:c})).value;o(50);const C=document.createElement("div");C.innerHTML=R,C.style.padding="20px",C.style.position="absolute",C.style.left="-9999px",document.body.appendChild(C),o(60);const I=(await ke(C,{scale:2})).toDataURL("image/png");o(70);const{jsPDF:z}=await de(async()=>{const{jsPDF:P}=await import("./vendor_jspdf-DlgZQKHI.js").then(M=>M.j);return{jsPDF:P}},__vite__mapDeps([2,1,0])),A=new z("p","mm","a4"),q=A.getImageProperties(I),_=210,F=q.height*_/q.width;A.addImage(I,"PNG",0,0,_,F),o(90);const h=A.output("blob");return document.body.removeChild(C),o(100),h}catch(c){throw new Error(`Failed to convert Word to PDF: ${c.message||c}`)}}function i(){y(null),T(""),N(""),w(!1)}return e.jsxs("div",{children:[e.jsx("h2",{children:"Word (.docx) → PDF"}),e.jsx("p",{className:"muted",children:"Convert Microsoft Word documents to PDF format."}),e.jsxs("div",{style:{display:"flex",gap:8,marginBottom:16,borderBottom:"2px solid var(--border)",paddingBottom:8},children:[e.jsx("button",{onClick:()=>w(!1),disabled:a,style:{padding:"8px 16px",backgroundColor:t?"transparent":"var(--primary)",color:t?"var(--text)":"white",border:t?"1px solid var(--border)":"none",borderRadius:4,cursor:"pointer",fontWeight:t?"normal":"bold"},children:"📄 Single File"}),e.jsx("button",{onClick:()=>w(!0),disabled:a,style:{padding:"8px 16px",backgroundColor:t?"var(--primary)":"transparent",color:t?"white":"var(--text)",border:t?"none":"1px solid var(--border)",borderRadius:4,cursor:"pointer",fontWeight:t?"bold":"normal"},children:"📚 Batch Process"})]}),W&&e.jsxs("div",{className:"error-message",role:"alert",children:["⚠️ ",W]}),x&&e.jsxs("div",{className:"success-message",role:"status",children:["✅ ",x]}),t?e.jsxs("div",{children:[e.jsxs("p",{style:{marginBottom:16,padding:12,background:"var(--paper)",border:"1px solid var(--border)",borderRadius:4},children:[e.jsx("strong",{children:"Batch Mode:"})," Convert multiple Word (.docx) documents to PDF format simultaneously."]}),e.jsx(ue,{processFile:m,outputFilenameSuffix:"",acceptedFileTypes:".docx,application/vnd.openxmlformats-officedocument.wordprocessingml.document",description:"Convert multiple Word documents to PDF",outputFileExtension:".pdf"})]}):e.jsxs("div",{children:[e.jsxs("div",{className:`dropzone ${d?"dragover":""}`,onDragEnter:f,onDragOver:u,onDragLeave:p,onDrop:g,children:[e.jsx("input",{type:"file",accept:".docx,application/vnd.openxmlformats-officedocument.wordprocessingml.document",onChange:l,disabled:a}),e.jsx("div",{className:"muted",children:"Select or drag & drop a .docx file (max 20MB)."}),v&&e.jsx("div",{className:"drop-overlay",children:"✓ Uploaded"})]}),s&&e.jsxs("div",{className:"file-info",children:[e.jsx("strong",{children:"📄 File:"})," ",s.name," (",(s.size/1024).toFixed(1)," KB)"]}),s&&e.jsx(ce,{value:j,onChange:r=>k(r.target.value),disabled:a,placeholder:"output"}),e.jsxs("div",{style:{marginTop:12,display:"flex",gap:12},children:[e.jsx("button",{className:"btn-primary",onClick:B,disabled:a||!s,children:a?"⏳ Converting...":"📥 Convert to PDF"}),e.jsx("button",{className:"btn-ghost",style:{color:"#dc2626"},onClick:i,disabled:a,children:"Reset"})]})]})]})}const mt={pdf2text:$e,pdf2word:Ge,merge:He,split:Ve,imgs2pdf:qe,pdf2imgs:Ze,annotate:Ke,compress:Xe,edit:Ye,ocr:Qe,pagenums:et,pdf2ppt:tt,ppt2pdf:st,csv2pdf:Je,reorder:nt,rotate:rt,signature:it,watermark:lt,"batch-watermark":ut,"pdf-info":pt,"extract-images":ft,word2pdf:gt};function ht({toolId:t,onClose:w}){const[s,y]=n.useState(!1);n.useEffect(()=>{y(!0);const E=d=>{d.key==="Escape"&&w()};return window.addEventListener("keydown",E),()=>window.removeEventListener("keydown",E)},[]);const a=mt[t];return a?e.jsxs("div",{className:`tool-container ${s?"mounted":""}`,children:[e.jsxs("div",{className:"tool-header",children:[e.jsx("button",{onClick:w,className:"close-btn",children:"×"}),e.jsx("h1",{children:t})]}),e.jsx("div",{className:"tool-content",children:e.jsx(a,{})})]}):e.jsxs("div",{className:"tool-container",children:[e.jsxs("div",{className:"tool-header",children:[e.jsx("button",{onClick:w,className:"close-btn",children:"×"}),e.jsx("h1",{children:"Tool Not Found"})]}),e.jsx("div",{className:"tool-content",children:e.jsxs("p",{children:['The requested tool "',t,'" is not available.']})})]})}function xt({image:t,href:w,alt:s="Advertisement",children:y}){const a=t?e.jsx("img",{className:"ad-spot-img",src:t,alt:s}):e.jsx("div",{className:"ad-spot-fallback",children:y||"Your ad here"});return e.jsx("div",{className:"ad-spot",role:"region","aria-label":"Advertisement",children:w?e.jsx("a",{href:w,target:"_blank",rel:"noopener noreferrer",children:a}):a})}const Fe="dexpdf:recent",bt=8;function Ce(){try{const t=localStorage.getItem(Fe);return t?JSON.parse(t):[]}catch(t){return console.error("Failed to read recent files",t),[]}}function yt(t){try{if(!t||!t.id)return;const s=Ce().filter(a=>a.id!==t.id);s.unshift({...t,time:Date.now()});const y=s.slice(0,bt);return localStorage.setItem(Fe,JSON.stringify(y)),y}catch(w){return console.error("Failed to push recent",w),[]}}function vt(){try{localStorage.removeItem(Fe)}catch(t){console.error("Failed to clear recent",t)}}function wt({onOpen:t}){const[w,s]=n.useState([]);return n.useEffect(()=>{s(Ce());const y=()=>s(Ce());return window.addEventListener("storage",y),()=>window.removeEventListener("storage",y)},[]),!w||w.length===0?null:e.jsxs("div",{className:"recent-files","aria-live":"polite",children:[e.jsxs("div",{className:"recent-header",children:[e.jsx("strong",{children:"Recent"}),e.jsx("button",{className:"recent-clear",onClick:()=>{vt(),s([])},children:"Clear"})]}),e.jsx("ul",{children:w.map(y=>e.jsx("li",{children:e.jsxs("button",{className:"recent-item",onClick:()=>t(y),children:[e.jsx("span",{className:"recent-name",children:y.name||y.id}),e.jsx("span",{className:"recent-time",children:new Date(y.time).toLocaleString()})]})},y.id))})]})}function jt(){const[t,w]=n.useState(!1),[s,y]=n.useState("idle"),[a,E]=n.useState(""),d=n.useRef(void 0);return n.useEffect(()=>()=>{d.current&&clearTimeout(d.current)},[]),n.useEffect(()=>{const S=v=>{const D=v.detail||{};if(D&&typeof D=="object"){if(D.end){y("success"),E(D.message||"Done"),d.current=setTimeout(()=>y("idle"),1e3);return}w(!0),y("progress"),D.message&&E(D.message)}};return window.addEventListener("pdf-progress",S),()=>window.removeEventListener("pdf-progress",S)},[]),s==="idle"?null:e.jsx(we,{sx:{position:"fixed",top:8,left:0,right:0,display:"flex",justifyContent:"center",zIndex:1400},children:e.jsxs(we,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsx(we,{sx:{height:40},children:e.jsx(Te,{in:t,style:{transitionDelay:t?"200ms":"0ms"},unmountOnExit:!0,children:e.jsx(ze,{})})}),e.jsx(we,{sx:{mt:.5},children:s==="success"?e.jsx(Me,{variant:"caption",children:a||"Success"}):e.jsx(Te,{in:s==="progress",style:{transitionDelay:s==="progress"?"200ms":"0ms"},unmountOnExit:!0,children:e.jsx(Me,{variant:"caption",children:a||"Working..."})})})]})})}function kt(){return null}function St(){return e.jsx("footer",{style:{borderTop:"1px solid var(--border)",background:"var(--card)",padding:18,marginTop:24},children:e.jsx("div",{style:{maxWidth:1100,margin:"0 auto",color:"var(--muted)"},children:e.jsxs("small",{children:["© ",new Date().getFullYear()," DEXPDF lightweight client-side PDF tools"]})})})}const Ie="dexpdf:theme";function Pt({className:t}){const[w,s]=n.useState(()=>{try{return localStorage.getItem(Ie)||"light"}catch{return"light"}});return n.useEffect(()=>{try{localStorage.setItem(Ie,w)}catch{}w==="dark"?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},[w]),e.jsx("button",{"aria-label":"Toggle theme",className:`theme-toggle ${t||""}`,onClick:()=>s(w==="dark"?"light":"dark"),style:{padding:"6px 10px",borderRadius:8,border:"1px solid var(--border)",background:"transparent"},children:w==="dark"?"🌙 Dark":"☀️ Light"})}function Nt(){const t=[{icon:"🔒",title:"Privacy First",description:"All processing happens in your browser. Your files never leave your device."},{icon:"⚡",title:"Lightning Fast",description:"Modern algorithms ensure quick processing, even for large PDFs."},{icon:"🆓",title:"100% Free",description:"All tools are completely free with no hidden charges or subscriptions."},{icon:"📱",title:"Works Everywhere",description:"Use on any device - desktop, tablet, or mobile. No installation needed."},{icon:"🎨",title:"Easy to Use",description:"Simple, intuitive interface that anyone can use without training."},{icon:"🔄",title:"Always Updated",description:"Regular updates with new features and improvements based on user feedback."}];return e.jsx("section",{className:"features-section",children:e.jsxs("div",{className:"features-container",children:[e.jsxs("div",{className:"features-header",children:[e.jsx("h2",{className:"features-title",children:"Why Choose DexPDF?"}),e.jsx("p",{className:"features-subtitle",children:"Everything you need for PDF management, right in your browser"})]}),e.jsx("div",{className:"features-grid",children:t.map((w,s)=>e.jsxs("div",{className:"feature-card",children:[e.jsx("div",{className:"feature-icon",children:w.icon}),e.jsx("h3",{className:"feature-title",children:w.title}),e.jsx("p",{className:"feature-description",children:w.description})]},s))})]})})}function Ct(){const[t,w]=n.useState(null),s=[{question:"Is DexPDF really free?",answer:"Yes! All tools are 100% free with no hidden charges, subscriptions, or file limits."},{question:"Are my files safe?",answer:"Absolutely. All processing happens in your browser. Your files never leave your device or get uploaded to any server."},{question:"What file formats are supported?",answer:"We support PDF, images (JPG, PNG), Word documents (DOCX), PowerPoint (PPTX), and more formats are added regularly."},{question:"Is there a file size limit?",answer:"No strict limits! However, very large files (100MB+) may take longer to process depending on your device."},{question:"Do I need to create an account?",answer:"No account needed! Just visit the site and start using any tool immediately."},{question:"Can I use DexPDF on mobile?",answer:"Yes! DexPDF works on all modern browsers - desktop, tablet, and mobile devices."}];return e.jsx("section",{className:"faq-section",children:e.jsxs("div",{className:"faq-container",children:[e.jsxs("div",{className:"faq-header",children:[e.jsx("h2",{className:"faq-title",children:"Frequently Asked Questions"}),e.jsx("p",{className:"faq-subtitle",children:"Everything you need to know about DexPDF"})]}),e.jsx("div",{className:"faq-list",children:s.map((y,a)=>e.jsxs("div",{className:"faq-item",children:[e.jsxs("button",{className:`faq-question ${t===a?"active":""}`,onClick:()=>w(t===a?null:a),children:[e.jsx("span",{children:y.question}),e.jsx("svg",{className:`faq-icon ${t===a?"rotate":""}`,width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M5 7.5L10 12.5L15 7.5",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})]}),t===a&&e.jsx("div",{className:"faq-answer",children:y.answer})]},a))})]})})}const _e="dexpdf:ad_consent";function Oe(){try{const t=localStorage.getItem(_e);return t?JSON.parse(t):null}catch(t){return console.error("Failed to read consent",t),null}}function Ft(t){try{localStorage.setItem(_e,JSON.stringify(!!t))}catch(w){console.error("Failed to set consent",w)}}function Dt({onChange:t}){const w=y=>{Ft(y),t&&t(y)};return Oe()!==null?null:e.jsx("div",{className:"consent-banner",role:"dialog","aria-live":"polite",children:e.jsxs("div",{className:"consent-inner",children:[e.jsx("div",{className:"consent-text",children:'We use ads to support this site. By clicking "Accept" you agree to show non-intrusive ads. You can decline to hide ads.'}),e.jsxs("div",{className:"consent-actions",children:[e.jsx("button",{className:"consent-decline",onClick:()=>w(!1),children:"Decline"}),e.jsx("button",{className:"consent-accept",onClick:()=>w(!0),children:"Accept"})]})]})})}function Bt({tools:t,onSelect:w,onClose:s,isOpen:y}){const[a,E]=n.useState(""),[d,S]=n.useState(0),v=n.useRef(null),D=n.useRef(null),W=t.filter(l=>{var B,m;const f=a.toLowerCase().trim();if(!f)return!0;const u=(B=l.name)==null?void 0:B.toLowerCase().includes(f),p=(m=l.desc)==null?void 0:m.toLowerCase().includes(f),g=Array.isArray(l.tags)&&l.tags.join(" ").toLowerCase().includes(f);return u||p||g}),T=JSON.parse(localStorage.getItem("recent-tools")||"[]"),x=t.filter(l=>T.includes(l.id)),N=a.trim()?W:[...x,...W],j=Array.from(new Map(N.map(l=>[l.id,l])).values()).slice(0,8);n.useEffect(()=>{y&&v.current&&(v.current.focus(),E(""),S(0))},[y]),n.useEffect(()=>{S(0)},[a]),n.useEffect(()=>{if(!y)return;const l=f=>{f.key==="ArrowDown"?(f.preventDefault(),S(u=>Math.min(u+1,j.length-1))):f.key==="ArrowUp"?(f.preventDefault(),S(u=>Math.max(u-1,0))):f.key==="Enter"?(f.preventDefault(),j[d]&&k(j[d])):f.key==="Escape"&&(f.preventDefault(),s())};return window.addEventListener("keydown",l),()=>window.removeEventListener("keydown",l)},[y,d,j]),n.useEffect(()=>{if(D.current){const l=D.current.children[d];l&&l.scrollIntoView({block:"nearest",behavior:"smooth"})}},[d]);const k=l=>{const f=JSON.parse(localStorage.getItem("recent-tools")||"[]"),u=[l.id,...f.filter(p=>p!==l.id)].slice(0,5);localStorage.setItem("recent-tools",JSON.stringify(u)),w(l),s()};return y?e.jsx("div",{className:"command-palette-overlay",onClick:s,children:e.jsxs("div",{className:"command-palette",onClick:l=>l.stopPropagation(),children:[e.jsxs("div",{className:"command-palette-header",children:[e.jsx("svg",{className:"command-palette-icon",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",children:e.jsx("path",{d:"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16zM19 19l-4.35-4.35",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),e.jsx("input",{ref:v,type:"text",className:"command-palette-input",placeholder:"Search tools... (try 'merge', 'compress', 'split')",value:a,onChange:l=>E(l.target.value)}),e.jsx("kbd",{className:"command-palette-kbd",children:"ESC"})]}),e.jsx("div",{className:"command-palette-body",ref:D,children:j.length===0?e.jsxs("div",{className:"command-palette-empty",children:[e.jsxs("svg",{width:"48",height:"48",viewBox:"0 0 48 48",fill:"none",children:[e.jsx("circle",{cx:"24",cy:"24",r:"22",stroke:"currentColor",strokeWidth:"2",opacity:"0.3"}),e.jsx("path",{d:"M24 14v12M24 32h.01",stroke:"currentColor",strokeWidth:"3",strokeLinecap:"round",opacity:"0.5"})]}),e.jsxs("p",{children:['No tools found for "',a,'"']}),e.jsx("p",{className:"command-palette-hint",children:"Try searching for merge, split, compress, or convert"})]}):e.jsxs(e.Fragment,{children:[!a.trim()&&x.length>0&&e.jsx("div",{className:"command-palette-section",children:"Recent"}),j.map((l,f)=>{const u=T.includes(l.id),g={merge:"#DC2626",split:"#2563EB",compress:"#059669","pdf-to-word":"#7C3AED","pdf-to-text":"#EA580C","images-to-pdf":"#DB2777",watermark:"#0891B2","extract-images":"#CA8A04","ppt-to-pdf":"#DC2626","pdf-info":"#4F46E5",reorder:"#16A34A"}[l.id]||"#6B7280";return e.jsxs("div",{className:`command-palette-item ${d===f?"selected":""}`,onClick:()=>k(l),onMouseEnter:()=>S(f),children:[e.jsx("div",{className:"command-palette-item-icon",style:{background:g},children:e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",children:[e.jsx("rect",{x:"5",y:"3",width:"10",height:"14",rx:"1",stroke:"white",strokeWidth:"1.5"}),e.jsx("path",{d:"M7 7h6M7 10h6M7 13h4",stroke:"white",strokeWidth:"1.5",strokeLinecap:"round"})]})}),e.jsxs("div",{className:"command-palette-item-content",children:[e.jsxs("div",{className:"command-palette-item-name",children:[l.name,u&&e.jsx("span",{className:"command-palette-badge",children:"Recent"})]}),e.jsx("div",{className:"command-palette-item-desc",children:l.desc})]}),d===f&&e.jsx("kbd",{className:"command-palette-kbd-enter",children:"↵"})]},l.id)})]})}),e.jsx("div",{className:"command-palette-footer",children:e.jsxs("div",{className:"command-palette-shortcuts",children:[e.jsxs("span",{children:[e.jsx("kbd",{children:"↑"}),e.jsx("kbd",{children:"↓"})," Navigate"]}),e.jsxs("span",{children:[e.jsx("kbd",{children:"↵"})," Select"]}),e.jsxs("span",{children:[e.jsx("kbd",{children:"ESC"})," Close"]})]})})]})}):null}function Rt({isOpen:t,onClose:w}){const[s,y]=n.useState("mac");n.useEffect(()=>{const d=navigator.platform.toUpperCase().indexOf("MAC")>=0;y(d?"mac":"windows")},[]);const a=s==="mac"?"⌘":"Ctrl",E=[{category:"Navigation",items:[{key:"/",description:"Focus search",icon:"🔍"},{key:`${a} + K`,description:"Open command palette",icon:"⚡"},{key:"?",description:"Show keyboard shortcuts",icon:"⌨️"},{key:"Esc",description:"Close tool or dialog",icon:"✕"}]},{category:"File Operations",items:[{key:`${a} + O`,description:"Open file",icon:"📂"},{key:`${a} + S`,description:"Download result",icon:"💾"},{key:`${a} + Z`,description:"Undo (coming soon)",icon:"↶",disabled:!0},{key:`${a} + Y`,description:"Redo (coming soon)",icon:"↷",disabled:!0}]},{category:"Tools",items:[{key:"M",description:"Merge PDFs",icon:"🔗"},{key:"S",description:"Split PDF",icon:"✂️"},{key:"C",description:"Compress PDF",icon:"🗜️"},{key:"W",description:"Add Watermark",icon:"🏷️"}]},{category:"View",items:[{key:`${a} + D`,description:"Toggle dark mode",icon:"🌙"},{key:`${a} + +`,description:"Zoom in (coming soon)",icon:"🔍",disabled:!0},{key:`${a} + -`,description:"Zoom out (coming soon)",icon:"🔍",disabled:!0}]}];return n.useEffect(()=>{if(!t)return;const d=S=>{(S.key==="Escape"||S.key==="?")&&(S.preventDefault(),w())};return window.addEventListener("keydown",d),()=>window.removeEventListener("keydown",d)},[t,w]),t?e.jsx("div",{className:"shortcuts-overlay",onClick:w,children:e.jsxs("div",{className:"shortcuts-panel",onClick:d=>d.stopPropagation(),children:[e.jsxs("div",{className:"shortcuts-header",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"shortcuts-title",children:"⌨️ Keyboard Shortcuts"}),e.jsx("p",{className:"shortcuts-subtitle",children:"Boost your productivity with these shortcuts"})]}),e.jsx("button",{className:"shortcuts-close",onClick:w,"aria-label":"Close",children:e.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",children:e.jsx("path",{d:"M18 6L6 18M6 6l12 12",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})})})]}),e.jsx("div",{className:"shortcuts-body",children:E.map((d,S)=>e.jsxs("div",{className:"shortcuts-section",children:[e.jsx("h3",{className:"shortcuts-section-title",children:d.category}),e.jsx("div",{className:"shortcuts-list",children:d.items.map((v,D)=>e.jsxs("div",{className:`shortcuts-item ${v.disabled?"disabled":""}`,children:[e.jsxs("div",{className:"shortcuts-item-left",children:[e.jsx("span",{className:"shortcuts-icon",children:v.icon}),e.jsx("span",{className:"shortcuts-description",children:v.description}),v.disabled&&e.jsx("span",{className:"shortcuts-badge",children:"Soon"})]}),e.jsx("kbd",{className:"shortcuts-kbd",children:v.key})]},D))})]},S))}),e.jsxs("div",{className:"shortcuts-footer",children:[e.jsxs("div",{className:"shortcuts-tip",children:[e.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",children:[e.jsx("circle",{cx:"8",cy:"8",r:"7",stroke:"currentColor",strokeWidth:"1.5"}),e.jsx("path",{d:"M8 7v4M8 5h.01",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})]}),e.jsxs("span",{children:["Press ",e.jsx("kbd",{children:"?"})," anytime to toggle this panel"]})]}),e.jsxs("div",{className:"shortcuts-platform",children:["Platform: ",s==="mac"?"macOS":"Windows"]})]})]})}):null}function Et(){const[t,w]=n.useState([]),[s,y]=n.useState(null),[a,E]=n.useState(""),[d,S]=n.useState(()=>Oe()),v=n.useRef(null),[D,W]=n.useState(!1),[T,x]=n.useState(!1),[N,j]=n.useState(!1);n.useEffect(()=>{const l=f=>{y(f.detail);try{const u=f.detail,p=t.find(g=>g.id===u)||{id:u};yt({id:p.id,name:p.name})}catch{}};return window.addEventListener("open-tool",l),()=>window.removeEventListener("open-tool",l)},[]),n.useEffect(()=>{fetch("/tools.json").then(l=>l.json()).then(l=>w(l)).catch(l=>console.error("Error loading tools:",l))},[]),n.useEffect(()=>{const l=f=>{if(f.key==="/"&&!(document.activeElement&&(document.activeElement.tagName==="INPUT"||document.activeElement.tagName==="TEXTAREA"))&&(f.preventDefault(),v.current&&v.current.focus(),W(!0),setTimeout(()=>W(!1),1200)),(f.metaKey||f.ctrlKey)&&f.key==="k"&&(f.preventDefault(),x(!0)),f.key==="?"&&!(document.activeElement&&(document.activeElement.tagName==="INPUT"||document.activeElement.tagName==="TEXTAREA"))&&(f.preventDefault(),j(u=>!u)),(f.metaKey||f.ctrlKey)&&f.key==="d"){f.preventDefault();const u=document.querySelector(".theme-toggle");u&&u.click()}};return window.addEventListener("keydown",l),()=>window.removeEventListener("keydown",l)},[]);const k=n.useMemo(()=>{const l=a.trim().toLowerCase();return l?t.filter(f=>{const u=f.name&&f.name.toLowerCase().includes(l),p=f.desc&&f.desc.toLowerCase().includes(l),g=Array.isArray(f.tags)&&f.tags.join(" ").toLowerCase().includes(l);return u||p||g}):t},[t,a]);return e.jsxs("div",{className:"app",children:[e.jsx(jt,{}),e.jsx(kt,{}),e.jsx(Bt,{tools:t,isOpen:T,onClose:()=>x(!1),onSelect:l=>{x(!1),window.dispatchEvent(new CustomEvent("open-tool",{detail:l}))}}),e.jsx(Rt,{isOpen:N,onClose:()=>j(!1)}),s?e.jsx(ht,{toolId:s,onClose:()=>{y(null),window.history.pushState({},"","/")}}):e.jsxs(e.Fragment,{children:[e.jsxs("header",{className:"hero-header",children:[e.jsx("video",{className:"hero-background-video",autoPlay:!0,loop:!0,muted:!0,playsInline:!0,children:e.jsx("source",{src:"/assets/city-pop-gradient.mp4",type:"video/mp4"})}),e.jsxs("div",{className:"hero-container",children:[e.jsxs("div",{className:"hero-nav",children:[e.jsx("div",{className:"hero-logo",children:e.jsx("svg",{width:"140",height:"48",viewBox:"0 0 140 48",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("text",{x:"0",y:"36",fill:"white",fontFamily:"system-ui,-apple-system,sans-serif",fontSize:"32",fontWeight:"bold",children:"DexPDF"})})}),e.jsxs("div",{className:"hero-actions",children:[e.jsx(Pt,{}),e.jsx("a",{href:"https://github.com/dexpie/dexpdf",target:"_blank",rel:"noopener noreferrer",className:"hero-link",children:"GitHub"})]})]}),e.jsxs("div",{className:"hero-content",children:[e.jsx("h1",{className:"hero-title",children:"Complete PDF Toolkit for Modern Productivity"}),e.jsx("p",{className:"hero-subtitle",children:"DexPDF brings powerful PDF tools directly to your browser. Fast, secure, and completely free merge, split, compress, convert, and edit PDFs without uploading files to any server. Privacy-first processing."}),e.jsxs("div",{className:"hero-search",children:[e.jsxs("div",{className:"search-wrapper",children:[e.jsx("svg",{className:"search-icon",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M9 17A8 8 0 1 0 9 1a8 8 0 0 0 0 16zM19 19l-4.35-4.35",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),e.jsx("input",{"aria-label":"Search PDF tools",className:"hero-search-input",placeholder:"Search PDF tools...",ref:v,value:a,onChange:l=>E(l.target.value),onKeyDown:l=>{l.key==="Escape"&&E("")}}),a&&e.jsx("button",{className:"search-clear",onClick:()=>E(""),"aria-label":"Clear search",children:e.jsx("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M12 4L4 12M4 4l8 8",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})})})]}),D&&e.jsx("div",{className:"hotkey-hint",children:"Press / to search"})]})]})]})]}),e.jsxs("main",{className:"main-content",children:[e.jsxs("div",{className:"tools-container",children:[e.jsx("div",{className:"recent-section",children:e.jsx(wt,{onOpen:l=>{window.dispatchEvent(new CustomEvent("open-tool",{detail:l.id}))}})}),d===!0&&e.jsxs("div",{className:"ads-section",children:[e.jsx("div",{className:"ads-label",children:"Sponsored"}),e.jsx(xt,{image:"/assets/bippy.jpg",href:"https://dexpdf.vercel.app",alt:"Sponsor"})]}),e.jsx(Dt,{onChange:l=>S(l)}),a&&k.length>0&&e.jsx("div",{className:"tools-section-title",children:e.jsxs("h2",{children:["Search Results (",k.length,")"]})}),e.jsx("div",{className:"tools-grid",children:k.length===0?e.jsxs("div",{className:"no-results-card",children:[e.jsxs("svg",{width:"64",height:"64",viewBox:"0 0 64 64",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("circle",{cx:"32",cy:"32",r:"30",stroke:"#e5e7eb",strokeWidth:"2"}),e.jsx("path",{d:"M32 20v16M32 44h.01",stroke:"#9ca3af",strokeWidth:"3",strokeLinecap:"round"})]}),e.jsx("h3",{children:"No tools found"}),e.jsxs("p",{children:['No tools match "',a,'". Try a different search term.']})]}):k.map(l=>{const u={merge:"#DC2626",split:"#2563EB",compress:"#059669","pdf-to-word":"#7C3AED","pdf-to-text":"#EA580C","images-to-pdf":"#DB2777",watermark:"#0891B2","extract-images":"#CA8A04","ppt-to-pdf":"#DC2626","pdf-info":"#4F46E5",reorder:"#16A34A"}[l.id]||"#6B7280";return e.jsxs("a",{href:`/?tool=${l.id}`,className:"tool-card",style:{"--tool-color":u},onClick:p=>{p.preventDefault(),window.dispatchEvent(new CustomEvent("open-tool",{detail:l.id}))},children:[e.jsx("div",{className:"tool-icon",style:{background:u},children:e.jsxs("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("rect",{x:"8",y:"4",width:"16",height:"24",rx:"2",stroke:"white",strokeWidth:"2"}),e.jsx("path",{d:"M12 12h8M12 16h8M12 20h5",stroke:"white",strokeWidth:"2",strokeLinecap:"round"})]})}),e.jsx("h3",{className:"tool-name",children:l.name}),e.jsx("p",{className:"tool-desc",children:l.desc})]},l.id)})})]}),e.jsx(Nt,{}),e.jsx(Ct,{})]})]}),e.jsx(St,{})]})}Ae(document.getElementById("root")).render(e.jsx(Q.StrictMode,{children:e.jsx(Et,{})}));
