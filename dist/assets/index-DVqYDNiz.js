const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/vendor_jspdf-DEKdHaTR.js","assets/vendor-D2DG0S_-.js","assets/vendor_jszip-CrgqbLi1.js","assets/vendor_tesseract-DKQpXUUC.js","assets/vendor_pptxgenjs-C9ORqrRV.js","assets/vendor_pdf_lib-CLohTL0Y.js"])))=>i.map(i=>d[i]);
import{r as i,j as e,P as ve,F as je,k as be,l as Pe,m as De,B as re,n as de,C as Se,T as ue,o as Ce,R as ke}from"./vendor-D2DG0S_-.js";import{p as B}from"./vendor_pdfjs-CTuMMue6.js";import{PDFDocument as Z,StandardFonts as me,rgb as ne}from"./vendor_pdf_lib-CLohTL0Y.js";import{_ as K,E as he}from"./vendor_jspdf-DEKdHaTR.js";import{J as ie}from"./vendor_jszip-CrgqbLi1.js";import{P as fe}from"./vendor_papaparse-B_IWH9Ah.js";import xe from"./vendor_html2canvas-CBrSDip1.js";(function(){const m=document.createElement("link").relList;if(m&&m.supports&&m.supports("modulepreload"))return;for(const p of document.querySelectorAll('link[rel="modulepreload"]'))f(p);new MutationObserver(p=>{for(const x of p)if(x.type==="childList")for(const v of x.addedNodes)v.tagName==="LINK"&&v.rel==="modulepreload"&&f(v)}).observe(document,{childList:!0,subtree:!0});function l(p){const x={};return p.integrity&&(x.integrity=p.integrity),p.referrerPolicy&&(x.referrerPolicy=p.referrerPolicy),p.crossOrigin==="use-credentials"?x.credentials="include":p.crossOrigin==="anonymous"?x.credentials="omit":x.credentials="same-origin",x}function f(p){if(p.ep)return;p.ep=!0;const x=l(p);fetch(p.href,x)}})();window.addEventListener("open-tool",s=>{const m=s.detail;localStorage.setItem("lastTool",m);const l=new URL(window.location);l.searchParams.set("tool",m),window.history.pushState({},"",l),console.log("Opening tool:",m)});try{B.GlobalWorkerOptions.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${B.version}/pdf.worker.min.js`}catch{}function Ne(){const[s,m]=i.useState(null),[l,f]=i.useState(!1),[p,x]=i.useState(!1),[v,j]=i.useState(!1);async function P(t){const o=t.target.files[0];o&&m(o)}function g(t){t.preventDefault(),x(!0)}function r(t){t.preventDefault(),t.dataTransfer.dropEffect="copy"}function u(t){t.preventDefault(),x(!1)}async function n(t){var c,d;t.preventDefault(),x(!1);const o=(d=(c=t.dataTransfer)==null?void 0:c.files)==null?void 0:d[0];o&&(m(o),j(!0),setTimeout(()=>j(!1),1500))}async function a(){if(s){f(!0);try{const t=await s.arrayBuffer(),o=await B.getDocument({data:t}).promise;let c="";for(let S=1;S<=o.numPages;S++){const L=(await(await o.getPage(S)).getTextContent()).items.map(D=>D.str);c+=`
--- Page ${S} ---
`+L.join(" ")+`
`}const d=new Blob([c],{type:"text/plain"}),y=URL.createObjectURL(d),b=document.createElement("a");b.href=y,b.download=`${s.name.replace(/\.pdf$/i,"")}.txt`,b.click(),URL.revokeObjectURL(y)}catch(t){console.error(t),alert("Failed: "+t.message)}finally{f(!1)}}}return e.jsxs("div",{children:[e.jsx("h2",{children:"PDF → Text"}),e.jsxs("div",{className:`dropzone ${p?"dragover":""}`,onDragEnter:g,onDragOver:r,onDragLeave:u,onDrop:n,children:[e.jsx("input",{type:"file",accept:"application/pdf",onChange:P}),e.jsx("div",{className:"muted",children:"Select a PDF to extract text (plain text)."}),v&&e.jsx("div",{className:"drop-overlay",children:"✓ Uploaded"})]}),e.jsx("div",{style:{marginTop:12},children:e.jsx("button",{className:"btn-primary",onClick:a,disabled:l||!s,children:l?"Working...":"Extract Text"})})]})}try{B.GlobalWorkerOptions.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${B.version}/pdf.worker.min.js`}catch{}function Te(){const[s,m]=i.useState(null),[l,f]=i.useState(!1),[p,x]=i.useState(!1),[v,j]=i.useState(!1);async function P(t){const o=t.target.files[0];o&&m(o)}function g(t){t.preventDefault(),x(!0)}function r(t){t.preventDefault(),t.dataTransfer.dropEffect="copy"}function u(t){t.preventDefault(),x(!1)}async function n(t){var c,d;t.preventDefault(),x(!1);const o=(d=(c=t.dataTransfer)==null?void 0:c.files)==null?void 0:d[0];o&&(m(o),j(!0),setTimeout(()=>j(!1),1500))}async function a(){if(s){f(!0);try{const t=await s.arrayBuffer(),o=await B.getDocument({data:t}).promise,c=[];for(let T=1;T<=o.numPages;T++){const D=(await(await o.getPage(T)).getTextContent()).items.map(C=>C.str);c.push(new ve(D.join(" ")))}const d=new je({sections:[{children:c}]}),y=await be.toBlob(d),b=URL.createObjectURL(y),S=document.createElement("a");S.href=b,S.download=`${s.name.replace(/\.pdf$/i,"")}.docx`,S.click(),URL.revokeObjectURL(b)}catch(t){console.error(t),alert("Failed: "+t.message)}finally{f(!1)}}}return e.jsxs("div",{children:[e.jsx("h2",{children:"PDF → Word (.docx)"}),e.jsxs("div",{className:`dropzone ${p?"dragover":""}`,onDragEnter:g,onDragOver:r,onDragLeave:u,onDrop:n,children:[e.jsx("input",{type:"file",accept:"application/pdf",onChange:P}),e.jsx("div",{className:"muted",children:"Select a PDF to convert to a simple .docx (text-only)."}),v&&e.jsx("div",{className:"drop-overlay",children:"✓ Uploaded"})]}),e.jsx("div",{style:{marginTop:12},children:e.jsx("button",{className:"btn-primary",onClick:a,disabled:l||!s,children:l?"Working...":"Convert to DOCX"})})]})}try{B.GlobalWorkerOptions.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${B.version}/pdf.worker.min.js`}catch{}function Ee(){const[s,m]=i.useState([]),[l,f]=i.useState(!1);async function p(a){const t=Array.from(a.target.files),o=[];for(const c of t){const d=await n(c);o.push({file:c,thumb:d})}m(c=>c.concat(o))}async function x(){if(s.length){f(!0);try{const a=await Z.create();for(const y of s){const S=await y.file.arrayBuffer(),T=await Z.load(S);(await a.copyPages(T,T.getPageIndices())).forEach(L=>a.addPage(L))}const t=await a.save(),o=new Blob([t],{type:"application/pdf"}),c=URL.createObjectURL(o),d=document.createElement("a");d.href=c,d.download="merged.pdf",d.click(),URL.revokeObjectURL(c)}catch(a){console.error(a),alert("Failed to merge: "+(a.message||a))}finally{f(!1)}}}function v(a){m(t=>t.filter((o,c)=>c!==a))}function j(a){m(t=>{if(a<=0)return t;const o=t.slice(),c=o[a-1];return o[a-1]=o[a],o[a]=c,o})}function P(a){m(t=>{if(a>=t.length-1)return t;const o=t.slice(),c=o[a+1];return o[a+1]=o[a],o[a]=c,o})}function g(a,t){a.dataTransfer.setData("text/plain",String(t)),a.dataTransfer.effectAllowed="move"}function r(a){a.preventDefault(),a.dataTransfer.dropEffect="move"}function u(a,t){a.preventDefault();const o=Number(a.dataTransfer.getData("text/plain"));Number.isNaN(o)||m(c=>{const d=c.slice(),[y]=d.splice(o,1);return d.splice(t,0,y),d})}async function n(a){try{const t=await a.arrayBuffer(),c=await(await B.getDocument({data:t}).promise).getPage(1),d=c.getViewport({scale:1.5}),y=document.createElement("canvas");y.width=Math.ceil(d.width),y.height=Math.ceil(d.height);const b=y.getContext("2d");return await c.render({canvasContext:b,viewport:d}).promise,y.toDataURL("image/png")}catch{return null}}return e.jsxs("div",{children:[e.jsx("h2",{children:"Merge PDF"}),e.jsxs("div",{className:"dropzone",children:[e.jsx("input",{type:"file",accept:"application/pdf",multiple:!0,onChange:p}),e.jsx("div",{className:"muted",children:"Select multiple PDF files. They will be merged in the selected order."})]}),e.jsx("div",{className:"file-list",children:s.map((a,t)=>e.jsxs("div",{className:"file-item",draggable:!0,onDragStart:o=>g(o,t),onDragOver:r,onDrop:o=>u(o,t),children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[e.jsx("div",{style:{width:56,height:40,flex:"none",background:"#f4f6fb",display:"flex",alignItems:"center",justifyContent:"center"},children:a.thumb?e.jsx("img",{src:a.thumb,style:{maxWidth:"100%",maxHeight:"100%"},alt:"thumb"}):e.jsx("div",{className:"muted",children:"PDF"})}),e.jsx("div",{style:{minWidth:200,overflow:"hidden",textOverflow:"ellipsis"},children:a.file.name})]}),e.jsxs("div",{style:{display:"flex",gap:8},children:[e.jsx("button",{className:"btn",onClick:()=>j(t),disabled:t===0,children:"↑"}),e.jsx("button",{className:"btn",onClick:()=>P(t),disabled:t===s.length-1,children:"↓"}),e.jsx("button",{className:"btn",onClick:()=>v(t),children:"Remove"})]})]},t))}),e.jsx("div",{style:{marginTop:12},children:e.jsx("button",{className:"btn",onClick:x,disabled:l||s.length===0,children:l?"Working...":"Merge & Download"})})]})}function Re(){const[s,m]=i.useState(null),[l,f]=i.useState([]),[p,x]=i.useState([]),[v,j]=i.useState(!1);async function P(n){const a=n.target.files[0];if(!a)return;m(a);const t=await a.arrayBuffer(),o=await Z.load(t);f(new Array(o.getPageCount()).fill(!1)),x(new Array(o.getPageCount()).fill(0))}function g(n){f(a=>a.map((t,o)=>o===n?!t:t))}function r(n){x(a=>a.map((t,o)=>o===n?(t+90)%360:t))}async function u(){if(s){j(!0);try{const n=await s.arrayBuffer(),a=await Z.load(n),t=l.flatMap((T,I)=>T?[I]:[]);if(t.length===0){alert("Pick pages to export");return}const o=await Z.create();(await o.copyPages(a,t)).forEach((T,I)=>{o.addPage(T);const L=t[I],D=p[L]||0;D&&T.setRotation(D)});const d=await o.save(),y=new Blob([d],{type:"application/pdf"}),b=URL.createObjectURL(y),S=document.createElement("a");S.href=b,S.download="extracted.pdf",S.click(),URL.revokeObjectURL(b)}catch(n){console.error(n),alert("Failed: "+n.message)}finally{j(!1)}}}return e.jsxs("div",{children:[e.jsx("h2",{children:"Split / Extract Pages"}),e.jsxs("div",{className:"dropzone",children:[e.jsx("input",{type:"file",accept:"application/pdf",onChange:P}),e.jsx("div",{className:"muted",children:"Load a PDF then select pages to export."})]}),e.jsx("div",{style:{marginTop:12},children:l.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"muted",children:"Click pages to toggle selection. Use rotate to change orientation."}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(120px,1fr))",gap:8,marginTop:8},children:l.map((n,a)=>e.jsx("div",{className:"file-item",style:{cursor:"pointer",background:n?"#eef2ff":""},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%"},children:[e.jsxs("div",{onClick:()=>g(a),style:{flex:1},children:["Page ",a+1," ",p[a]?`• ${p[a]}°`:""]}),e.jsx("div",{style:{display:"flex",gap:6},children:e.jsx("button",{className:"btn",onClick:()=>r(a),children:"Rotate"})})]})},a))}),e.jsx("div",{style:{marginTop:12},children:e.jsx("button",{className:"btn",onClick:u,disabled:v,children:v?"Working...":"Export Selected"})})]})})]})}function Fe(){const[s,m]=i.useState([]),[l,f]=i.useState(!1),[p,x]=i.useState("fit");async function v(a){const t=Array.from(a.target.files),o=[];for(const c of t)try{const d=await u(c);o.push({file:c,dataUrl:d.dataUrl,thumb:d.dataUrl,width:d.width,height:d.height})}catch(d){console.warn("failed to load image",c,d)}o.length&&m(c=>c.concat(o))}function j(a){m(t=>t.filter((o,c)=>c!==a))}function P(a,t){a.dataTransfer.setData("text/plain",String(t)),a.dataTransfer.effectAllowed="move"}function g(a){a.preventDefault(),a.dataTransfer.dropEffect="move"}function r(a,t){a.preventDefault();const o=Number(a.dataTransfer.getData("text/plain"));Number.isNaN(o)||m(c=>{const d=c.slice(),[y]=d.splice(o,1);return d.splice(t,0,y),d})}function u(a){return new Promise((t,o)=>{const c=new FileReader;c.onload=()=>{const d=new Image;d.onload=()=>t({dataUrl:c.result,width:d.naturalWidth,height:d.naturalHeight}),d.onerror=o,d.src=c.result},c.onerror=o,c.readAsDataURL(a)})}async function n(){if(s.length!==0){f(!0);try{const a=s,t="mm",o=25.4/96,c=210,d=297,{jsPDF:y}=await K(async()=>{const{jsPDF:S}=await import("./vendor_jspdf-DEKdHaTR.js").then(T=>T.j);return{jsPDF:S}},__vite__mapDeps([0,1,2])),b=new y({unit:t,format:[c,d]});for(let S=0;S<a.length;S++){const T=a[S],I=T.dataUrl||T.thumb,L=T.width,D=T.height;if(!I){console.warn("skip image with no dataUrl/thumb",T);continue}const C=c,h=d;S>0&&b.addPage();const w=10,k=C-w*2,R=h-w*2,E=L*o,F=D*o;let _,U;if(p==="actual")_=Math.min(E,k),U=Math.min(F,R);else if(p==="fill"){const z=Math.max(k/E,R/F);_=E*z,U=F*z}else{const z=Math.min(k/E,R/F,1);_=E*z,U=F*z}const $=(C-_)/2,G=(h-U)/2,H=typeof I=="string"&&I.indexOf("image/png")>=0?"PNG":"JPEG";try{b.addImage(I,H,$,G,_,U)}catch(z){console.error("addImage failed for entry",S,z)}}b.save("images.pdf")}catch(a){console.error(a),alert("Failed: "+(a.message||a))}finally{f(!1)}}}return e.jsxs("div",{children:[e.jsx("h2",{children:"Images → PDF"}),e.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[e.jsx("label",{style:{display:"flex",alignItems:"center",gap:6},children:"Mode:"}),e.jsxs("select",{value:p,onChange:a=>x(a.target.value),children:[e.jsx("option",{value:"fit",children:"Fit (contain)"}),e.jsx("option",{value:"fill",children:"Fill (cover)"}),e.jsx("option",{value:"actual",children:"Actual size (max page)"})]})]}),e.jsxs("div",{className:"dropzone",children:[e.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:v}),e.jsx("div",{className:"muted",children:"Select images in the order you want them to appear."})]}),e.jsx("div",{className:"file-list",children:s.map((a,t)=>e.jsxs("div",{className:"file-item",draggable:!0,onDragStart:o=>P(o,t),onDragOver:g,onDrop:o=>r(o,t),children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[e.jsx("div",{style:{width:56,height:40,flex:"none",background:"#f4f6fb",display:"flex",alignItems:"center",justifyContent:"center"},children:a.thumb?e.jsx("img",{src:a.thumb,style:{maxWidth:"100%",maxHeight:"100%"},alt:"thumb"}):e.jsx("div",{className:"muted",children:"IMG"})}),e.jsx("div",{style:{minWidth:200,overflow:"hidden",textOverflow:"ellipsis"},children:a.file.name})]}),e.jsx("div",{children:e.jsx("button",{className:"btn",onClick:()=>j(t),children:"Remove"})})]},t))}),e.jsx("div",{style:{marginTop:12},children:e.jsx("button",{className:"btn",onClick:n,disabled:l||s.length===0,children:l?"Working...":"Create PDF"})})]})}try{B.GlobalWorkerOptions.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${B.version}/pdf.worker.min.js`}catch(s){console.warn("pdfjs worker not set",s)}function Le(){const[s,m]=i.useState(null),[l,f]=i.useState([]),[p,x]=i.useState(!1);async function v(g){const r=g.target.files[0];if(!r)return;m(r);const u=await r.arrayBuffer(),n=await B.getDocument({data:u}).promise;f(new Array(n.numPages).fill(!1))}function j(g){f(r=>r.map((u,n)=>n===g?!u:u))}async function P(){if(s){x(!0);try{const g=await s.arrayBuffer(),r=await B.getDocument({data:g}).promise,u=l.flatMap((a,t)=>a?[t+1]:[]);if(u.length===0){alert("Select pages to export"),x(!1);return}const n=[];for(const a of u){const t=await r.getPage(a),o=t.getViewport({scale:2}),c=document.createElement("canvas");c.width=Math.ceil(o.width),c.height=Math.ceil(o.height);const d=c.getContext("2d");await t.render({canvasContext:d,viewport:o}).promise;const y=await new Promise(b=>c.toBlob(b,"image/png"));n.push({pnum:a,blob:y})}if(u.length===1){const a=n[0].blob,t=URL.createObjectURL(a),o=document.createElement("a");o.href=t,o.download=`${s.name.replace(/\.pdf$/i,"")}_page_${n[0].pnum}.png`,o.click(),URL.revokeObjectURL(t)}else{const a=new ie;for(const d of n){const y=await d.blob.arrayBuffer();a.file(`${s.name.replace(/\.pdf$/i,"")}_page_${d.pnum}.png`,y)}const t=await a.generateAsync({type:"blob"}),o=URL.createObjectURL(t),c=document.createElement("a");c.href=o,c.download=`${s.name.replace(/\.pdf$/i,"")}_pages.zip`,c.click(),URL.revokeObjectURL(o)}}catch(g){console.error(g),alert("Failed: "+g.message)}finally{x(!1)}}}return e.jsxs("div",{children:[e.jsx("h2",{children:"PDF → Images"}),e.jsxs("div",{className:"dropzone",children:[e.jsx("input",{type:"file",accept:"application/pdf",onChange:v}),e.jsx("div",{className:"muted",children:"Select a PDF, then choose pages to export as PNG."})]}),l.length>0&&e.jsxs("div",{style:{marginTop:12},children:[e.jsx("div",{className:"muted",children:"Click pages to select"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(90px,1fr))",gap:8,marginTop:8},children:l.map((g,r)=>e.jsxs("div",{className:"file-item",onClick:()=>j(r),style:{cursor:"pointer",background:g?"#eef2ff":""},children:["Page ",r+1]},r))}),e.jsx("div",{style:{marginTop:12},children:e.jsx("button",{className:"btn",onClick:P,disabled:p,children:p?"Rendering...":"Export Selected as PNG"})})]})]})}try{B.GlobalWorkerOptions.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${B.version}/pdf.worker.min.js`}catch{}function Ue(){const[s,m]=i.useState(null),[l,f]=i.useState(null),p=i.useRef(),[x,v]=i.useState(!1);async function j(n){const a=n.target.files[0];if(!a)return;m(a);const t=await a.arrayBuffer(),c=await(await B.getDocument({data:t}).promise).getPage(1),d=c.getViewport({scale:1.5}),y=document.createElement("canvas");y.width=Math.ceil(d.width),y.height=Math.ceil(d.height);const b=y.getContext("2d");await c.render({canvasContext:b,viewport:d}).promise,f(y.toDataURL("image/png"))}i.useEffect(()=>{const n=p.current;if(!n||!l)return;const a=n.getContext("2d"),t=new Image;t.onload=()=>{n.width=t.width,n.height=t.height,a.drawImage(t,0,0)},t.src=l},[l]);function P(n){v(!0),r(n)}function g(){v(!1)}function r(n){if(!x)return;const a=p.current,t=a.getBoundingClientRect(),o=n.clientX-t.left,c=n.clientY-t.top,d=a.getContext("2d");d.fillStyle="rgba(255,0,0,0.6)",d.beginPath(),d.arc(o,c,6,0,Math.PI*2),d.fill()}async function u(){if(!s||!p.current)return;const n=await new Promise(T=>p.current.toBlob(T,"image/png")),a=await Z.create(),t=await n.arrayBuffer(),o=await a.embedPng(t);a.addPage([o.width,o.height]).drawImage(o,{x:0,y:0,width:o.width,height:o.height});const d=await a.save(),y=new Blob([d],{type:"application/pdf"}),b=URL.createObjectURL(y),S=document.createElement("a");S.href=b,S.download=s.name.replace(/\.pdf$/i,"")+"_annotated.pdf",S.click(),URL.revokeObjectURL(b)}return e.jsxs("div",{children:[e.jsx("h2",{children:"Annotate PDF (single-page preview)"}),e.jsxs("div",{className:"dropzone",children:[e.jsx("input",{type:"file",accept:"application/pdf",onChange:j}),e.jsx("div",{className:"muted",children:"Load a PDF (first page shown). Draw on canvas to annotate."})]}),l&&e.jsxs("div",{style:{marginTop:12},children:[e.jsx("div",{style:{border:"1px solid #eee"},children:e.jsx("canvas",{ref:p,onMouseDown:P,onMouseUp:g,onMouseMove:r,style:{display:"block",width:"100%"}})}),e.jsx("div",{style:{marginTop:8},children:e.jsx("button",{className:"btn",onClick:u,children:"Export Annotated PDF"})})]})]})}try{B.GlobalWorkerOptions.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${B.version}/pdf.worker.min.js`}catch(s){console.warn("pdfjs worker not set",s)}function Ie(){const[s,m]=i.useState(null),[l,f]=i.useState(0),[p,x]=i.useState(!1),[v,j]=i.useState(!1),[P,g]=i.useState(!1),[r,u]=i.useState(.7),[n,a]=i.useState(.9),[t,o]=i.useState(null),[c,d]=i.useState(null),[y,b]=i.useState(null),[S,T]=i.useState(!1),[I,L]=i.useState(""),D=i.useRef(null),C=i.useRef(null),h=i.useRef(0),w=i.useRef(null);async function k(N){var O;const M=(O=N.target.files)==null?void 0:O[0];if(M){m(M),d(M.size);try{const A=await M.arrayBuffer();D.current=A;const V=await B.getDocument({data:A}).promise;C.current=V,f(V.numPages),b(null),L("")}catch(A){console.error(A),alert("Unable to read PDF: "+(A.message||A))}}}function R(N){N.preventDefault(),j(!0)}function E(N){N.preventDefault(),N.dataTransfer.dropEffect="copy"}function F(N){N.preventDefault(),j(!1)}async function _(N){var O,A;N.preventDefault(),j(!1);const M=(A=(O=N.dataTransfer)==null?void 0:O.files)==null?void 0:A[0];if(M){m(M),d(M.size);const V=await M.arrayBuffer(),W=await B.getDocument({data:V}).promise;f(W.numPages),b(null),L(""),g(!0),setTimeout(()=>g(!1),1500)}}function U(N){return N*25.4/96}async function $({download:N=!0,preview:M=!1}={download:!0,preview:!1}){if(!s)return alert("Select a PDF to compress");if(!(l>80&&!confirm("This PDF has "+l+" pages. Compressing will rasterize pages in the browser and may be slow or use lots of memory. Continue?"))){x(!0),o(null);try{const O=await s.arrayBuffer(),A=await B.getDocument({data:O}).promise,V=A.numPages;let W=null;for(let J=1;J<=V;J++){const q=await A.getPage(J),Q=q.getViewport({scale:n}),Y=document.createElement("canvas");Y.width=Math.ceil(Q.width),Y.height=Math.ceil(Q.height);const ae=Y.getContext("2d");await q.render({canvasContext:ae,viewport:Q}).promise;const ee=Y.toDataURL("image/jpeg",Number(r)),te=U(Y.width),se=U(Y.height);J===1?(W=new he({unit:"mm",format:[te,se]}),W.addImage(ee,"JPEG",0,0,te,se)):(W.addPage([te,se]),W.addImage(ee,"JPEG",0,0,te,se)),Y.width=0,Y.height=0}if(!W)throw new Error("Failed to create compressed PDF");if(M){const J=W.output("datauristring");o(J)}N&&W.save(s.name.replace(/\.pdf$/i,"")+"_compressed.pdf")}catch(O){console.error(O),alert("Compression failed: "+(O.message||O))}finally{x(!1)}}}async function G(){if(!s)return alert("Select a PDF first");T(!0),b(null),L("Preparing...");try{const N=await s.arrayBuffer(),M=await B.getDocument({data:N}).promise,O=M.numPages;f(O),L("Rendering sample page...");const A=await M.getPage(1),V=A.getViewport({scale:n}),W=document.createElement("canvas");W.width=Math.ceil(V.width),W.height=Math.ceil(V.height);const J=W.getContext("2d");await A.render({canvasContext:J,viewport:V}).promise;const q=await new Promise(ee=>W.toBlob(ee,"image/jpeg",Number(r))),Q=q?q.size:0,ae=Math.max(0,Math.round(Q*O+2e3));b(ae),L("Estimated using sample page at current settings"),W.width=0,W.height=0}catch(N){console.error(N),alert("Estimate failed: "+(N.message||N))}finally{T(!1)}}async function H(N,M){const O=D.current||await s.arrayBuffer(),A=C.current||await B.getDocument({data:O}).promise,V=A.numPages,W=await A.getPage(1),J=W.getViewport({scale:M}),q=document.createElement("canvas");q.width=Math.ceil(J.width),q.height=Math.ceil(J.height);const Q=q.getContext("2d");await W.render({canvasContext:Q,viewport:J}).promise;const Y=await new Promise(te=>q.toBlob(te,"image/jpeg",Number(N))),ae=Y?Y.size:0,ee=2e3;return q.width=0,q.height=0,Math.max(0,Math.round(ae*V+ee))}async function z(){if(!s)return alert("Select a PDF first");T(!0),L("Estimating range...");try{const N=D.current||await s.arrayBuffer(),M=C.current||await B.getDocument({data:N}).promise;D.current=N,C.current=M;const O=M.numPages;f(O);const A=.1,V=.5,W=1,J=1,q=Number(r),Q=Number(n);L("Rendering low-quality sample...");const Y=++h.current,ae=await H(A,V);if(Y!==h.current)throw new Error("Cancelled");L("Rendering current settings sample...");const ee=await H(q,Q);if(Y!==h.current)throw new Error("Cancelled");L("Rendering high-quality sample...");const te=await H(W,J);if(Y!==h.current)throw new Error("Cancelled");b({low:ae,cur:ee,high:te}),L("Range estimated using first-page extrapolation")}catch(N){console.error(N),alert("Range estimate failed: "+(N.message||N))}finally{T(!1)}}i.useEffect(()=>{if(s)return w.current&&clearTimeout(w.current),w.current=setTimeout(()=>{(h.current++)(async()=>{try{T(!0),L("Estimating...");const N=await H(Number(r),Number(n));if(h.current===0)return;b({cur:N}),L("Live estimate updated")}catch(N){N.message!=="Cancelled"&&console.error(N)}finally{T(!1)}})()},350),()=>{w.current&&clearTimeout(w.current)}},[s,r,n]);function X(N){return N==null?"-":N<1024?N+" B":N<1024*1024?(N/1024).toFixed(1)+" KB":(N/(1024*1024)).toFixed(2)+" MB"}return e.jsxs("div",{children:[e.jsx("h2",{children:"Compress PDF"}),e.jsxs("div",{className:`dropzone ${v?"dragover":""}`,onDragEnter:R,onDragOver:E,onDragLeave:F,onDrop:_,children:[e.jsx("input",{type:"file",accept:"application/pdf",onChange:k}),e.jsx("div",{className:"muted",children:"Rasterize pages at lower quality/scale to reduce file size (lossy)."}),P&&e.jsx("div",{className:"drop-overlay",children:"✓ Uploaded"})]}),s&&e.jsxs("div",{style:{marginTop:12},children:[e.jsxs("div",{children:[e.jsx("strong",{children:s.name})," — ",l," pages — original: ",X(c)]}),y&&e.jsxs("div",{style:{marginTop:8},children:[typeof y=="number"&&e.jsxs("div",{children:["Estimated compressed size: ",e.jsx("strong",{children:X(y)})," (",c?Math.round(100-y/c*100):0,"% smaller)"]}),typeof y=="object"&&e.jsx("div",{children:y.low&&y.cur&&y.high?e.jsxs(e.Fragment,{children:[e.jsx("div",{children:"Estimated range:"}),e.jsxs("div",{style:{display:"flex",gap:12,marginTop:6},children:[e.jsxs("div",{children:["Min: ",e.jsx("strong",{children:X(y.low)})," (",c?Math.round(100-y.low/c*100):0,"% smaller)"]}),e.jsxs("div",{children:["Current: ",e.jsx("strong",{children:X(y.cur)})," (",c?Math.round(100-y.cur/c*100):0,"% smaller)"]}),e.jsxs("div",{children:["Max: ",e.jsx("strong",{children:X(y.high)})," (",c?Math.round(100-y.high/c*100):0,"% smaller)"]})]})]}):e.jsxs("div",{children:["Estimated compressed size (live): ",e.jsx("strong",{children:X(y.cur)})," ",c?`(${Math.round(100-y.cur/c*100)}% smaller)`:""," ",S&&e.jsx("span",{className:"small-spinner","aria-hidden":"true"})]})})]}),I&&e.jsx("div",{style:{marginTop:8,color:"#6b7280"},children:I}),e.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center",marginTop:8},children:[e.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:["JPEG Quality:",e.jsx("input",{type:"range",min:"0.1",max:"1",step:"0.05",value:r,onChange:N=>u(Number(N.target.value))}),e.jsxs("div",{style:{width:44,textAlign:"right"},children:[Math.round(r*100),"%"]})]}),e.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:["Render Scale:",e.jsxs("select",{value:n,onChange:N=>a(Number(N.target.value)),children:[e.jsx("option",{value:1,children:"100%"}),e.jsx("option",{value:.9,children:"90%"}),e.jsx("option",{value:.8,children:"80%"}),e.jsx("option",{value:.7,children:"70%"}),e.jsx("option",{value:.6,children:"60%"}),e.jsx("option",{value:.5,children:"50%"})]})]})]}),e.jsxs("div",{style:{marginTop:12,display:"flex",gap:8},children:[e.jsx("button",{className:"btn-primary",onClick:()=>$({download:!0,preview:!1}),disabled:p,children:p?"Compressing...":"Compress & Download"}),e.jsx("button",{className:"btn-outline",onClick:()=>$({download:!1,preview:!0}),disabled:p,children:p?"Compressing...":"Preview"}),e.jsx("button",{className:"btn-ghost",onClick:G,disabled:S,children:S?"Estimating...":"Estimate size"}),e.jsx("button",{className:"btn-ghost",onClick:z,disabled:S,children:S?"Estimating...":"Estimate range (min/cur/max)"})]}),t&&e.jsxs("div",{style:{marginTop:12},children:[e.jsx("div",{className:"muted",children:"Preview (close tab/window to dismiss):"}),e.jsx("iframe",{title:"compress-preview",src:t,style:{width:"100%",height:400,border:"1px solid #ddd"}})]})]})]})}function pe(s){return new Promise((m,l)=>{if(typeof s=="string"){const f=fe.parse(s.trim(),{header:!1});m(f.data)}else fe.parse(s,{complete:f=>m(f.data),error:f=>l(f)})})}function Oe(){const[s,m]=i.useState([]),[l,f]=i.useState(null),p=i.useRef(null);async function x(P){var r;f(null);const g=(r=P.target.files)==null?void 0:r[0];if(g)try{const u=await pe(g);m(u)}catch{f("Failed to parse CSV")}}async function v(){try{const P=await navigator.clipboard.readText(),g=await pe(P);m(g)}catch{f("Failed to parse pasted CSV")}}async function j(){if(!p.current)return;const P=p.current,r=(await xe(P,{scale:2})).toDataURL("image/png"),u=new he("p","pt","a4"),n=u.getImageProperties(r),a=u.internal.pageSize.getWidth(),t=n.height*a/n.width;u.addImage(r,"PNG",0,0,a,t),u.save("table.pdf")}return e.jsxs("div",{className:"tool-csv2pdf",children:[e.jsxs("div",{className:"tool-controls",children:[e.jsxs("label",{className:"btn",children:["Upload CSV",e.jsx("input",{type:"file",accept:".csv,text/csv",onChange:x,style:{display:"none"}})]}),e.jsx("button",{className:"btn",onClick:v,children:"Paste CSV from clipboard"}),e.jsx("button",{className:"btn",onClick:()=>{m([]),f(null)},children:"Clear"}),e.jsx("button",{className:"btn primary",onClick:j,disabled:!s||s.length===0,children:"Export to PDF"})]}),l&&e.jsx("div",{className:"tool-error",children:l}),e.jsx("div",{className:"csv-preview",ref:p,children:e.jsx("table",{children:e.jsx("tbody",{children:s.map((P,g)=>e.jsx("tr",{children:P.map((r,u)=>e.jsx("td",{children:r},u))},g))})})})]})}function Be(){const[s,m]=i.useState(null),[l,f]=i.useState("text"),[p,x]=i.useState("New text"),[v,j]=i.useState(!1),[P,g]=i.useState(null);async function r(a){var o;const t=(o=a.target.files)==null?void 0:o[0];t&&m(t)}async function u(a){var o;const t=(o=a.target.files)==null?void 0:o[0];t&&g(t)}async function n(){if(!s)return alert("Select a PDF");j(!0);try{const a=await s.arrayBuffer(),t=await Z.load(a),o=t.getPages(),c=await t.embedFont(me.Helvetica),d=o[0],{width:y,height:b}=d.getSize();if(l==="text")d.drawText(p,{x:40,y:b-80,size:14,font:c,color:ne(0,0,0)});else if(l==="image"&&P){const D=await P.arrayBuffer(),C=(P.type||"").toLowerCase();let h;C.includes("png")?h=await t.embedPng(D):h=await t.embedJpg(D),d.drawImage(h,{x:40,y:b-200,width:150,height:120})}else d.drawRectangle({x:40,y:b-240,width:200,height:100,color:ne(.9,.9,.9)});const S=await t.save(),T=new Blob([S],{type:"application/pdf"}),I=URL.createObjectURL(T),L=document.createElement("a");L.href=I,L.download="edited.pdf",L.click(),URL.revokeObjectURL(I)}catch(a){console.error(a),alert("Failed: "+a.message)}finally{j(!1)}}return e.jsxs("div",{children:[e.jsx("h2",{children:"Edit PDF"}),e.jsx("input",{type:"file",accept:"application/pdf",onChange:r}),e.jsxs("div",{style:{marginTop:8},children:[e.jsx("label",{children:"Mode"}),e.jsxs("select",{value:l,onChange:a=>f(a.target.value),children:[e.jsx("option",{value:"text",children:"Add Text"}),e.jsx("option",{value:"image",children:"Add Image"}),e.jsx("option",{value:"shape",children:"Add Shape"})]})]}),l==="text"&&e.jsx("div",{style:{marginTop:8},children:e.jsx("input",{value:p,onChange:a=>x(a.target.value),style:{width:"60%"}})}),l==="image"&&e.jsx("div",{style:{marginTop:8},children:e.jsx("input",{type:"file",accept:"image/*",onChange:u})}),e.jsx("div",{style:{marginTop:12},children:e.jsx("button",{className:"btn-primary",onClick:n,disabled:v,children:v?"Working...":"Apply Edits"})})]})}try{B.GlobalWorkerOptions.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${B.version}/pdf.worker.min.js`}catch{}function _e(){const[s,m]=i.useState(null),[l,f]=i.useState(""),[p,x]=i.useState(!1);async function v(P){const g=P.target.files[0];if(g){m(g),f(""),x(!0);try{if(g.type==="application/pdf"){const r=await g.arrayBuffer(),n=await(await B.getDocument({data:r}).promise).getPage(1),a=n.getViewport({scale:2}),t=document.createElement("canvas");t.width=Math.ceil(a.width),t.height=Math.ceil(a.height);const o=t.getContext("2d");await n.render({canvasContext:o,viewport:a}).promise,await j(t)}else{const r=new Image,u=URL.createObjectURL(g);r.src=u,await new Promise(t=>r.onload=t);const n=document.createElement("canvas");n.width=r.naturalWidth,n.height=r.naturalHeight,n.getContext("2d").drawImage(r,0,0),URL.revokeObjectURL(u),await j(n)}}catch(r){console.error(r),alert("OCR failed: "+r.message)}finally{x(!1)}}}async function j(P){const{createWorker:g}=await K(async()=>{const{createWorker:n}=await import("./vendor_tesseract-DKQpXUUC.js").then(a=>a.i);return{createWorker:n}},__vite__mapDeps([3,1,2])),r=await g({logger:n=>{}});await r.load(),await r.loadLanguage("eng"),await r.initialize("eng");const{data:{text:u}}=await r.recognize(P);f(u),await r.terminate()}return e.jsxs("div",{children:[e.jsx("h2",{children:"OCR (Tesseract.js)"}),e.jsxs("div",{className:"dropzone",children:[e.jsx("input",{type:"file",accept:".png,.jpg,.jpeg,application/pdf",onChange:v}),e.jsx("div",{className:"muted",children:"Select an image or scanned PDF. Large files may take time; Tesseract runs locally in your browser."})]}),e.jsx("div",{style:{marginTop:12},children:p?e.jsx("div",{className:"muted",children:"Recognizing... (this may take a while)"}):e.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:l})})]})}function Me(){const[s,m]=i.useState(null),[l,f]=i.useState("bottom-right"),[p,x]=i.useState(1),[v,j]=i.useState(!1);async function P(r){var n;const u=(n=r.target.files)==null?void 0:n[0];u&&m(u)}async function g(){if(!s)return alert("Select a PDF");j(!0);try{const r=await s.arrayBuffer(),u=await Z.load(r),n=u.getPages(),a=await u.embedFont(me.Helvetica);for(let y=0;y<n.length;y++){const b=n[y],{width:S,height:T}=b.getSize(),I=String(Number(p)+y),L=12;let D=S-40,C=20;l==="bottom-left"&&(D=20),l==="top-right"&&(C=T-20),l==="top-left"&&(D=20,C=T-20),b.drawText(I,{x:D,y:C,size:L,font:a,color:ne(0,0,0)})}const t=await u.save(),o=new Blob([t],{type:"application/pdf"}),c=URL.createObjectURL(o),d=document.createElement("a");d.href=c,d.download="pagenums.pdf",d.click(),URL.revokeObjectURL(c)}catch(r){console.error(r),alert("Failed: "+r.message)}finally{j(!1)}}return e.jsxs("div",{children:[e.jsx("h2",{children:"Page Numbers"}),e.jsx("input",{type:"file",accept:"application/pdf",onChange:P}),e.jsxs("div",{style:{marginTop:8},children:[e.jsx("label",{children:"Position"}),e.jsxs("select",{value:l,onChange:r=>f(r.target.value),children:[e.jsx("option",{value:"bottom-right",children:"Bottom Right"}),e.jsx("option",{value:"bottom-left",children:"Bottom Left"}),e.jsx("option",{value:"top-right",children:"Top Right"}),e.jsx("option",{value:"top-left",children:"Top Left"})]}),e.jsx("label",{style:{marginLeft:8},children:"Start"}),e.jsx("input",{type:"number",value:p,onChange:r=>x(r.target.value),style:{width:80,marginLeft:6}})]}),e.jsx("div",{style:{marginTop:12},children:e.jsx("button",{className:"btn-primary",onClick:g,disabled:v,children:v?"Working...":"Add Page Numbers"})})]})}try{B.GlobalWorkerOptions.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${B.version}/pdf.worker.min.js`}catch(s){console.warn("pdfjs worker not set",s)}function Ae(){const[s,m]=i.useState(null),[l,f]=i.useState(!1),[p,x]=i.useState([]);async function v(g){const r=g.target.files[0];if(r){m(r),x([]);try{const u=await r.arrayBuffer(),n=await B.getDocument({data:u}).promise,a=[];for(let t=1;t<=n.numPages;t++){const o=await n.getPage(t),c=o.getViewport({scale:1.5}),d=document.createElement("canvas");d.width=Math.ceil(c.width),d.height=Math.ceil(c.height);const y=d.getContext("2d");await o.render({canvasContext:y,viewport:c}).promise;const b=d.toDataURL("image/png");a.push({dataUrl:b,selected:!0})}x(a)}catch(u){console.error(u),alert("Failed to render preview: "+u.message)}}}function j(g){x(r=>r.map((u,n)=>n===g?{...u,selected:!u.selected}:u))}async function P(){if(!(!s||p.length===0)){f(!0);try{const g=(await K(async()=>{const{default:u}=await import("./vendor_pptxgenjs-C9ORqrRV.js");return{default:u}},__vite__mapDeps([4,0,1,2]))).default,r=new g;for(const u of p){if(!u.selected)continue;r.addSlide().addImage({data:u.dataUrl,x:0,y:0,w:"100%",h:"100%"})}await r.writeFile({fileName:s.name.replace(/\.pdf$/i,"")+".pptx"})}catch(g){console.error(g),alert("Conversion failed: "+g.message)}finally{f(!1)}}}return e.jsxs("div",{children:[e.jsx("h2",{children:"PDF → PPTX"}),e.jsxs("div",{className:"dropzone",children:[e.jsx("input",{type:"file",accept:"application/pdf",onChange:v}),e.jsx("div",{className:"muted",children:"Select a PDF — each page will become a PPTX slide (image). You can preview and deselect pages before export."}),e.jsx("div",{className:"muted",style:{marginTop:6,fontSize:12},children:"Note: slides are exported as images — text isn't editable in PowerPoint."})]}),p.length>0&&e.jsxs("div",{style:{marginTop:12},children:[e.jsx("div",{className:"muted",children:"Preview (click to toggle include)"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(120px,1fr))",gap:8,marginTop:8},children:p.map((g,r)=>e.jsxs("div",{style:{border:g.selected?"2px solid #3b82f6":"1px solid #ddd",padding:6,cursor:"pointer"},onClick:()=>j(r),children:[e.jsx("img",{src:g.dataUrl,style:{width:"100%",height:120,objectFit:"cover"},alt:`page-${r+1}`}),e.jsxs("div",{style:{fontSize:12,marginTop:6,textAlign:"center"},children:["Page ",r+1]})]},r))})]}),e.jsx("div",{style:{marginTop:12},children:e.jsx("button",{className:"btn",onClick:P,disabled:l||p.length===0,children:l?"Converting...":"Convert to PPTX"})})]})}function We(){const[s,m]=i.useState(null),[l,f]=i.useState(!1);function p(v){const j=v.target.files[0];j&&m(j)}async function x(){if(s){f(!0);try{const v=await s.arrayBuffer(),j=await ie.loadAsync(v),P=Object.keys(j.files).filter(r=>r.startsWith("ppt/media/")),g=[];for(const r of P){const u=await j.file(r).async("blob");g.push(u)}if(g.length===0){alert("No embedded slide images found in PPTX. This tool only supports PPTX files that contain slide images."),f(!1);return}if(g.length>0){const{jsPDF:r}=await K(async()=>{const{jsPDF:n}=await import("./vendor_jspdf-DEKdHaTR.js").then(a=>a.j);return{jsPDF:n}},__vite__mapDeps([0,1,2])),u=new r({unit:"px",format:"a4"});for(let n=0;n<g.length;n++){const a=g[n],t=URL.createObjectURL(a),o=await new Promise(y=>{const b=new Image;b.onload=()=>y(b),b.src=t}),c=u.internal.pageSize.getWidth(),d=u.internal.pageSize.getHeight();u.addImage(o,"PNG",0,0,c,d),n<g.length-1&&u.addPage(),URL.revokeObjectURL(t)}u.save(s.name.replace(/\.pptx$/i,"")+".pdf")}else{const r=new ie;for(let n=0;n<g.length;n++){const a=await g[n].arrayBuffer();r.file(`slide_${n+1}.png`,a)}const u=await r.generateAsync({type:"blob"});Pe.saveAs(u,s.name.replace(/\.pptx$/i,"")+"_slides.zip")}}catch(v){console.error(v),alert("Conversion failed: "+v.message)}finally{f(!1)}}}return e.jsxs("div",{children:[e.jsx("h2",{children:"PPTX → PDF"}),e.jsxs("div",{className:"dropzone",children:[e.jsx("input",{type:"file",accept:".pptx,application/vnd.openxmlformats-officedocument.presentationml.presentation",onChange:p}),e.jsx("div",{className:"muted",children:"Select a PPTX. If the file contains embedded slide images, they'll be converted to PDF pages; otherwise you'll get a ZIP of extracted images."})]}),e.jsx("div",{style:{marginTop:12},children:e.jsx("button",{className:"btn",onClick:x,disabled:!s||l,children:l?"Converting...":"Convert to PDF"})})]})}try{B.GlobalWorkerOptions.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${B.version}/pdf.worker.min.js`}catch{}function ze(s,m,l){const f=s.slice(),p=f.splice(m,1)[0];return f.splice(l,0,p),f}function $e(){const[s,m]=i.useState(null),[l,f]=i.useState([]),[p,x]=i.useState(!1);async function v(r){const u=r.target.files[0];if(!u)return;m(u),f([]);const n=await u.arrayBuffer(),a=await B.getDocument({data:n}).promise,t=[];for(let o=1;o<=a.numPages;o++){const c=await a.getPage(o),d=c.getViewport({scale:1}),y=document.createElement("canvas");y.width=Math.ceil(d.width),y.height=Math.ceil(d.height);const b=y.getContext("2d");await c.render({canvasContext:b,viewport:d}).promise,t.push({thumb:y.toDataURL("image/png"),idx:o-1})}f(t)}function j(r,u){r.dataTransfer.setData("text/plain",u)}function P(r,u){r.preventDefault();const n=parseInt(r.dataTransfer.getData("text/plain"),10);f(a=>ze(a,n,u))}async function g(){if(s){x(!0);try{const r=await s.arrayBuffer(),u=await Z.load(r),n=await Z.create(),a=l.map(b=>b.idx);(await n.copyPages(u,a)).forEach(b=>n.addPage(b));const o=await n.save(),c=new Blob([o],{type:"application/pdf"}),d=URL.createObjectURL(c),y=document.createElement("a");y.href=d,y.download=s.name.replace(/\.pdf$/i,"")+"_reordered.pdf",y.click(),URL.revokeObjectURL(d)}catch(r){console.error(r),alert("Export failed: "+r.message)}finally{x(!1)}}}return e.jsxs("div",{children:[e.jsx("h2",{children:"Reorder Pages"}),e.jsxs("div",{className:"dropzone",children:[e.jsx("input",{type:"file",accept:"application/pdf",onChange:v}),e.jsx("div",{className:"muted",children:"Drag thumbnails to reorder pages, then export."})]}),l.length>0&&e.jsxs("div",{style:{marginTop:12},children:[e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(100px,1fr))",gap:8},children:l.map((r,u)=>e.jsxs("div",{className:"file-item",draggable:!0,onDragStart:n=>j(n,u),onDragOver:n=>n.preventDefault(),onDrop:n=>P(n,u),style:{textAlign:"center"},children:[e.jsx("img",{src:r.thumb,style:{width:"100%",height:100,objectFit:"cover"},alt:`page-${u+1}`}),e.jsxs("div",{style:{fontSize:12,marginTop:6},children:["Pos ",u+1]})]},u))}),e.jsx("div",{style:{marginTop:12},children:e.jsx("button",{className:"btn",onClick:g,disabled:p,children:p?"Exporting...":"Export Reordered PDF"})})]})]})}function He(){const[s,m]=i.useState(null),[l,f]=i.useState([]),[p,x]=i.useState(!1);async function v(g){const r=g.target.files[0];if(!r)return;m(r);const u=await r.arrayBuffer(),n=await Z.load(u);f(new Array(n.getPageCount()).fill(!1))}function j(g){f(r=>r.map((u,n)=>n===g?!u:u))}async function P(g){if(s){x(!0);try{const r=await s.arrayBuffer(),u=await Z.load(r),n=await Z.create(),a=u.getPageCount(),t=[...Array(a).keys()];(await n.copyPages(u,t)).forEach((S,T)=>{if(l[T]){const L=g==="cw"?90:270;S.setRotation(L)}n.addPage(S)});const c=await n.save(),d=new Blob([c],{type:"application/pdf"}),y=URL.createObjectURL(d),b=document.createElement("a");b.href=y,b.download=s.name.replace(/\.pdf$/i,"")+"_rotated.pdf",b.click(),URL.revokeObjectURL(y)}catch(r){console.error(r),alert("Rotate failed: "+r.message)}finally{x(!1)}}}return e.jsxs("div",{children:[e.jsx("h2",{children:"Rotate Pages"}),e.jsxs("div",{className:"dropzone",children:[e.jsx("input",{type:"file",accept:"application/pdf",onChange:v}),e.jsx("div",{className:"muted",children:"Load a PDF then select pages to rotate."})]}),l.length>0&&e.jsxs("div",{style:{marginTop:12},children:[e.jsx("div",{className:"muted",children:"Click pages to toggle selection for rotation."}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(120px,1fr))",gap:8,marginTop:8},children:l.map((g,r)=>e.jsxs("div",{className:"file-item",onClick:()=>j(r),style:{cursor:"pointer",background:g?"#eef2ff":""},children:["Page ",r+1]},r))}),e.jsxs("div",{style:{marginTop:12,display:"flex",gap:8},children:[e.jsx("button",{className:"btn",onClick:()=>P("cw"),disabled:p,children:"Rotate CW"}),e.jsx("button",{className:"btn",onClick:()=>P("ccw"),disabled:p,children:"Rotate CCW"})]})]})]})}try{B.GlobalWorkerOptions.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${B.version}/pdf.worker.min.js`}catch{}function Ve({ov:s,onDrag:m,onStartDrag:l,onStartResize:f}){return e.jsxs("div",{className:"sig-overlay",style:{left:s.x,top:s.y,width:s.w,height:s.h},onMouseDown:l,children:[e.jsx("img",{src:s.dataUrl,className:"sig-image",alt:"sig"}),e.jsx("div",{className:"sig-resize",onMouseDown:f})]})}function Xe(){const[s,m]=i.useState(null),[l,f]=i.useState([]),[p,x]=i.useState(null),[v,j]=i.useState([]),[P,g]=i.useState(null),r=i.useRef([]),[u,n]=i.useState(!1),a=i.useRef(null),t=i.useRef(null);i.useEffect(()=>{function D(h){if(!t.current)return;const{type:w,idx:k,startX:R,startY:E,startW:F,startH:_,page:U}=t.current,$=h.clientX-R,G=h.clientY-E;j(H=>{const z=H.slice(),X={...z[k]};return w==="move"?(X.x=Math.max(0,R+$-z[`_pageOffset${U}`]),X.y=Math.max(0,E+G-z[`_pageOffsetY${U}`])):w==="resize"&&(X.w=Math.max(10,F+$),X.h=Math.max(10,_+G)),z[k]=X,z})}function C(){t.current=null}return window.addEventListener("mousemove",D),window.addEventListener("mouseup",C),()=>{window.removeEventListener("mousemove",D),window.removeEventListener("mouseup",C)}},[]);async function o(D){var h;const C=(h=D.target.files)==null?void 0:h[0];C&&(m(C),await d(C))}function c(D){var w;const C=(w=D.target.files)==null?void 0:w[0];if(!C)return;const h=new FileReader;h.onload=()=>x(h.result),h.readAsDataURL(C)}async function d(D){const C=await D.arrayBuffer(),w=await B.getDocument({data:C}).promise,k=[];for(let R=1;R<=w.numPages;R++){const E=await w.getPage(R),F=E.getViewport({scale:1.5}),_=document.createElement("canvas");_.width=Math.floor(F.width),_.height=Math.floor(F.height);const U=_.getContext("2d");await E.render({canvasContext:U,viewport:F}).promise,k.push({canvas:_,width:_.width,height:_.height,viewportWidth:F.width,viewportHeight:F.height})}f(k),j([])}function y(D,C){D.preventDefault();const w=v[C].page,R=l[w].canvas.getBoundingClientRect();j(E=>{const F=E.slice();return F[`_pageOffset${w}`]=R.left,F[`_pageOffsetY${w}`]=R.top,F}),g(C),t.current={type:"move",idx:C,startX:D.clientX,startY:D.clientY,page:w}}function b(D,C){D.preventDefault();const h=v[C];t.current={type:"resize",idx:C,startX:D.clientX,startY:D.clientY,startW:h.w,startH:h.h}}function S(D){if(!p)return alert("Create or upload a signature first");const C=l[D];if(!C)return;const h=Math.min(200,C.width*.4),w=Math.min(80,C.height*.15),k=(C.width-h)/2,R=(C.height-w)/2;j(E=>{const F=E.concat({page:D,x:k,y:R,w:h,h:w,dataUrl:p});return r.current.push(E),F})}function T(){P!==null&&(j(D=>{const C=D.slice();return C.splice(P,1),r.current.push(D),C}),g(null))}function I(){const D=r.current.pop();D&&j(D)}async function L(){if(!s)return alert("Select a PDF first");if(v.length===0)return alert("Place a signature before exporting");n(!0);try{const D=await s.arrayBuffer(),C=await Z.load(D),h=await(await fetch(p)).arrayBuffer(),w=String(p).startsWith("data:image/jpeg")||String(p).startsWith("data:image/jpg");let k=null;if(w)try{k=await C.embedJpg(h)}catch{k=await C.embedPng(h)}else try{k=await C.embedPng(h)}catch{k=await C.embedJpg(h)}for(const U of v){const $=C.getPages()[U.page],{width:G,height:H}=$.getSize(),z=l[U.page],X=z.width,N=z.height,M=G/X,O=H/N,A=U.x*M,V=H-(U.y+U.h)*O,W=U.w*M,J=U.h*O;$.drawImage(k,{x:A,y:V,width:W,height:J})}const R=await C.save(),E=new Blob([R],{type:"application/pdf"}),F=URL.createObjectURL(E),_=document.createElement("a");_.href=F,_.download=s.name.replace(/\.pdf$/i,"")+"_signed.pdf",_.click(),URL.revokeObjectURL(F)}catch(D){console.error(D),alert("Failed: "+(D.message||D))}finally{n(!1)}}return e.jsxs("div",{children:[e.jsx("h2",{children:"Signature"}),e.jsxs("div",{style:{display:"flex",gap:12,flexWrap:"wrap"},children:[e.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:6},children:["Select PDF",e.jsx("input",{"aria-label":"Select PDF file",type:"file",accept:"application/pdf",onChange:o})]}),e.jsxs("label",{style:{display:"flex",flexDirection:"column",gap:6},children:["Upload signature image",e.jsx("input",{"aria-label":"Upload signature image",type:"file",accept:"image/*",onChange:c})]})]}),e.jsx("div",{style:{marginTop:12},children:e.jsx("div",{className:"muted",children:`Render preview below, then click a page's "Add" to place signature, drag/resize overlay as needed.`})}),e.jsx("div",{ref:a,style:{marginTop:12,display:"flex",flexDirection:"column",gap:18},children:l.map((D,C)=>e.jsxs("div",{style:{position:"relative",border:"1px solid var(--border)",display:"inline-block"},children:[e.jsx("div",{style:{position:"absolute",right:8,top:8,zIndex:10},children:e.jsx("button",{className:"btn-ghost",onClick:()=>S(C),children:"Add"})}),e.jsx("div",{style:{position:"relative"},children:e.jsx("div",{style:{position:"relative"},children:e.jsxs("div",{style:{position:"relative"},children:[e.jsxs("div",{style:{width:D.width,height:D.height},children:[e.jsx("div",{dangerouslySetInnerHTML:{__html:""}}),e.jsx("div",{ref:h=>{h&&!h.firstChild&&h.appendChild(D.canvas)}})]}),v.map((h,w)=>h.page===C?e.jsx(Ve,{ov:h,onStartDrag:k=>y(k,w),onStartResize:k=>b(k,w)},w):null)]})})})]},C))}),e.jsxs("div",{style:{marginTop:12,display:"flex",gap:8},children:[e.jsx("button",{className:"btn-primary",onClick:L,disabled:u||!s||v.length===0,children:u?"Working...":"Export Signed PDF"}),e.jsx("button",{className:"btn-ghost",onClick:T,disabled:P===null,children:"Delete"}),e.jsx("button",{className:"btn-ghost",onClick:I,disabled:r.current.length===0,children:"Undo"})]})]})}function Ge(){const[s,m]=i.useState(null),[l,f]=i.useState("text"),[p,x]=i.useState("Sample Watermark"),[v,j]=i.useState(.25),[P,g]=i.useState(30),[r,u]=i.useState(1),[n,a]=i.useState(!1),[t,o]=i.useState(null),[c,d]=i.useState(null),[y,b]=i.useState(!1),S=i.useRef(null);i.useEffect(()=>{D()},[p,c,v,P,r,n,l]);async function T(h){var k;const w=(k=h.target.files)==null?void 0:k[0];w&&m(w)}async function I(h){var R;const w=(R=h.target.files)==null?void 0:R[0];if(!w)return;o(w);const k=new FileReader;k.onload=()=>d(k.result),k.readAsDataURL(w)}function L(h,w,k){h.clearRect(0,0,w,k),h.save(),h.globalAlpha=Number(v),h.translate(w/2,k/2),h.rotate(P*Math.PI/180);const R=Number(r)||1;if(l==="text"){h.font=`${48*R}px sans-serif`;try{const E=getComputedStyle(document.documentElement);h.fillStyle=E.getPropertyValue("--muted")||"#444"}catch{h.fillStyle="#444"}if(h.textAlign="center",h.textBaseline="middle",n){const E=300*R,F=200*R;for(let _=-k;_<k*2;_+=F)for(let U=-w;U<w*2;U+=E)h.save(),h.translate(U,_),h.fillText(p,0,0),h.restore()}else h.fillText(p,0,0)}else if(l==="image"&&c){const E=new Image;E.src=c,E.onload=()=>{const F=E.naturalWidth*R,_=E.naturalHeight*R;if(n){const U=F+60,$=_+60;for(let G=-k;G<k*2;G+=$)for(let H=-w;H<w*2;H+=U)h.drawImage(E,H,G,F,_)}else h.drawImage(E,-F/2,-_/2,F,_)}}h.restore()}function D(){const h=S.current;if(!h)return;const w=h.getContext("2d"),k=h.width,R=h.height;try{const E=getComputedStyle(document.documentElement);w.fillStyle=E.getPropertyValue("--paper")||"#fff",w.strokeStyle=E.getPropertyValue("--border")||"#ddd"}catch{w.fillStyle="#fff",w.strokeStyle="#ddd"}w.fillRect(0,0,k,R),w.strokeRect(10,10,k-20,R-20),w.save(),w.translate(k/2,R/2),L(w,k,R),w.restore()}async function C(){if(!s)return alert("Select a PDF");b(!0);try{const h=await s.arrayBuffer(),w=await Z.load(h),k=w.getPages();let R=null,E=null,F=!1;l==="image"&&t&&(R=await t.arrayBuffer(),F=(t.type||"").toLowerCase().includes("png"),F?E=await w.embedPng(R):E=await w.embedJpg(R));for(const H of k){const{width:z,height:X}=H.getSize();if(l==="text"){const N=48*Number(r||1),M={x:z/2,y:X/2,size:N,color:ne(.4,.4,.4),rotate:void 0,opacity:Number(v),xSkew:0};if(n){const O=300*Number(r||1),A=200*Number(r||1);for(let V=-A;V<X+A;V+=A)for(let W=-O;W<z+O;W+=O)H.drawText(p,{x:W+O/2,y:V+A/2,size:N,color:ne(.4,.4,.4),opacity:Number(v)})}else H.drawText(p,{x:z/2-p.length*N*.12,y:X/2,size:N,color:ne(.4,.4,.4),opacity:Number(v)})}else if(l==="image"&&E){const N=E.width*Number(r||1),M=E.height*Number(r||1);if(n){const O=N+40,A=M+40;for(let V=-A;V<X+A;V+=A)for(let W=-O;W<z+O;W+=O)H.drawImage(E,{x:W,y:V,width:N,height:M,opacity:Number(v)})}else H.drawImage(E,{x:z/2-N/2,y:X/2-M/2,width:N,height:M,opacity:Number(v)})}}const _=await w.save(),U=new Blob([_],{type:"application/pdf"}),$=URL.createObjectURL(U),G=document.createElement("a");G.href=$,G.download=s.name.replace(/\.pdf$/i,"")+"_watermarked.pdf",G.click(),URL.revokeObjectURL($)}catch(h){console.error(h),alert("Failed: "+(h.message||h))}finally{b(!1)}}return e.jsxs("div",{children:[e.jsx("h2",{children:"Watermark PDF"}),e.jsx("div",{children:e.jsx("input",{type:"file",accept:"application/pdf",onChange:T})}),e.jsxs("div",{style:{marginTop:12,display:"flex",gap:12,alignItems:"center",flexWrap:"wrap"},children:[e.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[e.jsx("input",{type:"radio",name:"mode",value:"text",checked:l==="text",onChange:()=>f("text")})," Text"]}),e.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[e.jsx("input",{type:"radio",name:"mode",value:"image",checked:l==="image",onChange:()=>f("image")})," Image"]}),l==="image"&&e.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:["Image: ",e.jsx("input",{type:"file",accept:"image/*",onChange:I})]})]}),l==="text"&&e.jsx("div",{style:{marginTop:8},children:e.jsx("input",{value:p,onChange:h=>x(h.target.value),style:{width:"60%"}})}),e.jsxs("div",{style:{marginTop:8,display:"flex",gap:12,alignItems:"center",flexWrap:"wrap"},children:[e.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:["Opacity",e.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:v,onChange:h=>j(Number(h.target.value))}),e.jsxs("div",{style:{width:48,textAlign:"right"},children:[Math.round(v*100),"%"]})]}),e.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:["Rotation",e.jsx("input",{type:"number",value:P,onChange:h=>g(Number(h.target.value)),style:{width:80}})]}),e.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:["Scale",e.jsx("input",{type:"range",min:"0.1",max:"3",step:"0.05",value:r,onChange:h=>u(Number(h.target.value))}),e.jsxs("div",{style:{width:48,textAlign:"right"},children:[r.toFixed(2),"x"]})]}),e.jsxs("label",{style:{display:"flex",gap:8,alignItems:"center"},children:[e.jsx("input",{type:"checkbox",checked:n,onChange:h=>a(h.target.checked)})," Tiling"]})]}),e.jsxs("div",{style:{marginTop:12},children:[e.jsx("div",{className:"muted",children:"Preview"}),e.jsx("canvas",{"aria-label":"Watermark preview",ref:S,width:600,height:800,style:{width:"100%",maxWidth:600,display:"block",border:"1px solid var(--border)",background:"var(--paper)"}})]}),e.jsx("div",{style:{marginTop:12},children:e.jsx("button",{className:"btn-primary",onClick:C,disabled:y||!s,children:y?"Working...":"Apply Watermark"})})]})}function Je(s){const m=new Blob([s],{type:"application/javascript"}),l=URL.createObjectURL(m),f=new Worker(l,{type:"module"});return f._blobUrl=l,f}function oe(s){if(s){try{s.terminate()}catch{}if(s._blobUrl){try{URL.revokeObjectURL(s._blobUrl)}catch{}s._blobUrl=null}}}const Ye=`
self._aborted = false
self.onmessage = async (ev) => {
  const msg = ev.data
  if (!msg) return
  if (msg.cmd === "abort") { self._aborted = true; self.postMessage({ type: "cancelled" }); return }
  if (msg.cmd === "start") {
    self._aborted = false
    const files = msg.files || []
    const watermark = msg.watermark || "CONFIDENTIAL"
    try {
      const PDFLib = await import('pdf-lib')
      const JSZip = (await import('jszip')).default
      const zip = new JSZip()
      let totalPages = 0
      const pageCounts = []
      for (let i = 0; i < files.length; i++) {
        const f = files[i]
        try {
          if (!f.buffer) { pageCounts.push(0); continue }
          const arr = f.buffer instanceof ArrayBuffer ? f.buffer : f.buffer.buffer
          const pdfDoc = await PDFLib.PDFDocument.load(arr)
          const pages = pdfDoc.getPages()
          pageCounts.push(pages.length)
          totalPages += pages.length
        } catch (e) { pageCounts.push(0) }
      }
      let processed = 0
      for (let fi = 0; fi < files.length; fi++) {
        if (self._aborted) { self.postMessage({ type: "cancelled" }); return }
        const f = files[fi]
        try {
          self.postMessage({ type: "progress", percent: Math.round((processed / Math.max(1, totalPages)) * 100), message: "Starting " + f.name, fileIndex: fi, filePercent: 0 })
          if (!f.buffer) { self.postMessage({ type: "file-done", fileIndex: fi }); continue }
          const arr = f.buffer instanceof ArrayBuffer ? f.buffer : f.buffer.buffer
          const pdfDoc = await PDFLib.PDFDocument.load(arr)
          const pages = pdfDoc.getPages()
          for (let pi = 0; pi < pages.length; pi++) {
            if (self._aborted) { self.postMessage({ type: "cancelled" }); return }
            const page = pages[pi]
            const { width, height } = page.getSize()
            page.drawText(watermark, {
              x: width / 2 - 100,
              y: height / 2,
              size: 48,
              color: PDFLib.rgb ? PDFLib.rgb(0.8, 0.1, 0.1) : PDFLib.rgb(0.8, 0.1, 0.1),
              rotate: PDFLib.degrees ? PDFLib.degrees(-45) : PDFLib.degrees(-45),
              opacity: 0.25,
            })
            processed += 1
            const percent = totalPages > 0 ? Math.round((processed / totalPages) * 100) : 0
            const filePercent = pages.length > 0 ? Math.round(((pi+1) / pages.length) * 100) : 0
            self.postMessage({ type: "progress", percent: percent, message: "Processing " + f.name + " (" + (pi+1) + "/" + pages.length + ")", fileIndex: fi, filePercent: filePercent })
          }
          const out = await pdfDoc.save()
          zip.file(f.name.replace(/\\.pdf$/i, '') + '-watermarked.pdf', out)
          self.postMessage({ type: "file-done", fileIndex: fi })
        } catch (err) {
          self.postMessage({ type: "progress", percent: Math.round((processed / Math.max(1, totalPages)) * 100), message: "Error processing " + f.name, fileIndex: fi, filePercent: 0 })
        }
      }
      const blob = await zip.generateAsync({ type: 'blob' })
      const arrayBuffer = await blob.arrayBuffer()
      self.postMessage({ type: 'result', buffer: arrayBuffer }, [arrayBuffer])
    } catch (err) {
      self.postMessage({ type: 'error', error: String(err) })
    }
  }
}
`;function Ze(){const[s,m]=i.useState([]),[l,f]=i.useState("CONFIDENTIAL"),[p,x]=i.useState(!1),v=i.useRef({aborted:!1}),j=i.useRef(null),[P,g]=i.useState([]);i.useEffect(()=>()=>{if(j.current){try{j.current.terminate()}catch{}j.current=null}},[]);const r=n=>{const a=Array.from(n.target.files||[]);m(a),g(a.map(t=>({name:t.name,status:"pending",percent:0})))},u=async()=>{if(!s.length)return;x(!0),v.current.aborted=!1;const n=[];for(const t of s)try{const o=await t.arrayBuffer();n.push({name:t.name,buffer:o})}catch{n.push({name:t.name,buffer:null})}let a=!1;try{const t=Je(Ye);j.current=t,a=!0,t.onmessage=c=>{const d=c.data;if(d)if(d.type==="progress"){const{percent:y,message:b,fileIndex:S,filePercent:T}=d;window.dispatchEvent(new CustomEvent("pdf-progress",{detail:{percent:y,message:b}})),typeof S=="number"&&g(I=>{const L=I.slice();return L[S]={...L[S]||{},status:"processing",percent:T},L})}else if(d.type==="file-done"){const{fileIndex:y}=d;g(b=>{const S=b.slice();return S[y]={...S[y]||{},status:"done",percent:100},S})}else if(d.type==="result"){const{buffer:y}=d,b=new Blob([y],{type:"application/zip"}),S=URL.createObjectURL(b),T=document.createElement("a");T.href=S,T.download="watermarked-files.zip",document.body.appendChild(T),T.click(),T.remove(),URL.revokeObjectURL(S),x(!1),window.dispatchEvent(new CustomEvent("pdf-progress",{detail:{end:!0,message:"Complete"}})),oe(j.current),j.current=null}else d.type==="error"?(console.error("Worker error",d.error),x(!1),window.dispatchEvent(new CustomEvent("pdf-progress",{detail:{end:!0,message:"Error"}})),oe(j.current),j.current=null):d.type==="cancelled"&&(x(!1),window.dispatchEvent(new CustomEvent("pdf-progress",{detail:{end:!0,message:"Cancelled"}})),oe(j.current),j.current=null)};const o=n.reduce((c,d)=>(d.buffer&&c.push(d.buffer),c),[]);t.postMessage({cmd:"start",files:n,watermark:l},o)}catch(t){console.warn("Worker not available, falling back to in-thread processing",t),a=!1}if(!a)try{const{PDFDocument:t,rgb:o,degrees:c}=await K(async()=>{const{PDFDocument:w,rgb:k,degrees:R}=await import("./vendor_pdf_lib-CLohTL0Y.js");return{PDFDocument:w,rgb:k,degrees:R}},__vite__mapDeps([5,1,2])),d=(await K(async()=>{const{default:w}=await import("./vendor_jszip-CrgqbLi1.js").then(k=>k.j);return{default:w}},__vite__mapDeps([2,1]))).default,y=new d;let b=0;const S=[];for(const w of s)try{const k=await w.arrayBuffer(),E=(await t.load(k)).getPages();S.push(E.length),b+=E.length}catch(k){console.warn("Could not read file for page count",w.name,k),S.push(0)}window.dispatchEvent(new CustomEvent("pdf-progress",{detail:{percent:0,message:"Starting batch watermark",indeterminate:!1}}));let T=0,I=null;const L=w=>{const k=Date.now(),R=()=>{window.dispatchEvent(new CustomEvent("pdf-progress",{detail:w})),T=Date.now()},E=k-T;E>=200||w.percent===100?(I&&(clearTimeout(I),I=null),R()):(I&&clearTimeout(I),I=setTimeout(()=>{R(),I=null},200-E))};for(let w=0;w<s.length&&!v.current.aborted;w++){const k=s[w];try{g(U=>{const $=U.slice();return $[w]={...$[w]||{},status:"processing",percent:0},$});const R=await k.arrayBuffer();if(v.current.aborted)break;const E=await t.load(R),F=E.getPages();for(let U=0;U<F.length&&!v.current.aborted;U++){const $=F[U],{width:G,height:H}=$.getSize();$.drawText(l,{x:G/2-100,y:H/2,size:48,color:o(.8,.1,.1),rotate:c(-45),opacity:.25});try{const z=S.slice(0,w).reduce((M,O)=>M+O,0)+(U+1),X=b>0?Math.round(z/b*100):0;L({percent:X,message:`Processing ${k.name} (${U+1}/${F.length})`});const N=F.length>0?Math.round((U+1)/F.length*100):0;g(M=>{const O=M.slice();return O[w]={...O[w]||{},percent:N},O})}catch{}}const _=await E.save();y.file(k.name.replace(/\.pdf$/i,"")+"-watermarked.pdf",_),g(U=>{const $=U.slice();return $[w]={...$[w]||{},status:"done",percent:100},$})}catch(R){console.error("Error watermarking",k.name,R),g(E=>{const F=E.slice();return F[w]={...F[w]||{},status:"error",percent:0},F})}}window.dispatchEvent(new CustomEvent("pdf-progress",{detail:{percent:100,message:"Packaging ZIP",indeterminate:!1}}));const D=await y.generateAsync({type:"blob"}),C=URL.createObjectURL(D),h=document.createElement("a");h.href=C,h.download="watermarked-files.zip",document.body.appendChild(h),h.click(),h.remove(),URL.revokeObjectURL(C),x(!1),window.dispatchEvent(new CustomEvent("pdf-progress",{detail:{end:!0,message:"Complete"}}))}catch(t){console.error("Fallback processing failed",t),x(!1),window.dispatchEvent(new CustomEvent("pdf-progress",{detail:{end:!0,message:"Error"}}))}};return e.jsxs("div",{className:"batch-tool",children:[e.jsx("h2",{children:"Batch Watermark"}),e.jsx("p",{children:"Upload multiple PDFs and apply a text watermark to each page. Results are returned as a ZIP."}),e.jsxs("div",{children:[e.jsx("label",{children:"Watermark text:"}),e.jsx("input",{value:l,onChange:n=>f(n.target.value)})]}),e.jsx("div",{style:{marginTop:8},children:e.jsx("input",{type:"file",accept:"application/pdf",multiple:!0,onChange:r})}),P.length>0&&e.jsxs("div",{className:"batch-file-list",children:[e.jsx("h3",{children:"Files"}),e.jsx("ul",{style:{listStyle:"none",padding:0},children:P.map((n,a)=>e.jsxs("li",{className:"batch-file-item",children:[e.jsxs("div",{className:"batch-file-row",children:[e.jsx("div",{style:{flex:1},children:n.name}),e.jsx("div",{style:{width:120,textAlign:"right",fontSize:12},children:n.status||"pending"})]}),e.jsx("div",{className:"progress-bar-small",style:{marginTop:6},children:e.jsx("div",{className:"progress-fill",style:{width:`${n.percent||0}%`,background:n.status==="error"?"#e53935":void 0}})})]},a))})]}),e.jsxs("div",{style:{marginTop:12,display:"flex",gap:8},children:[e.jsx("button",{className:"btn-primary",onClick:u,disabled:p||s.length===0,children:p?"Processing...":"Apply Watermark & Download ZIP"}),e.jsx("button",{className:"btn-cancel",onClick:()=>{if(j.current){try{j.current.postMessage({cmd:"abort"})}catch{}try{j.current.terminate()}catch{}j.current=null}v.current.aborted=!0,x(!1),g(n=>n.map(a=>a.status==="processing"?{...a,status:"pending"}:a)),window.dispatchEvent(new CustomEvent("pdf-progress",{detail:{end:!0,message:"Cancelled"}}))},disabled:!p,children:"Cancel"})]}),e.jsxs("div",{style:{marginTop:12},children:[e.jsx("strong",{children:s.length})," file(s) selected"]})]})}function qe(){const[s,m]=i.useState(null),[l,f]=i.useState(null),[p,x]=i.useState(!1),v=async j=>{var r,u,n;const P=(r=j.target.files)==null?void 0:r[0];if(!P)return;m(P),x(!0);const{PDFDocument:g}=await K(async()=>{const{PDFDocument:a}=await import("./vendor_pdf_lib-CLohTL0Y.js");return{PDFDocument:a}},__vite__mapDeps([5,1,2]));try{const a=await P.arrayBuffer(),t=await g.load(a),o=t.getTitle?{title:(u=t.getTitle)==null?void 0:u.call(t),author:(n=t.getAuthor)==null?void 0:n.call(t)}:{};f({pages:t.getPageCount(),metadata:o})}catch(a){console.error("Error reading PDF",a),f({error:"Could not read PDF"})}x(!1)};return e.jsxs("div",{children:[e.jsx("h2",{children:"PDF Info"}),e.jsx("p",{children:"Upload a PDF to view basic information (page count, metadata)."}),e.jsx("input",{type:"file",accept:"application/pdf",onChange:v}),p&&e.jsx("div",{children:"Reading..."}),l&&e.jsx("div",{style:{marginTop:12},children:l.error?e.jsx("div",{style:{color:"red"},children:l.error}):e.jsxs("div",{children:[e.jsxs("div",{children:["Pages: ",l.pages]}),e.jsxs("div",{children:["Metadata: ",e.jsx("pre",{style:{whiteSpace:"pre-wrap"},children:JSON.stringify(l.metadata,null,2)})]})]})})]})}function Ke(){const[s,m]=i.useState([]),[l,f]=i.useState(!1),p=v=>m(Array.from(v.target.files||[])),x=async()=>{if(!s.length)return;f(!0);const{PDFDocument:v}=await K(async()=>{const{PDFDocument:n}=await import("./vendor_pdf_lib-CLohTL0Y.js");return{PDFDocument:n}},__vite__mapDeps([5,1,2])),j=(await K(async()=>{const{default:n}=await import("./vendor_jszip-CrgqbLi1.js").then(a=>a.j);return{default:n}},__vite__mapDeps([2,1]))).default,P=new j;for(const n of s)try{const a=await n.arrayBuffer(),t=await v.load(a),o=[],c=await t.save();P.file(n.name.replace(/\.pdf$/i,"")+"-original.pdf",c)}catch(a){console.error("Error extracting images",a)}const g=await P.generateAsync({type:"blob"}),r=URL.createObjectURL(g),u=document.createElement("a");u.href=r,u.download="extracted-images.zip",document.body.appendChild(u),u.click(),u.remove(),URL.revokeObjectURL(r),f(!1)};return e.jsxs("div",{children:[e.jsx("h2",{children:"Extract Images"}),e.jsx("p",{children:"Upload PDFs and extract images. (Fallback: includes original PDFs if image extraction not found)"}),e.jsx("input",{type:"file",accept:"application/pdf",multiple:!0,onChange:p}),e.jsx("div",{style:{marginTop:12},children:e.jsx("button",{onClick:x,disabled:l||s.length===0,children:l?"Working...":"Extract & Download"})})]})}function Qe(){const[s,m]=i.useState(null),[l,f]=i.useState(!1),[p,x]=i.useState(!1),[v,j]=i.useState(!1);async function P(t){const o=t.target.files[0];o&&m(o)}function g(t){t.preventDefault(),x(!0)}function r(t){t.preventDefault(),t.dataTransfer.dropEffect="copy"}function u(t){t.preventDefault(),x(!1)}async function n(t){var c,d;t.preventDefault(),x(!1);const o=(d=(c=t.dataTransfer)==null?void 0:c.files)==null?void 0:d[0];o&&(m(o),j(!0),setTimeout(()=>j(!1),1500))}async function a(){if(s){f(!0);try{const t=await s.arrayBuffer(),c=(await De.convertToHtml({arrayBuffer:t})).value,d=document.createElement("div");d.innerHTML=c,d.style.padding="20px",document.body.appendChild(d);const b=(await xe(d,{scale:2})).toDataURL("image/png"),{jsPDF:S}=await K(async()=>{const{jsPDF:C}=await import("./vendor_jspdf-DEKdHaTR.js").then(h=>h.j);return{jsPDF:C}},__vite__mapDeps([0,1,2])),T=new S("p","mm","a4"),I=T.getImageProperties(b),L=210,D=I.height*L/I.width;T.addImage(b,"PNG",0,0,L,D),T.save(s.name.replace(/\.docx$/i,"")+".pdf"),document.body.removeChild(d)}catch(t){console.error(t),alert("Failed: "+t.message)}finally{f(!1)}}}return e.jsxs("div",{children:[e.jsx("h2",{children:"Word (.docx) → PDF"}),e.jsxs("div",{className:`dropzone ${p?"dragover":""}`,onDragEnter:g,onDragOver:r,onDragLeave:u,onDrop:n,children:[e.jsx("input",{type:"file",accept:".docx,application/vnd.openxmlformats-officedocument.wordprocessingml.document",onChange:P}),e.jsx("div",{className:"muted",children:"Select a .docx file to convert to PDF (simple formatting)."}),v&&e.jsx("div",{className:"drop-overlay",children:"✓ Uploaded"})]}),e.jsx("div",{style:{marginTop:12},children:e.jsx("button",{className:"btn-primary",onClick:a,disabled:l||!s,children:l?"Working...":"Convert to PDF"})})]})}const et={pdf2text:Ne,pdf2word:Te,merge:Ee,split:Re,imgs2pdf:Fe,pdf2imgs:Le,annotate:Ue,compress:Ie,edit:Be,ocr:_e,pagenums:Me,pdf2ppt:Ae,ppt2pdf:We,csv2pdf:Oe,reorder:$e,rotate:He,signature:Xe,watermark:Ge,"batch-watermark":Ze,"pdf-info":qe,"extract-images":Ke,word2pdf:Qe};function tt({toolId:s,onClose:m}){const[l,f]=i.useState(!1);i.useEffect(()=>{f(!0);const x=v=>{v.key==="Escape"&&m()};return window.addEventListener("keydown",x),()=>window.removeEventListener("keydown",x)},[]);const p=et[s];return p?e.jsxs("div",{className:`tool-container ${l?"mounted":""}`,children:[e.jsxs("div",{className:"tool-header",children:[e.jsx("button",{onClick:m,className:"close-btn",children:"×"}),e.jsx("h1",{children:s})]}),e.jsx("div",{className:"tool-content",children:e.jsx(p,{})})]}):e.jsxs("div",{className:"tool-container",children:[e.jsxs("div",{className:"tool-header",children:[e.jsx("button",{onClick:m,className:"close-btn",children:"×"}),e.jsx("h1",{children:"Tool Not Found"})]}),e.jsx("div",{className:"tool-content",children:e.jsxs("p",{children:['The requested tool "',s,'" is not available.']})})]})}function at({image:s,href:m,alt:l="Advertisement",children:f}){const p=s?e.jsx("img",{className:"ad-spot-img",src:s,alt:l}):e.jsx("div",{className:"ad-spot-fallback",children:f||"Your ad here"});return e.jsx("div",{className:"ad-spot",role:"region","aria-label":"Advertisement",children:m?e.jsx("a",{href:m,target:"_blank",rel:"noopener noreferrer",children:p}):p})}const ce="dexpdf:recent",nt=8;function le(){try{const s=localStorage.getItem(ce);return s?JSON.parse(s):[]}catch(s){return console.error("Failed to read recent files",s),[]}}function st(s){try{if(!s||!s.id)return;const l=le().filter(p=>p.id!==s.id);l.unshift({...s,time:Date.now()});const f=l.slice(0,nt);return localStorage.setItem(ce,JSON.stringify(f)),f}catch(m){return console.error("Failed to push recent",m),[]}}function rt(){try{localStorage.removeItem(ce)}catch(s){console.error("Failed to clear recent",s)}}function ot({onOpen:s}){const[m,l]=i.useState([]);return i.useEffect(()=>{l(le());const f=()=>l(le());return window.addEventListener("storage",f),()=>window.removeEventListener("storage",f)},[]),!m||m.length===0?null:e.jsxs("div",{className:"recent-files","aria-live":"polite",children:[e.jsxs("div",{className:"recent-header",children:[e.jsx("strong",{children:"Recent"}),e.jsx("button",{className:"recent-clear",onClick:()=>{rt(),l([])},children:"Clear"})]}),e.jsx("ul",{children:m.map(f=>e.jsx("li",{children:e.jsxs("button",{className:"recent-item",onClick:()=>s(f),children:[e.jsx("span",{className:"recent-name",children:f.name||f.id}),e.jsx("span",{className:"recent-time",children:new Date(f.time).toLocaleString()})]})},f.id))})]})}function it(){const[s,m]=i.useState(!1),[l,f]=i.useState("idle"),[p,x]=i.useState(""),v=i.useRef(void 0);return i.useEffect(()=>()=>{v.current&&clearTimeout(v.current)},[]),i.useEffect(()=>{const j=P=>{const g=P.detail||{};if(g&&typeof g=="object"){if(g.end){f("success"),x(g.message||"Done"),v.current=setTimeout(()=>f("idle"),1e3);return}m(!0),f("progress"),g.message&&x(g.message)}};return window.addEventListener("pdf-progress",j),()=>window.removeEventListener("pdf-progress",j)},[]),l==="idle"?null:e.jsx(re,{sx:{position:"fixed",top:8,left:0,right:0,display:"flex",justifyContent:"center",zIndex:1400},children:e.jsxs(re,{sx:{display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsx(re,{sx:{height:40},children:e.jsx(de,{in:s,style:{transitionDelay:s?"200ms":"0ms"},unmountOnExit:!0,children:e.jsx(Se,{})})}),e.jsx(re,{sx:{mt:.5},children:l==="success"?e.jsx(ue,{variant:"caption",children:p||"Success"}):e.jsx(de,{in:l==="progress",style:{transitionDelay:l==="progress"?"200ms":"0ms"},unmountOnExit:!0,children:e.jsx(ue,{variant:"caption",children:p||"Working..."})})})]})})}function lt(){return null}function ct(){return e.jsx("footer",{style:{borderTop:"1px solid var(--border)",background:"var(--card)",padding:18,marginTop:24},children:e.jsx("div",{style:{maxWidth:1100,margin:"0 auto",color:"var(--muted)"},children:e.jsxs("small",{children:["© ",new Date().getFullYear()," DEXPDF — lightweight client-side PDF tools"]})})})}const ge="dexpdf:theme";function dt({className:s}){const[m,l]=i.useState(()=>{try{return localStorage.getItem(ge)||"light"}catch{return"light"}});return i.useEffect(()=>{try{localStorage.setItem(ge,m)}catch{}m==="dark"?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},[m]),e.jsx("button",{"aria-label":"Toggle theme",className:`theme-toggle ${s||""}`,onClick:()=>l(m==="dark"?"light":"dark"),style:{padding:"6px 10px",borderRadius:8,border:"1px solid var(--border)",background:"transparent"},children:m==="dark"?"🌙 Dark":"☀️ Light"})}const ye="dexpdf:ad_consent";function we(){try{const s=localStorage.getItem(ye);return s?JSON.parse(s):null}catch(s){return console.error("Failed to read consent",s),null}}function ut(s){try{localStorage.setItem(ye,JSON.stringify(!!s))}catch(m){console.error("Failed to set consent",m)}}function ft({onChange:s}){const m=f=>{ut(f),s&&s(f)};return we()!==null?null:e.jsx("div",{className:"consent-banner",role:"dialog","aria-live":"polite",children:e.jsxs("div",{className:"consent-inner",children:[e.jsx("div",{className:"consent-text",children:'We use ads to support this site. By clicking "Accept" you agree to show non-intrusive ads. You can decline to hide ads.'}),e.jsxs("div",{className:"consent-actions",children:[e.jsx("button",{className:"consent-decline",onClick:()=>m(!1),children:"Decline"}),e.jsx("button",{className:"consent-accept",onClick:()=>m(!0),children:"Accept"})]})]})})}function pt(){const[s,m]=i.useState([]),[l,f]=i.useState(null),[p,x]=i.useState(""),[v,j]=i.useState(()=>we()),P=i.useRef(null),[g,r]=i.useState(!1);i.useEffect(()=>{const n=a=>{f(a.detail);try{const t=a.detail,o=s.find(c=>c.id===t)||{id:t};st({id:o.id,name:o.name})}catch{}};return window.addEventListener("open-tool",n),()=>window.removeEventListener("open-tool",n)},[]),i.useEffect(()=>{fetch("/tools.json").then(n=>n.json()).then(n=>m(n)).catch(n=>console.error("Error loading tools:",n))},[]),i.useEffect(()=>{const n=a=>{a.key==="/"&&!(document.activeElement&&(document.activeElement.tagName==="INPUT"||document.activeElement.tagName==="TEXTAREA"))&&(a.preventDefault(),P.current&&P.current.focus(),r(!0),setTimeout(()=>r(!1),1200))};return window.addEventListener("keydown",n),()=>window.removeEventListener("keydown",n)},[]);const u=i.useMemo(()=>{const n=p.trim().toLowerCase();return n?s.filter(a=>{const t=a.name&&a.name.toLowerCase().includes(n),o=a.desc&&a.desc.toLowerCase().includes(n),c=Array.isArray(a.tags)&&a.tags.join(" ").toLowerCase().includes(n);return t||o||c}):s},[s,p]);return e.jsxs("div",{className:"app",children:[e.jsx(it,{}),e.jsx(lt,{}),l?e.jsx(tt,{toolId:l,onClose:()=>{f(null),window.history.pushState({},"","/")}}):e.jsxs(e.Fragment,{children:[e.jsx("header",{className:"landing-header",children:e.jsxs("div",{className:"landing-inner",children:[e.jsx("div",{className:"landing-left",children:e.jsx("div",{className:"logo-dexpdf",children:e.jsxs("svg",{width:"92",height:"36",viewBox:"0 0 92 36",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("rect",{width:"82",height:"36",rx:"4",fill:"#CF2727"}),e.jsx("text",{x:"12",y:"26",fill:"white",fontFamily:"Arial",fontSize:"24",fontWeight:"bold",children:"DEX"})]})})}),e.jsxs("div",{className:"landing-right",style:{display:"flex",alignItems:"center",gap:12},children:[e.jsx(dt,{}),e.jsx("span",{className:"hello",children:"HELLO"}),e.jsx("div",{className:"logo-dexers",children:e.jsx("svg",{width:"120",height:"28",viewBox:"0 0 120 28",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("text",{x:"0",y:"22",fill:"#111",fontFamily:"Arial",fontSize:"22",fontWeight:"bold",children:"DEXERS"})})})]})]})}),e.jsxs("main",{className:"landing-main",children:[e.jsxs("div",{className:"landing-search",style:{position:"relative"},children:[e.jsx("input",{"aria-label":"Search tools",className:"landing-search-input",placeholder:"Search tools by name, description or tag...",ref:P,value:p,onChange:n=>x(n.target.value),onKeyDown:n=>{n.key==="Escape"&&x("")}}),g&&e.jsx("div",{style:{position:"absolute",right:10,top:6,fontSize:12,background:"var(--card)",padding:"4px 8px",borderRadius:6,border:"1px solid var(--border)"},children:"Press / to search"}),p&&e.jsx("button",{className:"landing-search-clear",onClick:()=>x(""),"aria-label":"Clear search",children:"Clear"})]}),e.jsx(ot,{onOpen:n=>{window.dispatchEvent(new CustomEvent("open-tool",{detail:n.id}))}}),e.jsx(ft,{onChange:n=>j(n)}),v===!0&&e.jsx(at,{image:"/assets/bippy.jpg",href:"https://dexpdf.vercel.app",alt:"Sponsor"}),e.jsx("div",{className:"landing-grid-inner",children:u.length===0?e.jsxs("div",{className:"no-results",children:['No tools match "',p,'"']}):u.map(n=>e.jsx("a",{href:`/?tool=${n.id}`,className:"landing-card-link",onClick:a=>{a.preventDefault(),console.log("Tool clicked:",n.id),window.dispatchEvent(new CustomEvent("open-tool",{detail:n.id}))},children:e.jsxs("div",{className:"landing-card",children:[e.jsx("h2",{className:"landing-card-title",children:n.name}),e.jsx("p",{className:"landing-card-desc",children:n.desc}),e.jsx("button",{className:"landing-card-btn",children:"Open"})]})},n.id))})]})]}),e.jsx(ct,{})]})}Ce(document.getElementById("root")).render(e.jsx(ke.StrictMode,{children:e.jsx(pt,{})}));
