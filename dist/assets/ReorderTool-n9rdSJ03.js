import{r as h,j as r}from"./index-D_qvBJzx.js";import{p as x}from"./pdf-CB4NDRGm.js";import{P as v}from"./PDFButton-D8tUxpMY.js";import"./_commonjs-dynamic-modules-TDtrdbi3.js";try{x.GlobalWorkerOptions.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${x.version}/pdf.worker.min.js`}catch{}function P(n,u,d){const s=n.slice(),f=s.splice(u,1)[0];return s.splice(d,0,f),s}function k(){const[n,u]=h.useState(null),[d,s]=h.useState([]),[f,j]=h.useState(!1);async function y(t){const e=t.target.files[0];if(!e)return;u(e),s([]);const a=await e.arrayBuffer(),i=await x.getDocument({data:a}).promise,g=[];for(let c=1;c<=i.numPages;c++){const m=await i.getPage(c),l=m.getViewport({scale:1}),o=document.createElement("canvas");o.width=Math.ceil(l.width),o.height=Math.ceil(l.height);const p=o.getContext("2d");await m.render({canvasContext:p,viewport:l}).promise,g.push({thumb:o.toDataURL("image/png"),idx:c-1})}s(g)}function w(t,e){t.dataTransfer.setData("text/plain",e)}function b(t,e){t.preventDefault();const a=parseInt(t.dataTransfer.getData("text/plain"),10);s(i=>P(i,a,e))}async function D(){if(n){j(!0);try{const t=await n.arrayBuffer(),e=await v.load(t),a=await v.create(),i=d.map(p=>p.idx);(await a.copyPages(e,i)).forEach(p=>a.addPage(p));const c=await a.save(),m=new Blob([c],{type:"application/pdf"}),l=URL.createObjectURL(m),o=document.createElement("a");o.href=l,o.download=n.name.replace(/\.pdf$/i,"")+"_reordered.pdf",o.click(),URL.revokeObjectURL(l)}catch(t){console.error(t),alert("Export failed: "+t.message)}finally{j(!1)}}}return r.jsxs("div",{children:[r.jsx("h2",{children:"Reorder Pages"}),r.jsxs("div",{className:"dropzone",children:[r.jsx("input",{type:"file",accept:"application/pdf",onChange:y}),r.jsx("div",{className:"muted",children:"Drag thumbnails to reorder pages, then export."})]}),d.length>0&&r.jsxs("div",{style:{marginTop:12},children:[r.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit,minmax(100px,1fr))",gap:8},children:d.map((t,e)=>r.jsxs("div",{className:"file-item",draggable:!0,onDragStart:a=>w(a,e),onDragOver:a=>a.preventDefault(),onDrop:a=>b(a,e),style:{textAlign:"center"},children:[r.jsx("img",{src:t.thumb,style:{width:"100%",height:100,objectFit:"cover"},alt:`page-${e+1}`}),r.jsxs("div",{style:{fontSize:12,marginTop:6},children:["Pos ",e+1]})]},e))}),r.jsx("div",{style:{marginTop:12},children:r.jsx("button",{className:"btn",onClick:D,disabled:f,children:f?"Exporting...":"Export Reordered PDF"})})]})]})}export{k as default};
