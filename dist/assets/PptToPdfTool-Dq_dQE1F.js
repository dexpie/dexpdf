const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/jspdf.es.min-CzuLzNqZ.js","assets/index-HKiqIxh0.js","assets/index-DwH1kbmc.css"])))=>i.map(i=>d[i]);
import{c as w,r as x,j as d,_ as R}from"./index-HKiqIxh0.js";import{J as E}from"./jszip.min-BjWT6RtQ.js";import"./_commonjs-dynamic-modules-TDtrdbi3.js";var P={exports:{}};(function(c,j){(function(p,s){s()})(w,function(){function p(e,t){return typeof t>"u"?t={autoBom:!1}:typeof t!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\uFEFF",e],{type:e.type}):e}function s(e,t,o){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){u(n.response,t,o)},n.onerror=function(){console.error("could not download file")},n.send()}function h(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return 200<=t.status&&299>=t.status}function f(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var i=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof w=="object"&&w.global===w?w:void 0,l=i.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),u=i.saveAs||(typeof window!="object"||window!==i?function(){}:"download"in HTMLAnchorElement.prototype&&!l?function(e,t,o){var n=i.URL||i.webkitURL,a=document.createElement("a");t=t||e.name||"download",a.download=t,a.rel="noopener",typeof e=="string"?(a.href=e,a.origin===location.origin?f(a):h(a.href)?s(e,t,o):f(a,a.target="_blank")):(a.href=n.createObjectURL(e),setTimeout(function(){n.revokeObjectURL(a.href)},4e4),setTimeout(function(){f(a)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,o){if(t=t||e.name||"download",typeof e!="string")navigator.msSaveOrOpenBlob(p(e,o),t);else if(h(e))s(e,t,o);else{var n=document.createElement("a");n.href=e,n.target="_blank",setTimeout(function(){f(n)})}}:function(e,t,o,n){if(n=n||open("","_blank"),n&&(n.document.title=n.document.body.innerText="downloading..."),typeof e=="string")return s(e,t,o);var a=e.type==="application/octet-stream",y=/constructor/i.test(i.HTMLElement)||i.safari,g=/CriOS\/[\d]+/.test(navigator.userAgent);if((g||a&&y||l)&&typeof FileReader<"u"){var m=new FileReader;m.onloadend=function(){var r=m.result;r=g?r:r.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=r:location=r,n=null},m.readAsDataURL(e)}else{var b=i.URL||i.webkitURL,v=b.createObjectURL(e);n?n.location=v:location.href=v,n=null,setTimeout(function(){b.revokeObjectURL(v)},4e4)}});i.saveAs=u.saveAs=u,c.exports=u})})(P);var L=P.exports;function S(){const[c,j]=x.useState(null),[p,s]=x.useState(!1);function h(i){const l=i.target.files[0];l&&j(l)}async function f(){if(c){s(!0);try{const i=await c.arrayBuffer(),l=await E.loadAsync(i),u=Object.keys(l.files).filter(t=>t.startsWith("ppt/media/")),e=[];for(const t of u){const o=await l.file(t).async("blob");e.push(o)}if(e.length===0){alert("No embedded slide images found in PPTX. This tool only supports PPTX files that contain slide images."),s(!1);return}if(e.length>0){const{jsPDF:t}=await R(async()=>{const{jsPDF:n}=await import("./jspdf.es.min-CzuLzNqZ.js").then(a=>a.j);return{jsPDF:n}},__vite__mapDeps([0,1,2])),o=new t({unit:"px",format:"a4"});for(let n=0;n<e.length;n++){const a=e[n],y=URL.createObjectURL(a),g=await new Promise(v=>{const r=new Image;r.onload=()=>v(r),r.src=y}),m=o.internal.pageSize.getWidth(),b=o.internal.pageSize.getHeight();o.addImage(g,"PNG",0,0,m,b),n<e.length-1&&o.addPage(),URL.revokeObjectURL(y)}o.save(c.name.replace(/\.pptx$/i,"")+".pdf")}else{const t=new E;for(let n=0;n<e.length;n++){const a=await e[n].arrayBuffer();t.file(`slide_${n+1}.png`,a)}const o=await t.generateAsync({type:"blob"});L.saveAs(o,c.name.replace(/\.pptx$/i,"")+"_slides.zip")}}catch(i){console.error(i),alert("Conversion failed: "+i.message)}finally{s(!1)}}}return d.jsxs("div",{children:[d.jsx("h2",{children:"PPTX â†’ PDF"}),d.jsxs("div",{className:"dropzone",children:[d.jsx("input",{type:"file",accept:".pptx,application/vnd.openxmlformats-officedocument.presentationml.presentation",onChange:h}),d.jsx("div",{className:"muted",children:"Select a PPTX. If the file contains embedded slide images, they'll be converted to PDF pages; otherwise you'll get a ZIP of extracted images."})]}),d.jsx("div",{style:{marginTop:12},children:d.jsx("button",{className:"btn",onClick:f,disabled:!c||p,children:p?"Converting...":"Convert to PDF"})})]})}export{S as default};
