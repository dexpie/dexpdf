import{r as p,j as s}from"./index-D_qvBJzx.js";import{P as h}from"./PDFButton-D8tUxpMY.js";import{p as i}from"./pdf-CB4NDRGm.js";import"./_commonjs-dynamic-modules-TDtrdbi3.js";try{i.GlobalWorkerOptions.workerSrc=`//cdnjs.cloudflare.com/ajax/libs/pdf.js/${i.version}/pdf.worker.min.js`}catch{}function S(){const[c,l]=p.useState([]),[d,f]=p.useState(!1);async function g(e){const t=Array.from(e.target.files),n=[];for(const a of t){const r=await N(a);n.push({file:a,thumb:r})}l(a=>a.concat(n))}async function x(){if(c.length){f(!0);try{const e=await h.create();for(const o of c){const k=await o.file.arrayBuffer(),u=await h.load(k);(await e.copyPages(u,u.getPageIndices())).forEach(P=>e.addPage(P))}const t=await e.save(),n=new Blob([t],{type:"application/pdf"}),a=URL.createObjectURL(n),r=document.createElement("a");r.href=a,r.download="merged.pdf",r.click(),URL.revokeObjectURL(a)}catch(e){console.error(e),alert("Failed to merge: "+(e.message||e))}finally{f(!1)}}}function b(e){l(t=>t.filter((n,a)=>a!==e))}function y(e){l(t=>{if(e<=0)return t;const n=t.slice(),a=n[e-1];return n[e-1]=n[e],n[e]=a,n})}function j(e){l(t=>{if(e>=t.length-1)return t;const n=t.slice(),a=n[e+1];return n[e+1]=n[e],n[e]=a,n})}function v(e,t){e.dataTransfer.setData("text/plain",String(t)),e.dataTransfer.effectAllowed="move"}function w(e){e.preventDefault(),e.dataTransfer.dropEffect="move"}function D(e,t){e.preventDefault();const n=Number(e.dataTransfer.getData("text/plain"));Number.isNaN(n)||l(a=>{const r=a.slice(),[o]=r.splice(n,1);return r.splice(t,0,o),r})}async function N(e){try{const t=await e.arrayBuffer(),a=await(await i.getDocument({data:t}).promise).getPage(1),r=a.getViewport({scale:1.5}),o=document.createElement("canvas");o.width=Math.ceil(r.width),o.height=Math.ceil(r.height);const m=o.getContext("2d");return await a.render({canvasContext:m,viewport:r}).promise,o.toDataURL("image/png")}catch{return null}}return s.jsxs("div",{children:[s.jsx("h2",{children:"Merge PDF"}),s.jsxs("div",{className:"dropzone",children:[s.jsx("input",{type:"file",accept:"application/pdf",multiple:!0,onChange:g}),s.jsx("div",{className:"muted",children:"Select multiple PDF files. They will be merged in the selected order."})]}),s.jsx("div",{className:"file-list",children:c.map((e,t)=>s.jsxs("div",{className:"file-item",draggable:!0,onDragStart:n=>v(n,t),onDragOver:w,onDrop:n=>D(n,t),children:[s.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[s.jsx("div",{style:{width:56,height:40,flex:"none",background:"#f4f6fb",display:"flex",alignItems:"center",justifyContent:"center"},children:e.thumb?s.jsx("img",{src:e.thumb,style:{maxWidth:"100%",maxHeight:"100%"},alt:"thumb"}):s.jsx("div",{className:"muted",children:"PDF"})}),s.jsx("div",{style:{minWidth:200,overflow:"hidden",textOverflow:"ellipsis"},children:e.file.name})]}),s.jsxs("div",{style:{display:"flex",gap:8},children:[s.jsx("button",{className:"btn",onClick:()=>y(t),disabled:t===0,children:"↑"}),s.jsx("button",{className:"btn",onClick:()=>j(t),disabled:t===c.length-1,children:"↓"}),s.jsx("button",{className:"btn",onClick:()=>b(t),children:"Remove"})]})]},t))}),s.jsx("div",{style:{marginTop:12},children:s.jsx("button",{className:"btn",onClick:x,disabled:d||c.length===0,children:d?"Working...":"Merge & Download"})})]})}export{S as default};
