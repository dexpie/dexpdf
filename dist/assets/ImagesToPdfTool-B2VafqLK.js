import{r as j,j as t}from"./index-HKiqIxh0.js";import{E as G}from"./jspdf.es.min-CzuLzNqZ.js";function B(){const[g,p]=j.useState([]),[w,b]=j.useState(!1),[x,F]=j.useState("fit");async function T(e){const i=Array.from(e.target.files),s=[];for(const n of i)try{const a=await H(n);s.push({file:n,dataUrl:a.dataUrl,thumb:a.dataUrl,width:a.width,height:a.height})}catch(a){console.warn("failed to load image",n,a)}s.length&&p(n=>n.concat(s))}function W(e){p(i=>i.filter((s,n)=>n!==e))}function M(e,i){e.dataTransfer.setData("text/plain",String(i)),e.dataTransfer.effectAllowed="move"}function P(e){e.preventDefault(),e.dataTransfer.dropEffect="move"}function U(e,i){e.preventDefault();const s=Number(e.dataTransfer.getData("text/plain"));Number.isNaN(s)||p(n=>{const a=n.slice(),[r]=a.splice(s,1);return a.splice(i,0,r),a})}function H(e){return new Promise((i,s)=>{const n=new FileReader;n.onload=()=>{const a=new Image;a.onload=()=>i({dataUrl:n.result,width:a.naturalWidth,height:a.naturalHeight}),a.onerror=s,a.src=n.result},n.onerror=s,n.readAsDataURL(e)})}async function S(){if(g.length!==0){b(!0);try{const e=g,i="mm",s=25.4/96,n=210,a=297,r=new G({unit:i,format:[n,a]});for(let o=0;o<e.length;o++){const c=e[o],u=c.dataUrl||c.thumb,k=c.width,A=c.height;if(!u){console.warn("skip image with no dataUrl/thumb",c);continue}const D=n,I=a;o>0&&r.addPage();const N=10,v=D-N*2,y=I-N*2,d=k*s,m=A*s;let f,h;if(x==="actual")f=Math.min(d,v),h=Math.min(m,y);else if(x==="fill"){const l=Math.max(v/d,y/m);f=d*l,h=m*l}else{const l=Math.min(v/d,y/m,1);f=d*l,h=m*l}const C=(D-f)/2,E=(I-h)/2,R=typeof u=="string"&&u.indexOf("image/png")>=0?"PNG":"JPEG";try{r.addImage(u,R,C,E,f,h)}catch(l){console.error("addImage failed for entry",o,l)}}r.save("images.pdf")}catch(e){console.error(e),alert("Failed: "+(e.message||e))}finally{b(!1)}}}return t.jsxs("div",{children:[t.jsx("h2",{children:"Images â†’ PDF"}),t.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[t.jsx("label",{style:{display:"flex",alignItems:"center",gap:6},children:"Mode:"}),t.jsxs("select",{value:x,onChange:e=>F(e.target.value),children:[t.jsx("option",{value:"fit",children:"Fit (contain)"}),t.jsx("option",{value:"fill",children:"Fill (cover)"}),t.jsx("option",{value:"actual",children:"Actual size (max page)"})]})]}),t.jsxs("div",{className:"dropzone",children:[t.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:T}),t.jsx("div",{className:"muted",children:"Select images in the order you want them to appear."})]}),t.jsx("div",{className:"file-list",children:g.map((e,i)=>t.jsxs("div",{className:"file-item",draggable:!0,onDragStart:s=>M(s,i),onDragOver:P,onDrop:s=>U(s,i),children:[t.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[t.jsx("div",{style:{width:56,height:40,flex:"none",background:"#f4f6fb",display:"flex",alignItems:"center",justifyContent:"center"},children:e.thumb?t.jsx("img",{src:e.thumb,style:{maxWidth:"100%",maxHeight:"100%"},alt:"thumb"}):t.jsx("div",{className:"muted",children:"IMG"})}),t.jsx("div",{style:{minWidth:200,overflow:"hidden",textOverflow:"ellipsis"},children:e.file.name})]}),t.jsx("div",{children:t.jsx("button",{className:"btn",onClick:()=>W(i),children:"Remove"})})]},i))}),t.jsx("div",{style:{marginTop:12},children:t.jsx("button",{className:"btn",onClick:S,disabled:w||g.length===0,children:w?"Working...":"Create PDF"})})]})}export{B as default};
